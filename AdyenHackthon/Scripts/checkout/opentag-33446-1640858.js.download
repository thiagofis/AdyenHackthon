/*
 * Opentag, a tag deployment platform
 * Copyright 2011-2016, Qubit Group
 * http://opentag.qubitproducts.com
 */
(function(){var globalScope=function(){return this}();globalScope.qubit=globalScope.qubit||{};globalScope.qubit.SYSTEM_DEFAULTS={pingServerUrl:"opentag-stats.qubit.com/ping",tellLoadTimesProbability:1}})();
(function(){var ClientConfig={"id":"33446"};try{var global=function(){return this}();if(!global.qubit)global.qubit={};var qubit=global.qubit;if(!qubit.cs)qubit.cs={};qubit.CLIENT_CONFIG=ClientConfig;var cid=ClientConfig.id||"efault";cid="d"+cid;if(!qubit.cs[cid])qubit.cs[cid]={};qubit.cs[cid].ClientConfig=ClientConfig;if(qubit.SYSTEM_DEFAULTS)qubit.cs[cid].SystemDefaults=qubit.SYSTEM_DEFAULTS}catch(e){}})();
(function(){(function(){function getUV(){return global$$0.uv}function initiate(){var uv=getUV();if(!uv||!uv.emit)return false;if(!inititated){inititated=true;for(var i=0;i<unqueuedEvents.length;i++){var tmp=unqueuedEvents[i];if(tmp.on)uv.on.apply(uv,tmp.on);else if(tmp.emit)uv.emit.apply(uv,tmp.emit)}uv.on(/.*/,function(event){var type=event.meta.type;var obj=allEventsByType[type];if(!obj)allEventsByType[type]={current:event,history:[event]};else{obj.current=event;obj.history.push(event)}}).replay();
inititatedSuccessfully=true}return true}(function(){if(!Function.prototype.bind)Function.prototype.bind=function(oThis){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying "+"to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1);var fToBind=this;var FNOP=function(){};var fBound=function(){return fToBind.apply(this instanceof FNOP?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};FNOP.prototype=this.prototype;fBound.prototype=
new FNOP;return fBound}})();var PKG_ROOT={__anonymous__:true};var GLOBAL=null;try{GLOBAL=(false||eval)("this")}catch(e){}if(!GLOBAL)try{var that=function(){return this};GLOBAL=that()}catch(ex){}PKG_ROOT=GLOBAL;var qubit=PKG_ROOT.qubit||{};if(!PKG_ROOT.qubit)PKG_ROOT.qubit=qubit;var qversion="3.2.3";if(qubit.VERSION&&qubit.VERSION!==qversion)try{console.warn("There is already 'qubit.VERSION' set to: "+qubit.VERSION)}catch(ex){}qubit.VERSION=qversion;try{if(typeof module==="object")module.exports=PKG_ROOT}catch(e){}var EMPTY_FUN=
function(){};var UNDEF;(function(){function Define(){}function _namespace(path,instance,pckg,noOverride,isGlobal){var files=path.split(".");var current=Define.NAMESPACE_BASE||PKG_ROOT;var last=null;var lastName=null;var i;if(isGlobal)current=GLOBAL;var root=current;current=pckg||current;for(i=0;i<files.length-1;i+=1){last=current;lastName=files[i];current[lastName]=current[lastName]||{};current=current[lastName]}last=current;lastName=files[files.length-1];if(GLOBAL.TAGSDK_NS_OVERRIDE)noOverride=false;
if(GLOBAL.TAGSDK_NS_FORCED_OVERRIDE_OPTION!==undefined)noOverride=!GLOBAL.TAGSDK_NS_FORCED_OVERRIDE_OPTION;if(instance!==undefined){if(last[lastName]===undefined||!noOverride)last[lastName]=instance}else last[lastName]=last[lastName]||{};if(instance){instance.CLASSPATH=files.join(".");files.splice(files.length-1,1);instance.PACKAGE_NAME=files.join(".")}return{root:root,object:last,instance:last[lastName]}}Define.global=function(){return GLOBAL};Define.STANDARD_CS_NS="qubit.cs";Define.clientSpaceClasspath=
function(){if(window.qubit.CLIENT_CONFIG)return"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id;return Define.STANDARD_CS_NS};Define.globalNamespace=function(path,instance,pckg,noOverride){return _namespace(path,instance,pckg,noOverride,true)};Define.namespace=function(path,instance,pckg,noOverride){return _namespace(path,instance,pckg,noOverride,false)};Define.clientNamespace=function(path,instance,pckg,noOverride){return Define.namespace(Define.clientSpaceClasspath()+"."+path,instance,pckg,noOverride)};
Define.clazz=function(path,Class,SuperClass,pckg,config){Define.namespace(path,Class,pckg,true);if(typeof SuperClass==="function"){Class.SUPER=SuperClass;Class.superclass=SuperClass;Class.prototype=new SuperClass(config);Class.prototype.SUPER=SuperClass;Class.prototype.CLASS=Class}var names=path.split(".");if(Class.prototype){Class.prototype.CLASSPATH=names.join(".");Class.prototype.CLASS_NAME=names[names.length-1];names.splice(names.length-1,1);Class.prototype.PACKAGE_NAME=names.join(".")}else{Class.CLASSPATH=
names.join(".");Class.STATIC_NAME=names[names.length-1];names.splice(names.length-1,1);Class.PACKAGE_NAME=names.join(".")}return Class};Define.clazz("qubit.Define",Define);Define.clientClazz=function(path,Class,SuperClass,pckg,config){return Define.clazz(Define.clientSpaceClasspath()+"."+path,Class,SuperClass,pckg,config)};Define.STANDARD_VS_NS="qubit.vs";Define.vendorsSpaceClasspath=function(path){var cp=qubit.VENDOR_SPACE_CP;var result=cp===undefined||cp===null?Define.STANDARD_VS_NS:cp;if(path)if(result)return result+
"."+path;else return path;return result};var nsTmp=Define.vendorsSpaceClasspath();var _vspace;if(nsTmp)_vspace=Define.namespace(nsTmp,{},null,true).instance;else _vspace=Define.global();Define.getVendorSpace=function(){return _vspace};Define.vendorNamespace=function(path,instance,pckg,noOverride){path=Define.vendorsSpaceClasspath(path);return Define.namespace(path,instance,pckg,noOverride)};Define.vendorClazz=function(path,Class,SuperClass,pckg,config){path=Define.vendorsSpaceClasspath(path);return Define.clazz(path,
Class,SuperClass,pckg,config)}})();(function(){function Cookie(config){}var cookieAlphabet="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"*!-#$\x26+()@"+"'%./:\x3c\x3e?["+'"]^_`{|}~'+"\\"+";\x3d";var cookieAlphabetMap={};for(var i$$0=0;i$$0<cookieAlphabet.length;i$$0++)cookieAlphabetMap[cookieAlphabet.charAt(i$$0)]=i$$0;qubit.Define.clazz("qubit.Cookie",Cookie);Cookie.cookieAlphabet=cookieAlphabet;Cookie.cookieAlphabetMap=cookieAlphabetMap;Cookie.decode=function(string){return unescape(string)};
Cookie.encode=function(string){return escape(string)};Cookie.set=function(name,value,days,domain,notEncoded){var expires;if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1E3);expires="; expires\x3d"+date.toGMTString()}else expires="";if(!notEncoded){name=Cookie.encode(name);value=Cookie.encode(value)}var cookie=name+"\x3d"+value+expires+"; path\x3d/;";if(domain)cookie+=" domain\x3d"+domain;document.cookie=cookie};Cookie.get=function(name,notDecoded){var part=name+"\x3d";var chunks=
document.cookie.split(";");for(var i=0;i<chunks.length;i++){for(var chunk=chunks[i];chunk.charAt(0)===" ";)chunk=chunk.substring(1,chunk.length);if(chunk.indexOf(part)===0){var tmp=chunk.substring(part.length,chunk.length);if(!notDecoded)tmp=Cookie.decode(tmp);return tmp}}return null};Cookie.getAllForName=function(name,decoded){if(!name)return[];var part=name+"\x3d";var chunks=document.cookie.split(";");var cookies=[];for(var i=0;i<chunks.length;i++){for(var chunk=chunks[i];chunk.charAt(0)===" ";)chunk=
chunk.substring(1,chunk.length);if(chunk.indexOf(part)===0){var tmp=chunk.substring(part.length,chunk.length);if(decoded)tmp=Cookie.decode(tmp);cookies.push(tmp)}}return cookies};Cookie.getAll=function(decoded){var chunks=document.cookie.split(";");var cookies=[];for(var i=0;i<chunks.length;i++){for(var chunk=chunks[i];chunk.charAt(0)===" ";)chunk=chunk.substring(1,chunk.length);var name=chunk.substring(0,chunk.indexOf("\x3d"));var tmp=chunk.substring(name.length+1,chunk.length);if(decoded)tmp=Cookie.decode(tmp);
cookies.push([name,tmp])}return cookies};Cookie.rm=function(name,domain){Cookie.set(name,"",-1,domain)}})();(function(){function Log(prefix,clazz,collectLocally){this.collectLogs=!!Log.isCollecting();this.collectLocally=collectLocally;this.collection=[];this.getPrefix=function(){var clz="";if(clazz){if(typeof clazz==="function")clz=clazz(this.ref);else if(clazz.CLASS_NAME)clz=clazz.CLASS_NAME;else if(clazz.constructor&&clazz.constructor.name)clz=clazz.constructor.name;if(clz)clz+=" -\x3e "}return(prefix||
"")+clz}}function logger(log,prefix,type,message,plain,style,plainStyle,level){var toPrint;var pass=LEVEL>=level;if(Log.getCollectLevel()>=0||pass){if(plain)toPrint=[message,plainStyle,type];else toPrint=[prefix+log.getPrefix()+message,style,type];toPrint[3]=level;log.collect(toPrint,level);if(pass)log.printMessage.apply(log,toPrint)}}var Define=qubit.Define;var _console=null;Define.clazz("qubit.opentag.Log",Log);Log.LEVEL_FINEST=4;Log.LEVEL_FINE=3;Log.LEVEL_INFO=2;Log.LEVEL_WARN=1;Log.LEVEL_ERROR=
0;Log.LEVEL_NONE=-1;Log.MAX_LOG_LEN=1E4;Log.prototype.MAX_LOG_LEN=-1;var LEVEL=Log.LEVEL_NONE;var COLLECT_LEVEL=Log.LEVEL_NONE;var COLLECT=true;Log.setLevelFromCookie=function(){var cookieLevel=qubit.Cookie.get("qubit.opentag.Log.LEVEL");if(cookieLevel){cookieLevel=+cookieLevel;if(!isNaN(cookieLevel))if(cookieLevel>0){var fine=Log.LEVEL_FINE;Log.setCollectLevel(cookieLevel>fine?cookieLevel:fine);Log.setLevel(+cookieLevel)}}};Log.setCollecting=function(isCollecting){COLLECT=!!isCollecting};Log.isCollecting=
function(){return COLLECT||Log.COLLECT};Log.setLevel=function(level){LEVEL=+level};Log.setCollectAndLevel=function(level){Log.setLevel(level);Log.setCollectLevel(level)};Log.getLevel=function(){return LEVEL};Log.setCollectLevel=function(level){COLLECT_LEVEL=+level};Log.getCollectLevel=function(){return COLLECT_LEVEL};var collection=[];Log.logsCollection=collection;Log.rePrintAll=function(level,delay,noClean,array){var oldLevel=LEVEL;if(level!==undefined)LEVEL=level;try{if(Log.isCollecting()){try{if(!noClean)_console.clear()}catch(ex){}var collection=
array||Log.logsCollection;var counter=0;for(var i=0;i<collection.length;i++)(function(j){var log=collection[j];var logLevel=log[3];if(logLevel!==undefined&&LEVEL>=logLevel){counter++;if(!delay)Log.print.apply(Log,log);else qubit.opentag.Timed.setTimeout(function(){if(level!==undefined)LEVEL=level;try{Log.print.apply(Log,log)}finally{LEVEL=oldLevel}},counter*delay)}})(i)}}catch(ex){}finally{LEVEL=oldLevel}};var tmp=Define.global();var isStylingSupported=!!(tmp.webkitMediaStream||tmp.webkitURL||tmp.mozContact);
Log.isStyleSupported=function(){return isStylingSupported};var altConsole={};Log.setConsole=function(xconsole){_console=xconsole||altConsole;return _console};Log.delayPrint=-1;var _last_run=(new Date).valueOf();Log.prototype.printMessage=function(message,style,type,level){if(Log.delayPrint>0){var delay=Log.delayPrint;var ago=_last_run-(new Date).valueOf();if(ago>0)delay+=ago;try{qubit.opentag.Timed.setTimeout(function(){this.print(message,style,type,level)}.bind(this),delay)}catch(e){setTimeout(function(){this.print(message,
style,type,level)}.bind(this),delay)}_last_run=(new Date).valueOf()+delay}else this.print(message,style,type,level)};Log.prototype.print=function(message,style,type,level){Log.print(message,style,type,level)};Log.print=function(message,style,type,level){if(level!==undefined&&LEVEL<level)return;try{if(_console&&_console.log)if(style&&Log.isStyleSupported())if(type&&_console[type])_console[type]("%c"+message,style);else _console.log("%c"+message,style);else if(type&&_console[type])_console[type](message);
else _console.log(message)}catch(ex){}};Log.prototype.collect=function(toPrint,level){if(level===undefined)level=Log.getCollectLevel();var collected=false;var collectingGlobally=this.collectLogs&&Log.isCollecting()&&Log.getCollectLevel()>=+level;if(collectingGlobally){collection.push(toPrint);collected=true}if(this.collectLocally&&collectingGlobally){this.collection.push(toPrint);collected=true}if(Log.MAX_LOG_LEN>0)if(collection.length>Log.MAX_LOG_LEN)collection.splice(0,collection.length-Log.MAX_LOG_LEN);
if(Log.MAX_LOG_LEN>0||this.MAX_LOG_LEN>0){var len=Log.MAX_LOG_LEN;if(this.MAX_LOG_LEN>0)len=this.MAX_LOG_LEN;if(this.collection.length>len)this.collection.splice(0,this.collection.length-len)}return collected?toPrint:null};Log.clearAllLogs=function(){try{_console.clear()}catch(e){}finally{collection.splice(0,collection.length)}};Log.getCollectedByLevel=function(level,altCollection){altCollection=altCollection||collection;var results=[];for(var i=0;i<altCollection.length;i++){var log=altCollection[i];
var msg=log[0];var lvl=msg[4];if(lvl===level)results.push(log)}return results};Log.prototype.rePrint=function(level,delay,clean){Log.rePrintAll(level,delay,!clean,this.collection)};Log.prototype.FINEST=function(message,plain){logger(this,"FINEST: ",false,message,plain,"color:#CCCCCC;",false,Log.LEVEL_FINEST)};Log.prototype.FINE=function(message,plain){logger(this,"FINE: ",false,message,plain,"color:#999999;",false,Log.LEVEL_FINE)};Log.prototype.INFO=function(message,plain,style){logger(this,"INFO: ",
"info",message,plain,style,style,Log.LEVEL_INFO)};Log.prototype.WARN=function(message,plain){logger(this,"WARN: ","warn",message,plain,"color:#26A110;",false,Log.LEVEL_WARN)};Log.prototype.ERROR=function(message,plain){logger(this,"ERROR: ","error",message,plain,"color:red;",false,Log.LEVEL_ERROR)};Log.setConsole(Define.global().console);Log.setLevelFromCookie()})();(function(){function addAnonymousAcessor(obj){return Utils.addToArrayIfNotExist(Utils.ANON_VARS,obj)}function escapeRegExp(string){return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,
"\\$1")}function existsInPath(object,copy){var len=travelArray.length;for(var i=0;i<len;i++)if(object===travelArray[i][0])return travelArray[i][1];travelArray[travelArray.length]=[object,copy];return false}function _objectCopy(obj,cfg,maxDeep,start,parentObj){var nodes=false;var noOwn=false;var noFunctions=false;var win=false;var all=false;var copyReference=false;var emptyForMaxDeep=false;if(cfg){all=!!cfg.all;nodes=all||cfg.nodes;win=all||cfg.win;noOwn=all;emptyForMaxDeep=!!cfg.emptyForMaxDeep;noFunctions=
cfg.noFunctions&&!all;if(cfg.noOwn!==undefined)noOwn=!!cfg.noOwn;if(cfg.noFunctions!==undefined)noFunctions=!!cfg.noFunctions;if(cfg.win!==undefined)win=!!cfg.win;if(cfg.nodes!==undefined)nodes=!!cfg.nodes;copyReference=!!cfg.copyReference}if(maxDeep!==undefined&&!maxDeep){if(emptyForMaxDeep)return;return obj}else if(maxDeep!==undefined)maxDeep--;if(!obj||!(obj instanceof Object))return obj;if(!nodes){try{if(obj instanceof Node)return obj}catch(ie){if(obj instanceof ActiveXObject&&obj.nodeType!==
undefined)return obj}if(obj===document)return obj}if(!win)if(obj===global)return obj;var copy=obj instanceof Array?[]:{};if(obj instanceof Date)copy=new Date(obj);if(!noFunctions&&obj instanceof Function){var funStr=String(obj).replace(/\s+/g,"");if(funStr.indexOf("{[nativecode]}")+14===funStr.length)copy=function(){return obj.apply(parentObj||this,arguments)};else copy=function(){return obj.apply(this,arguments)}}if(start===undefined){travelArray=[];start=0}var existingCopy=existsInPath(obj,copy);
if(existingCopy)return existingCopy;var i;if(copy instanceof Array)for(i=0;i<obj.length;i++)if(obj[i]===obj[i])copy[copy.length]=_objectCopy(obj[i],cfg,maxDeep,start+1,obj);else copy[copy.length]=obj[i];else{i=0;for(var prop in obj){if(noOwn||obj.hasOwnProperty(prop))if(obj[prop]===obj[prop])copy[prop]=_objectCopy(obj[prop],cfg,maxDeep,start+1,obj);else copy[prop]=obj[prop];i++}}if(cfg.proto)copy.prototype=_objectCopy(obj.prototype,cfg,maxDeep,start+1,obj);if(copyReference)copy.___copy_ref=obj;return copy}
function existsInTraversePath(object,max){for(var i=0;i<max&&i<traverseArray.length;i++)if(object===traverseArray[i])return true;return false}function _traverse(obj,exe,cfg,start,parent,prop,trackPath,maxDeep){cfg=cfg||{};if(cfg.hasOwn===undefined)cfg.hasOwn=true;if(cfg.objectsOnly&&!(obj instanceof Object))return;if(maxDeep!==undefined&&!maxDeep)return;else if(maxDeep!==undefined)maxDeep--;if(!cfg||!cfg.nodes)try{if(obj instanceof Node)return}catch(ie){if(obj instanceof ActiveXObject&&obj.nodeType!==
undefined)return}if(obj===global)return;if(start===undefined){traverseArray=[];start=0}if(existsInTraversePath(obj,start))return;traverseArray[start]=obj;parent=parent||obj;if(parent&&prop&&parent[prop]!==parent[prop])return;var stopHere=exe(obj,parent,prop,trackPath);if(stopHere)return;var i=0;var objPath="";for(var pprop in obj){if(!cfg.hasOwn||obj.hasOwnProperty(pprop))try{var object=obj[pprop];if(cfg.track)objPath=trackPath?trackPath+"."+pprop:pprop;_traverse(object,exe,cfg,start+1,parent,pprop,
objPath,maxDeep)}catch(e){}i++}}var Define=qubit.Define;var Cookie=qubit.Cookie;var Utils=function(){};var global=Define.global();Define.clazz("qubit.opentag.Utils",Utils);Utils.global=Define.global;Utils.namespace=Define.namespace;Utils.clazz=Define.clazz;Utils.getObjectUsingPath=function(path,base){base=base||global;var parts=path.split(".");for(var i=0;i<parts.length;i++)if(base&&parts[i])base=base[parts[i]];return base};Utils.getParentObject=function(name){var idx=name.lastIndexOf(".");var path=
name.substring(0,idx);return Utils.getObjectUsingPath(path)};Utils.variableExists=function(value){return value!==undefined&&value!==null};Utils.ANON_VARS=[];Utils.getAnonymousAcessor=function(obj){var index=Utils.indexInArray(obj,Utils.ANON_VARS);if(index===-1)index=addAnonymousAcessor(obj);return"qubit.opentag.Utils.ANON_VARS["+index+"]"};Utils.replaceAll=function(string,pattern,replace){return string.replace(new RegExp(escapeRegExp(pattern),"g"),replace)};Utils.secureText=function(string){if(typeof string!==
"string")string+="";string=string.replace(/</g,"\x26lt;");string=string.replace(/>/g,"\x26gt;");return string};Utils.getUrl=function(){return document.location.href};Utils.getQueryParam=function(param){var i;var ii;var params;var url;var query;var queries;var splitQuery;url=Utils.getUrl();if(url.indexOf("?")>0){queries=url.substring(url.indexOf("?")+1).split("\x26");for(i=0,ii=queries.length;i<ii;i+=1){query=queries[i];if(query.indexOf("\x3d")>0){splitQuery=query.split("\x3d");if(splitQuery.length===
2&&splitQuery[0]===param)return splitQuery[1]}}}return null};Utils.getElementValue=function(elementId){var el=document.getElementById(elementId);if(el)return el.textContent||el.innerText;return null};var travelArray=[];Utils.objectCopy=function(obj,cfg){cfg=cfg||{};var res=_objectCopy(obj,cfg,cfg.maxDeep);travelArray=[];return res};var traverseArray=[];Utils.traverse=function(obj,exe,cfg){var u;_traverse(obj,exe,cfg,u,u,u,u,cfg.maxDeep)};Utils.prepareQuotedString=function(string){if(typeof string===
"string")return'"'+string.replace(/\"/g,'\\"')+'"';else return string};Utils.expressionToFunction=function(expr,argzString){argzString=argzString||"";var funTemplate="function ("+argzString+") {"+expr+"}";return Utils.gevalAndReturn(funTemplate).result};Utils.defineWrappedClass=function(classPath,extClass,prototypeTemplate,pckg,constr){var clazz=function(){if(constr)return constr.apply(this,arguments);else return extClass.apply(this,arguments)};Define.clazz(classPath,clazz,extClass,pckg);for(var prop in prototypeTemplate)if(prototypeTemplate.hasOwnProperty(prop)&&
prop!=="CONSTRUCTOR")clazz.prototype[prop]=prototypeTemplate[prop];return clazz};Utils.copyAandAddFromB=function(A,B,maxDeep){maxDeep=maxDeep||8;var copy=this.objectCopy(A,{maxDeep:maxDeep});for(var prop in B)if(B.hasOwnProperty(prop))copy[prop]=B[prop];return copy};Utils.keys=function(obj){if(obj instanceof Object){if(Object.keys)return Object.keys(obj);var keys=[];for(var prop in obj)if(obj.hasOwnProperty(prop))keys[keys.length]=prop;return keys}else throw"keys() called on non-object!";};Utils.getSrcElement=
function(evt){var elem;evt=evt||window.event;if(evt.srcElement)elem=evt.srcElement;else if(evt.target)elem=evt.target;return elem};Utils.addToArrayIfNotExist=function(array,obj,equals){var i=0;for(var exists=false;i<array.length;i+=1){var tmp=equals&&equals(array[i],obj);if(tmp||array[i]===obj){exists=true;break}}if(!exists){array[array.length]=obj;i=-1}return i};Utils.indexInArray=function(array,obj){for(var i=0;i<array.length;i++)if(array[i]===obj)return i;return-1};Utils.existsInArray=function(array,
obj){for(var i=0;i<array.length;i++)if(array[i]===obj)return true;return false};Utils.removeFromArray=function(array,obj){var i=0;for(var total=0;i<array.length;)if(array[i]===obj){array.splice(i,1);total++}else i++;return total};Utils.addClass=function(node,name){var classes;try{node.classList.add(name)}catch(ex){if(node.className===null){node.className=name;return}classes=node.className.split(" ");Utils.addToArrayIfNotExist(classes,name);node.className=classes.join(" ")}};Utils.removeClass=function(node,
name){var classes;try{node.classList.remove(name)}catch(ex){if(node.className===null){node.className="";return}classes=node.className.split(" ");Utils.removeFromArray(classes,name);node.className=classes.join(" ")}};var prefix="try{this.qubitopentagutilsgevalandreturn__var_test__\x3d(";var suffix=");}catch(ex){"+"this.qubitopentagutilsgevalandreturn__var_test__error \x3d ex;}";Utils.gevalAndReturn=function(expression){var G=GLOBAL;G.qubitopentagutilsgevalandreturn__var_test__=undefined;G.qubitopentagutilsgevalandreturn__var_test__error=
undefined;expression=prefix+expression+suffix;Utils.geval(expression);var res=G.qubitopentagutilsgevalandreturn__var_test__;var err=G.qubitopentagutilsgevalandreturn__var_test__error;try{G.qubitopentagutilsgevalandreturn__var_test__=UNDEF;G.qubitopentagutilsgevalandreturn__var_test__error=UNDEF;delete G.qubitopentagutilsgevalandreturn__var_test__;delete G.qubitopentagutilsgevalandreturn__var_test__error}catch(ex){}return{result:res,error:err}};Utils.trim=function(string){try{return String(string).trim()}catch(noTrim){return String(string).replace(/^\s+|\s+$/g,
"")}};Utils.setIfUnset=function(obj,src){if(obj&&src)for(var prop in src)if(src.hasOwnProperty(prop)&&!obj.hasOwnProperty(prop))obj[prop]=src[prop]};var rndSeed=Math.floor(Math.random()*1E12);Utils.UUID=function(){if(!global.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__)global.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__=(new Date).valueOf();return rndSeed+"."+ ++global.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__};Utils.overrideFromLeftToRight=function(A,B){if(A&&B)for(var prop in B)if(B.hasOwnProperty(prop))A[prop]=
B[prop];return A};Utils.geval=function(expression){if(window&&window.execScript)return window.execScript(expression===""?" ":expression);else return function(){return global["eval"].call(global,expression)}()};var _availStack=[];Utils.bodyAvailable=function(callback){var avail=!!document.body;if(avail){if(_availStack){for(var i=0;i<_availStack.length;i++)try{_availStack[i]()}catch(ex){}_availStack=false}callback()}else _availStack.push(callback)};Utils.rmCookiesMatching=function(string){var cookies=
Cookie.getAll();for(var i=0;i<cookies.length;i++){var name=cookies[i][0];if(name.match(string)===0)Cookie.rm(name)}};var _readyCalls=[];var _loaded=false;var _flushed=false;Utils.bodyReady=function(callback){if(_flushed){if(callback)callback();return true}_loaded=_loaded||!!(document.body&&document.readyState==="complete");if(_loaded){_flushed=true;for(var i=0;i<_readyCalls.length;i++)try{_readyCalls[i]()}catch(ex){}if(callback)callback()}else if(callback)_readyCalls.push(callback);return _loaded};
var oldOnload=global.onload;global.onload=function(e){try{Utils.bodyReady()}catch(ex){try{window.qubit.opentag.Utils.bodyReady()}catch(ex1){}}var oldRef=false;try{oldRef=oldOnload}catch(ex2){}if(oldRef)oldRef(e)};(function(){var DOMContentLoaded;var isReady=false;var readyWait=1;var readyList;var readyComplete;var bindReadyComplete;var doScrollCheck;readyComplete=function(wait){var f;if(wait===true)readyWait-=1;if(!readyWait||wait!==true&&!isReady){if(!document.body)return setTimeout(readyComplete,
1);isReady=true;if(wait!==true){readyWait-=1;if(readyWait>0)return}for(;readyList.length>0;){f=readyList.shift();f()}}};doScrollCheck=function(){if(isReady)return;try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}readyComplete()};bindReadyComplete=function(){if(readyList)return;readyList=[];if(document.readyState==="complete")return setTimeout(readyComplete,1);if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);
window.addEventListener("load",readyComplete,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",readyComplete);var toplevel=false;try{toplevel=window.frameElement===null||window.frameElement===undefined}catch(e){}if(document.documentElement.doScroll&&toplevel)doScrollCheck()}};var ready=function(fn){bindReadyComplete();if(isReady)setTimeout(fn,1);else readyList.push(fn)};if(document.addEventListener)DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",
DOMContentLoaded,false);readyComplete()};else if(document.attachEvent)DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);readyComplete()}};ready(function(){_loaded=true;Utils.bodyReady()})})()})();var JSON={};(function(){function f(n){return n<10?"0"+n:n}function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+
a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function stringifyDate(key){return isFinite(key.valueOf())?key.getUTCFullYear()+"-"+f(key.getUTCMonth()+1)+"-"+f(key.getUTCDate())+"T"+f(key.getUTCHours())+":"+f(key.getUTCMinutes())+":"+f(key.getUTCSeconds())+"Z":null}function str(key,holder){var i;var k;var v;var length;var mind=gap;var partial;var value=holder[key];if(value instanceof Date)value=stringifyDate(value);else if(value instanceof String||value instanceof Number||value instanceof
Boolean)value=value.valueOf();if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1)try{partial[i]=str(i,value)||"null"}catch(stackExceeded){partial[i]='{"stack_exceeded": null}'}v=
partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1)if(typeof rep[i]==="string"){k=rep[i];try{v=str(k,value)}catch(stackExceeded){v='{"stack_exceeded": null}'}if(v)partial.push(quote(k)+(gap?": ":":")+v)}}else for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){try{v=str(k,value)}catch(stackExceeded){v='{"stack_exceeded": null}'}if(v)partial.push(quote(k)+
(gap?": ":":")+v)}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var gap;var indent;var meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var rep;
if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!=="function")JSON.parse=function(text,reviver){function walk(holder,key){var k;var v;var value=
holder[key];if(value&&typeof value==="object")for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();var q={};q.html=q.html||{};(function(){function trim(text){return text.replace(/^\s+/,"").replace(/\s+$/,"")}var UVListener={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null};var uv;var uvLocation="universal_variable";var starterId=0;var POLL_DELAY_MS=500;var timer;UVListener._isArray=function(input){return Object.prototype.toString.call(input)===
"[object Array]"};UVListener._targetChanged=function(keyString,old,newObject){var oldAsObject;var oldTarget;var newTarget;if(newObject===null)if(old==="null")return false;else return true;else if(newObject===undefined)if(old===newObject)return false;else return true;else{oldAsObject=JSON.parse(old);oldTarget=UVListener._getNested(oldAsObject,keyString);newTarget=UVListener._getNested(newObject,keyString);return!UVListener._jsonIsEqual(oldTarget,newTarget)}};UVListener._processCallbacks=function(){var i;
if(UVListener.early_callbacks&&UVListener.early_callbacks.length>0){for(i=0;i<UVListener.early_callbacks.length;i+=1)UVListener.push(UVListener.early_callbacks[i]);UVListener.early_callbacks=null}};UVListener._keyStringToArr=function(keyString){keyString=trim(keyString);if(keyString==="")return[];else{keyString=keyString.replace(/\[(\w+)\]/g,".$1");keyString=keyString.replace(/^\./,"");return keyString.split(".")}};UVListener._getNested=function(object,keyString){var arr=UVListener._keyStringToArr(keyString);
for(var n;arr.length>0;){n=arr.shift();if(object.hasOwnProperty(n))object=object[n];else return}return object};UVListener._jsonIsEqual=function(obj1,obj2){if(typeof obj1!=="string")obj1=JSON.stringify(obj1,UVListener._stripEvents);if(typeof obj2!=="string")obj2=JSON.stringify(obj2,UVListener._stripEvents);return obj1===obj2};UVListener._stripEvents=function(key,value){if(key!=="events")return value;else return undefined};UVListener._on=function(type,func){var typeArray;var key;typeArray=type.split(":");
type=typeArray[0];key=typeArray[1];UVListener.callbacks[type]=UVListener.callbacks[type]||[];if(key)UVListener.callbacks[type].push({keyString:key,func:func});else UVListener.callbacks[type].push({func:func})};UVListener._trigger=function(type,data){var i;var keyString;if(UVListener.callbacks[type])for(i=0;i<UVListener.callbacks[type].length;i+=1)if(typeof UVListener.callbacks[type][i].func==="function"){keyString=UVListener.callbacks[type][i].keyString;if(keyString){if(type==="change"&&UVListener._targetChanged(keyString,
UVListener.currentUV,uv))UVListener.callbacks[type][i].func(data)}else UVListener.callbacks[type][i].func(data)}};UVListener._eventsPush=function(evt){var i;var ii;uv.events[uv.events.length]=evt;evt.time=evt.time||(new Date).getTime();if(UVListener.callbacks.event){i=0;ii=UVListener.callbacks.event.length;for(i;i<ii;i+=1)UVListener.callbacks.event[i].func(evt)}evt.has_fired=true};UVListener._getUnfiredEvents=function(){var i=0;for(i=0;i<uv.events.length;i+=1)if(!uv.events[i].has_fired){UVListener.unfired_events.push(uv.events.splice(i,
1)[0]);i-=1}};UVListener._fireEvents=function(){for(;UVListener.unfired_events.length>0;)uv.events.push(UVListener.unfired_events.shift())};UVListener._resetEventsPush=function(){uv.events=uv.events||[];if(uv.events.push.toString().indexOf("[native code]")!==-1){uv.events.push=UVListener._eventsPush;UVListener._getUnfiredEvents();UVListener._fireEvents()}};UVListener._checkForChanges=function(){if(UVListener.callbacks.change&&UVListener.callbacks.change.length>0)if(!UVListener._jsonIsEqual(UVListener.currentUV,
uv)){UVListener._trigger("change",uv);UVListener.currentUV=JSON.stringify(uv,UVListener._stripEvents)}};UVListener._setUVLocation=function(newLoc){uvLocation=newLoc;UVListener._initUV()};UVListener._initUV=function(){window[uvLocation]=window[uvLocation]||{events:[]};uv=window[uvLocation];if(!uv.events)uv.events=[]};UVListener.push=function(data){if(!UVListener._isArray(data))return;if(data[0]==="on")UVListener._on(data[1],data[2]);else if(data[0]==="trigger"&&data[1])UVListener._trigger(data[1])};
UVListener.init=function(testing,uvLoc){if(uvLoc)uvLocation=uvLoc;UVListener._initUV();if(!window.uv_listener||UVListener._isArray(window.uv_listener)){UVListener.early_callbacks=window.uv_listener||null;window.uv_listener=UVListener;if(!testing)UVListener.start()}else if(uvLoc)window.uv_listener._setUVLocation(uvLocation)};UVListener.start=function(){UVListener.currentUV=JSON.stringify(uv,UVListener._stripEvents);timer=setInterval(function(){UVListener._initUV();UVListener._resetEventsPush();UVListener._checkForChanges()},
POLL_DELAY_MS);UVListener._processCallbacks()};q.html.UVListener=UVListener})();(function(){function Timer(config){if(config){this._rate=config.rate||10;this._smallestRate=-1;if(config.start)this.startPooling();this.config=config}this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}qubit.Define.clazz("qubit.opentag.Timer",Timer);Timer.prototype.timers=[];Timer.prototype.startPooling=function(smallestRate){if(smallestRate&&this.config.dynamic)if(this._smallestRate<0||this._smallestRate>
smallestRate)this._smallestRate=Math.min(Math.floor(smallestRate/2),1500);if(!this.started){this.started=true;setTimeout(this._binded_pool,0)}};Timer.prototype._pool=function(){this.maxFrequent(function(){var name="";if(this.config&&this.config.name)name="["+this.config.name+"]"},5E3,this._lck_obj);this.callTimers();if(this.timers.length!==0){var rate=this._smallestRate>this._rate?this._smallestRate:this._rate;setTimeout(this._binded_pool,rate)}else{this.started=false;this._smallestRate=-1}};Timer.prototype.callTimers=
function(){this.lastCalled=(new Date).valueOf();for(var i=0;i<this.timers.length;i++){var timer=this.timers[i];var stamp=(new Date).valueOf();if(stamp>=timer.time){try{timer.execute()}catch(e){}this.timers.splice(i,1);--i}}};Timer.prototype.cancellAll=function(){this.timers=[]};Timer.prototype.setRate=function(time){this._rate=time};Timer.prototype.maxFrequent=function(fun,time,lockObj){if(!lockObj){fun.__maxFrequent__timer_opentag_qubit_=fun.__maxFrequent__timer_opentag_qubit_||{};lockObj=fun.__maxFrequent__timer_opentag_qubit_}var last=
lockObj.____last__timed__max__frequent____;if(!last||(new Date).valueOf()-last>time){last=(new Date).valueOf();lockObj.____last__timed__max__frequent____=last;fun()}};Timer.prototype.runIfNotScheduled=function(fun,time,lockObj){lockObj=lockObj||fun;if(lockObj.__lastRun__&&(new Date).valueOf()<time+lockObj.__lastRun__)return this.schedule(fun,time,lockObj);else{lockObj.__lastRun__=(new Date).valueOf();fun();return true}};Timer.prototype.schedule=function(fun,time,lockObj){if(lockObj.___scheduled___)return false;
else{lockObj.___scheduled___=(new Date).valueOf();this.setTimeout(function(){lockObj.___scheduled___=false;lockObj.__lastRun__=(new Date).valueOf();fun()},time);return true}};var ids=1;Timer.prototype.setTimeout=function(call,time){var timer={id:ids++,time:(new Date).valueOf()+ +time,execute:call};this.timers.push(timer);this.startPooling(time);return timer};Timer.prototype.setInterval=function(call,time){var interv=setInterval(call,time);this.inervals.push(interv);return interv}})();(function(){qubit.Define.namespace("qubit.opentag.Timed",
new qubit.opentag.Timer({rate:37,dynamic:true}));var Timed=qubit.opentag.Timed;Timed.tillTrue=function(test,callback,often){var runner=function(){if(!test())Timed.setTimeout(runner,often||33);else callback()};runner()}})();q.html.fileLoader={};q.html.fileLoader.load=function(url,preLoadAction,postLoadHandler,parentNode,async,attributes){var scriptEl;var preLoadResult;var loadError;var doPostLoad;var loaded;loaded=false;doPostLoad=function(loadFailed){return function(){if(!loaded){loaded=true;if(loadFailed&&
!loadError)loadError={url:document.location.href};postLoadHandler(url,loadError,loadFailed)}}};try{if(preLoadAction)preLoadResult=preLoadAction(url)}catch(e){preLoadResult=false;postLoadHandler(url,"Exception loading pre",true)}finally{if(preLoadResult!==false){scriptEl=q.html.fileLoader.createScriptEl(url,async,false,attributes);if(postLoadHandler){scriptEl.onload=doPostLoad(false);scriptEl.onerror=doPostLoad(true);scriptEl.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState===
"loaded")setTimeout(function(){doPostLoad(false)()},1)}}if(!parentNode)parentNode=window.document.getElementsByTagName("head")[0];parentNode.appendChild(scriptEl)}}};q.html.fileLoader.createScriptEl=function(path,async,forceReload,attr){var a;var scriptEl=document.createElement("script");scriptEl.type="text/javascript";scriptEl.src=q.html.fileLoader.tidyUrl(path)+(forceReload?"?"+(new Date).getTime():"");if(async!==false){scriptEl.async="true";scriptEl.defer="true"}else{scriptEl.async="false";if(scriptEl.async!==
false)scriptEl.async=false;scriptEl.defer="false";if(scriptEl.defer!==false)scriptEl.defer=false}for(a in attr)if(attr.hasOwnProperty(a))scriptEl.setAttribute(a,attr[a]);return scriptEl};q.html.fileLoader.tidyUrl=function(path){if(path.substring(0,5)==="http:")return path;if(path.substring(0,6)==="https:")return path;return"//"+path};(function(){function Events(config){this.calls={}}var Define=qubit.Define;var Utils=qubit.opentag.Utils;Events.prototype.on=function(name,call){if(!this.calls[name])this.calls[name]=
[];return Utils.addToArrayIfNotExist(this.calls[name],call)};Events.prototype.call=function(name,event){var calls=this.calls[name];if(calls)for(var i=0;i<calls.length;i++)try{calls[i](event)}catch(ex){}};Events.prototype.remove=function(name,call){if(this.calls[name])return Utils.removeFromArray(this.calls[name],call);return null};Events.prototype.removeAll=function(call){var total=0;for(var prop in this.calls)if(this.calls.hasOwnProperty(prop))total+=Utils.removeFromArray(this.calls[prop],call);
return total};Events.prototype.clear=function(){this.calls={}};Define.clazz("qubit.Events",Events)})();(function(){function BaseFilter(config){this.log=new qubit.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:true,name:"Filter-"+counter++,script:undefined,session:undefined,restartable:true};this.runtimeId=Utils.UUID();this.session=null;if(config){for(var prop in config)if(config.hasOwnProperty(prop))this.config[prop]=
config[prop];if(config.session)this.setSession(config.session);this.register(this)}this.events=new qubit.Events({})}var Utils=qubit.opentag.Utils;var counter=0;var filters=[];qubit.Define.clazz("qubit.opentag.filter.BaseFilter",BaseFilter);BaseFilter.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};var RESTART_EVENT="restart";BaseFilter.prototype.EVENT_TYPES={RESTART_EVENT:RESTART_EVENT};BaseFilter.prototype.prepareForRestart=function(){if(this.config.restartable){this.events.call(RESTART_EVENT,this);
this.reset()}};BaseFilter.prototype.onRestart=function(callback){this.events.on(RESTART_EVENT,callback)};BaseFilter.prototype.reset=function(){this.runtimeId=Utils.UUID();this.enable()};BaseFilter.prototype.disable=function(){this.config.disabled=true};BaseFilter.prototype.enable=function(){this.config.disabled=false};BaseFilter.prototype.match=function(){return true};BaseFilter.prototype.setSession=function(session){this.session=session};BaseFilter.prototype.getSession=function(){return this.session};
BaseFilter.prototype.getState=function(){var passed=BaseFilter.state.PASS;if(this.config.disabled)return BaseFilter.state.DISABLED;if(this.config.script)passed=this.config.script.call(this,passed);if(isNaN(+passed))passed=BaseFilter.state.FAIL;this.lastState=+passed;return passed};BaseFilter.getFilters=function(){return filters};BaseFilter.prototype.register=function(){BaseFilter.register(this)};BaseFilter.register=function(filter){Utils.addToArrayIfNotExist(filters,filter)}})();(function(){var Define=
qubit.Define;var PatternType={CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"};Define.namespace("qubit.opentag.filter.pattern.PatternType",PatternType)})();(function(){function URLFilter(config){this._lockObject={};var defaultConfig={patternType:PatternType.CONTAINS,pattern:""};if(config)for(var prop in config)if(config.hasOwnProperty(prop))defaultConfig[prop]=config[prop];URLFilter.SUPER.call(this,
defaultConfig)}var Utils=qubit.opentag.Utils;var BaseFilter=qubit.opentag.filter.BaseFilter;var Timed=qubit.opentag.Timed;var PatternType=qubit.opentag.filter.pattern.PatternType;qubit.Define.clazz("qubit.opentag.filter.URLFilter",URLFilter,BaseFilter);URLFilter.prototype.PATTERNS=PatternType;URLFilter.prototype.getURL=function(url){return url||Utils.getUrl()};URLFilter.prototype.match=function(url){url=this.getURL(url);var match=true;var pattern=this.config.pattern;switch(this.config.patternType){case PatternType.CONTAINS:match=
url.toLowerCase().indexOf(pattern.toLowerCase())>=0;break;case PatternType.MATCHES_EXACTLY:match=url.toLowerCase()===this.config.pattern.toLowerCase();break;case PatternType.STARTS_WITH:match=url.toLowerCase().indexOf(pattern.toLowerCase())===0;break;case PatternType.ENDS_WITH:match=url.lastIndexOf(pattern.toLowerCase())+pattern.length===url.length;break;case PatternType.REGULAR_EXPRESSION:match=(new RegExp(pattern)).test(url);break;case PatternType.ALL_URLS:match=true;break}return match}})();(function(){function Filter(config){var defaultConfig=
{};if(config){for(var prop in config)if(config.hasOwnProperty(prop)){if(prop==="customStarter"&&config[prop])this.customStarter=config[prop];else if(prop==="customScript"&&config[prop])this.customScript=config[prop];defaultConfig[prop]=config[prop]}this.uid="f"+sessionVariableFilterCount++}this.tagsToRun=[];Filter.SUPER.call(this,defaultConfig)}var BaseFilter=qubit.opentag.filter.BaseFilter;var URLFilter=qubit.opentag.filter.URLFilter;var Utils=qubit.opentag.Utils;var sessionVariableFilterCount=0;
qubit.Define.clazz("qubit.opentag.filter.Filter",Filter,URLFilter);Filter.prototype.customStarter=function(session,ready,tag){ready(false)};Filter.prototype.isSession=function(){if(this.config.sessionDisabled)return false;if(this.customStarter===null&&this.customScript===null)return false;return true};Filter.prototype.customScript=function(session){return true};Filter.prototype.match=function(url){var match=true;try{if(this.customScript){if(this._matchState===undefined)this._matchState=!!this.customScript(this.getSession());
match=this._matchState}}catch(ex){match=false}return match&&Filter.SUPER.prototype.match.call(this,url)};Filter.prototype.runTag=function(tag){Utils.addToArrayIfNotExist(this.tagsToRun,tag);if(!this.starterExecuted){if(!this._starterWasRun){this._starterWasRun=true;var recallUUID=this.runtimeId;var callback=function(rerun){if(recallUUID!==this.runtimeId)return;this.reRun=rerun;this.starterExecuted=(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);if(this.customStarter)this.customStarter(this.getSession(),
callback,tag);else Filter.prototype.customStarter.call(this,this.getSession(),callback,tag)}}else this._triggerTag(tag)};Filter.prototype._processQueuedTagsToRun=function(){for(var i=0;i<this.tagsToRun.length;i++){var tag=this.tagsToRun[i];this._triggerTag(tag)}};Filter.prototype._triggerTag=function(tag){if(this.reRun===true)tag.run();else tag.runOnce()};Filter.prototype.getState=function(session){if(session)this.setSession(session);var pass=Filter.SUPER.prototype.getState.call(this);if(pass===BaseFilter.state.DISABLED)return BaseFilter.state.DISABLED;
if(pass===BaseFilter.state.PASS)if(this.isSession())pass=BaseFilter.state.SESSION;if(this.config.script)pass=this.config.script.call(this,pass,this.getSession());this.lastState=pass;return pass};Filter.prototype.reset=function(){Filter.SUPER.prototype.reset.call(this);this._matchState=undefined;this._starterWasRun=undefined;this.starterExecuted=undefined;this.tagsToRun=[];this.reRun=undefined}})();q.html.GlobalEval={};q.html.GlobalEval.globalEval=function(src){if(window.execScript)window.execScript(src===
""?" ":src);else{var fn=function(){window["eval"].call(window,src)};fn()}};q.html.HtmlInjector={};q.html.HtmlInjector.inject=function(el,injectStart,str,cb,parentNode){var i;var ii;var d;var scriptsRaw;var scripts;var script;var contents;if(str.toLowerCase().indexOf("\x3cscript")>=0){d=document.createElement("div");d.innerHTML="a"+str;scriptsRaw=d.getElementsByTagName("script");scripts=[];for(i=0,ii=scriptsRaw.length;i<ii;i+=1)scripts.push(scriptsRaw[i]);contents=[];for(i=0,ii=scripts.length;i<ii;i+=
1){script=scripts[i];var s={attributes:q.html.HtmlInjector.getAttributes(script)};if(script.src)s.src=script.src;else s.script=script.innerHTML;contents.push(s);script.parentNode.removeChild(script)}if(d.innerHTML)if(d.innerHTML.length>0)d.innerHTML=d.innerHTML.substring(1);q.html.HtmlInjector.doInject(el,injectStart,d);q.html.HtmlInjector.loadScripts(contents,0,cb,el)}else{d=document.createElement("div");d.innerHTML=str;q.html.HtmlInjector.doInject(el,injectStart,d);if(cb)cb()}};q.html.HtmlInjector.doInject=
function(el,injectStart,d){if(d.childNodes.length>0){for(var fragment=document.createDocumentFragment();d.childNodes.length>0;)fragment.appendChild(d.removeChild(d.childNodes[0]));if(injectStart)q.html.HtmlInjector.injectAtStart(el,fragment);else q.html.HtmlInjector.injectAtEnd(el,fragment)}};q.html.HtmlInjector.injectAtStart=function(el,fragment){if(el.childNodes.length===0)el.appendChild(fragment);else el.insertBefore(fragment,el.childNodes[0])};q.html.HtmlInjector.injectAtEnd=function(el,fragment,
counter){if(!counter)counter=1;if(el===document.body&&document.readyState!=="complete"&&counter<50)setTimeout(function(){q.html.HtmlInjector.injectAtEnd(el,fragment,counter+1)},100);else el.appendChild(fragment)};q.html.HtmlInjector.loadScripts=function(contents,i,cb,parentNode){var ii;var c;var foundSrc=false;for(ii=contents.length;i<ii;i+=1){c=contents[i];if(c.src){foundSrc=true;break}else q.html.GlobalEval.globalEval(c.script)}if(foundSrc)q.html.fileLoader.load(c.src,null,function(){q.html.HtmlInjector.loadScripts(contents,
i+1,cb,parentNode)},parentNode,false,c.attributes);if(cb&&i===ii)cb()};q.html.HtmlInjector.getAttributes=function(node){var a;var aLength;var attributes;var val;var name;var map={};if(node){attributes=node.attributes;aLength=attributes.length;for(a=0;a<aLength;a++){val=attributes[a].value;name=attributes[a].name.toLowerCase();if(val!==""&&(name==="id"||name==="class"||name==="charset"||name.substr(0,5)==="data-"))map[name]=val}return map}};(function(){function saveDocWriteMethods(){redirectedDocWriteMethods=
redirectedDocWriteMethods||{write:document.write,writeln:document.writeln}}function unlockDocWriteMethods(){document.write=redirectedDocWriteMethods.write;document.writeln=redirectedDocWriteMethods.writeln;redirectedDocWriteMethods=null}var BaseFilter=qubit.opentag.filter.BaseFilter;var Utils=qubit.opentag.Utils;var HtmlInjector=q.html.HtmlInjector;var FileLoader=q.html.fileLoader;var Filter=qubit.opentag.filter.Filter;var TagsUtils=function(){};qubit.Define.clazz("qubit.opentag.TagsUtils",TagsUtils);
var _bodyLoaded=false;TagsUtils.bodyLoaded=function(){if(_bodyLoaded)return true;_bodyLoaded=!!(document.body&&document.readyState!=="loading");return _bodyLoaded};TagsUtils.bodyAvailable=function(callback){return!!document.body};var loadedURLs={};var STATE={SUCCESS:"success",FAIL:"failure",INIT:"not started"};TagsUtils.loadScript=function(config){var url=config.url;var loadingCheck=function(passedUrlFromLoader,loadError,loadFailed){loadedURLs[url].error=loadError;if(loadFailed){loadedURLs[url].state=
STATE.FAIL;config.onerror()}else{loadedURLs[url].state=STATE.SUCCESS;config.onsuccess()}};if(loadedURLs[url]){if(config.noMultipleLoad)return loadingCheck(url,loadedURLs[url].error,loadedURLs[url].state===STATE.FAIL);loadedURLs[url].count+=1}else loadedURLs[url]={count:1,state:null};var useWrite=!config.async;var loaded=TagsUtils.bodyLoaded();if(useWrite&&loaded);useWrite=useWrite&&!loaded;if(useWrite)TagsUtils.writeScriptURL(url,function(allOk,error){loadingCheck(url,error,!allOk)});else FileLoader.load(url,
false,loadingCheck,config.node,config.async)};var redirectedDocWriteMethods=null;TagsUtils.redirectDocumentWritesToArray=function(array,log){var text=array;saveDocWriteMethods();document.write=function(t){text.push(t)};document.writeln=function(t){text.push(t)}};TagsUtils.flushDocWritesArray=function(array,location,append,log,cb){var el=location;if(el&&array){var flushed=array.splice(0,array.length);try{TagsUtils.injectHTML(el,append,flushed.join("\n"),cb||EMPTY_FUN);return true}catch(ex){}}else{var message=
"Flushing location not found!";return false}if(cb)cb();return true};TagsUtils.unlockDocumentWrites=function(){if(redirectedDocWriteMethods)unlockDocWriteMethods()};var accessorBasePath=TagsUtils.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks";var accesorBase={};qubit.Define.namespace(accessorBasePath,accesorBase,GLOBAL,true);var wsCounter=0;var startFrom=(new Date).valueOf();TagsUtils.writeScriptURL=function(url,callback){var callName="_"+startFrom+"_"+wsCounter++;var accessorName=accessorBasePath+
"."+callName;var called=false;accesorBase[callName]=function(error){if(called)return;called=true;if(error)callback(false,"error while loading script "+url);else callback(true);accesorBase[callName]=undefined;delete TagsUtils.writeScriptURL.callbacks[callName]};var jsIE='if(this.readyState \x3d\x3d\x3d "loaded" || '+'this.readyState \x3d\x3d\x3d "complete"){ try {'+accessorName+"(true)"+"} catch (ex) {}}";var jsNonIE="try{"+accessorName+"(false)}catch(ex){}";var jsNonIEerr="try{"+accessorName+"(true)}catch(ex){}";
var scr="scr";var value;url=FileLoader.tidyUrl(url);value="\x3c"+scr+"ipt onload\x3d'"+jsNonIE+"'  onerror\x3d'"+jsNonIEerr+"' onreadystatechange\x3d'"+jsIE+"' type\x3d'text/javascript' "+" src\x3d'"+url+"'\x3e"+"\x3c/"+scr+"ipt\x3e";if(redirectedDocWriteMethods){unlockDocWriteMethods();document.write(value);saveDocWriteMethods()}else document.write(value);Utils.bodyReady(function(){if(!called){called=true;callback(true)}})};TagsUtils.writeScriptURL.callbacks={};var SESSION=BaseFilter.state.SESSION;
var PASS=BaseFilter.state.PASS;var FAIL=BaseFilter.state.FAIL;TagsUtils.filtersState=function(filters,session,tag,runLastSessionFilterIfPresent){filters=filters.sort(function(a,b){try{var bOrder=b.config.order;var aOrder=a.config.order;if(isNaN(-aOrder))aOrder=0;if(isNaN(-bOrder))bOrder=0;return bOrder-aOrder}catch(nex){return 0}});var decision=PASS;if(!filters||filters.length===0)return decision;var lastReadyToProcessFilter=null;var disabledFiltersPresent=false;var sessionFiltersPresent=false;var waitingResponse=
0;var response;var lastSessionFilter;var sessionFiltersToRun=[];var filter;var lastUnmatched;for(var i=0;i<filters.length;i++){filter=filters[i];filter.setSession(session);if(filter.match()){response=filter.getState();if(response>0){if(waitingResponse===0||waitingResponse>response)waitingResponse=response}else if(response===BaseFilter.state.DISABLED)disabledFiltersPresent=true;else if(response===SESSION){sessionFiltersPresent=true;lastReadyToProcessFilter=filter;lastSessionFilter=filter;sessionFiltersToRun.push(filter)}else lastReadyToProcessFilter=
filter}else lastUnmatched=filter}var onlyAwaitingOrDisabledFiltersPresent=false;if(lastReadyToProcessFilter===null){onlyAwaitingOrDisabledFiltersPresent=true;if(!disabledFiltersPresent)decision=FAIL;else decision=PASS}else if(lastReadyToProcessFilter.config.include)decision=response;else decision=response===PASS?FAIL:PASS;if(waitingResponse>0&&(decision===PASS||onlyAwaitingOrDisabledFiltersPresent))decision=waitingResponse;if(decision===SESSION||decision===PASS&&sessionFiltersPresent){if(!lastSessionFilter.config.include)return FAIL;
decision=SESSION;if(lastSessionFilter instanceof Filter&&lastSessionFilter.isSession())if(runLastSessionFilterIfPresent)for(var c=0;c<sessionFiltersToRun.length;c++)try{sessionFiltersToRun[c].runTag(tag)}catch(ex){}}if(tag.config.dedupe&&decision===PASS)if(lastUnmatched&&lastUnmatched instanceof Filter&&lastUnmatched.isSession()){tag.sendDedupePing=true;decision=FAIL}return decision};TagsUtils.injectHTML=function(location,append,html,callback){return HtmlInjector.inject(location,!append?1:0,html,
callback||EMPTY_FUN)};TagsUtils.getHTMLLocationForTag=function(tag){var el;var name=tag.prepareLocationObject(tag.config.locationObject);switch(name){case "HEAD":el=document.getElementsByTagName("head")[0];break;case "BODY":el=document.body;break;default:if(name)el=document.getElementById(name);else el=document.body}return el}})();(function(){function BaseVariable(config){this.config={};this.handlers=[];this.parameters=null;this.callHandlersOnRead=false;if(config){this.uniqueId="BV"+BV_COUNTER++;
BaseVariable.ALL_VARIABLES[this.uniqueId]=this;for(var prop in config)if(config.hasOwnProperty(prop)){this.config[prop]=config[prop];if(prop==="value")this.value=config.value}var ret=BaseVariable.register(this);if(ret&&ret!==this);return ret}}function checkIfChangedAndContinue(){if(observingStopped)return false;for(var i=0;i<OBSERVED_VARIABLES.length;i++)try{var variable=OBSERVED_VARIABLES[i];variable.getValue()}catch(ex){}Timed.setTimeout(checkIfChangedAndContinue,BaseVariable.CHECK_POLL_RATE);return true}
var Utils=qubit.opentag.Utils;var Timed=qubit.opentag.Timed;var BV_COUNTER=0;qubit.Define.clazz("qubit.opentag.pagevariable.BaseVariable",BaseVariable);BaseVariable.ALL_VARIABLES={};var OBSERVED_VARIABLES=[];BaseVariable.OBSERVED_VARIABLES=OBSERVED_VARIABLES;BaseVariable.pageVariables=[];BaseVariable.register=function(variable){if(variable instanceof BaseVariable){for(var i=0;i<BaseVariable.pageVariables.length;i++){var regVar=BaseVariable.pageVariables[i];if(variable===regVar)return regVar}BaseVariable.pageVariables.push(variable);
return variable}return null};BaseVariable.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};BaseVariable.prototype._updateCurrentValue=function(newValue){if(!this.valuesAreEqual(newValue,this.currentValue)){this.oldValue=this.currentValue;this.currentValue=newValue;if(!observingStopped||this.callHandlersOnRead)this._handleValueChanged();return true}return false};BaseVariable.prototype.getDefaultValue=function(){return this.defaultValue};BaseVariable.prototype.setDefaultValue=
function(string){this.defaultValue=string};BaseVariable.prototype.exists=function(useDefaults){var exists=Utils.variableExists(this.getValue());if(useDefaults)exists=exists||Utils.variableExists(this.getDefaultValue());return exists};BaseVariable.prototype.getRelativeValue=function(useDefaults,defaultValue){var pageValue=this.getValue();if(!Utils.variableExists(pageValue))pageValue=defaultValue;var defLoc;if(useDefaults&&!Utils.variableExists(pageValue)){defLoc=this.getDefaultValue();if(Utils.variableExists(defLoc))pageValue=
defLoc}return pageValue};BaseVariable.prototype.replaceToken=function(token,string,altValue,useExpressionAccessor){var exists=this.exists();var value=exists?this.getValue():altValue;token="\\$\\{"+token+"\\}";if(useExpressionAccessor||value instanceof Array){var acessorString;if(exists)acessorString=this.getValueAccessorString();else acessorString=Utils.getAnonymousAcessor(value);return string.replace(new RegExp(token,"g"),acessorString)}else return string.replace(new RegExp(token,"g"),value)};BaseVariable.prototype.getAccessorString=
function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};BaseVariable.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};BaseVariable.prototype.onValueChanged=function(callback,startObserving){if(Utils.addToArrayIfNotExist(this.handlers,callback)===-1);if(startObserving!==false)this.startObservingForChanges()};BaseVariable.prototype.deatchOnValueChanged=function(callback){if(Utils.removeFromArray(this.handlers,callback)>0);};
BaseVariable.prototype._handleValueChanged=function(){var event={oldValue:this.oldValue,newValue:this.currentValue,variable:this};for(var i=0;i<this.handlers.length;i++)try{this.handlers[i](event)}catch(e){}};var observingStopped=true;BaseVariable.CHECK_POLL_RATE=333;BaseVariable.prototype.startObservingForChanges=function(){this.addToObservedVariables();if(observingStopped){observingStopped=false;checkIfChangedAndContinue()}};BaseVariable.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();
if(OBSERVED_VARIABLES.length===0)observingStopped=true};BaseVariable.prototype.addToObservedVariables=function(){Utils.addToArrayIfNotExist(OBSERVED_VARIABLES,this)};BaseVariable.prototype.removeFromObservedVariables=function(){Utils.removeFromArray(OBSERVED_VARIABLES,this)};BaseVariable.prototype.getObservedVariables=function(){return OBSERVED_VARIABLES};BaseVariable.prototype.valuesAreEqual=function(a,b){return a===b}})();(function(){function Expression(config){this._lockExprObject={};Expression.SUPER.apply(this,
arguments)}var Utils=qubit.opentag.Utils;var Timed=qubit.opentag.Timed;qubit.Define.clazz("qubit.opentag.pagevariable.Expression",Expression,qubit.opentag.pagevariable.BaseVariable);Expression.prototype.getValue=function(){var ret;var error;var value=this.value;try{if(value&&value.indexOf("[#]")===-1){var tmp=Utils.gevalAndReturn(value);ret=tmp.result;this.failMessage=null;error=tmp.error}else ret=Expression.parseUVArray(value)}catch(e){error=e}if(error){var msg="could not read value of expression: \n"+
value+"\nexact cause: "+error;if(this.failMessage!==msg)this.failMessage=msg;ret=null}var differs=this._updateCurrentValue(ret);return ret};Expression.parseUVArray=function(uv){var parts=uv.split("[#]");var array=Utils.gevalAndReturn(parts[0]).result;var collection=[];var pathOfElements=parts[1];if(pathOfElements.indexOf(".")===0)pathOfElements=pathOfElements.replace(".","");for(var i=0;i<array.length;i++){var element=Utils.getObjectUsingPath(pathOfElements,array[i]);collection.push(element)}return collection};
Expression.prototype.replaceToken=function(token,string,altValue,exp){if(this.getValue()instanceof Array)exp=true;return Expression.SUPER.prototype.replaceToken.call(this,token,string,altValue,exp)}})();(function(){function DOMText(config){DOMText.SUPER.apply(this,arguments)}var Utils=qubit.opentag.Utils;qubit.Define.clazz("qubit.opentag.pagevariable.DOMText",DOMText,qubit.opentag.pagevariable.BaseVariable);DOMText.prototype.getValue=function(){var val=Utils.getElementValue(this.value);this._updateCurrentValue(val);
return val}})();(function(){function Cookie(config){Cookie.SUPER.apply(this,arguments);this._lockObject={}}qubit.Define.clazz("qubit.opentag.pagevariable.Cookie",Cookie,qubit.opentag.pagevariable.BaseVariable);Cookie.prototype.getValue=function(){var val=qubit.Cookie.get(this.value);this._updateCurrentValue(val);return val}})();(function(){function URLQuery(config){URLQuery.SUPER.apply(this,arguments)}var Utils=qubit.opentag.Utils;qubit.Define.clazz("qubit.opentag.pagevariable.URLQuery",URLQuery,
qubit.opentag.pagevariable.BaseVariable);URLQuery.prototype.getValue=function(){var val=Utils.getQueryParam(this.value);this._updateCurrentValue(val);return val}})();(function(){function UniversalVariable(config){UniversalVariable.SUPER.apply(this,arguments)}qubit.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",UniversalVariable,qubit.opentag.pagevariable.Expression)})();(function exportUv(){function createUv(){function logLevel(level){log.level=level}function emit(type,event){log.info(type,
"event emitted");event=clone(event||{});event.meta=event.meta||{};event.meta.type=type;eventQueue.push(event);processNextEvent();uv.listeners=filter(uv.listeners,function(l){return!l.disposed})}function on(type,callback,context){function replay(){log.info("Replaying events");queueEmittedEvents(function(){forEach(uv.events,function(event){if(listener.disposed)return;if(!matches(type,event.meta.type))return;callback.call(context,event)})});return subscription}function dispose(){log.info("Disposing event handler");
listener.disposed=true;return subscription}log.info("Attaching event handler for",type);var listener={type:type,callback:callback,disposed:false,context:context||window};uv.listeners.push(listener);var subscription={replay:replay,dispose:dispose};return subscription}function queueEmittedEvents(fn){log.info("Calling event handlers");callingHandlers++;try{fn()}catch(e){log.error("UV API Error",e.stack)}callingHandlers--;processNextEvent()}function processNextEvent(){if(eventQueue.length===0)log.info("No more events to process");
if(eventQueue.length>0&&callingHandlers>0)log.info("Event will be processed later");if(eventQueue.length>0&&callingHandlers===0){log.info("Processing event");var event=eventQueue.shift();uv.events.push(event);queueEmittedEvents(function(){forEach(uv.listeners,function(listener){if(listener.disposed)return;if(!matches(listener.type,event.meta.type))return;try{listener.callback.call(listener.context,event)}catch(e){log.error("Error emitting UV event",e.stack)}})})}}function once(type,callback,context){var subscription=
uv.on(type,function(){callback.apply(context||window,arguments);subscription.dispose()});return subscription}function forEach(list,iterator){var length=list.length;for(var i=0;i<length;i++)iterator(list[i],i)}function clone(input){var output={};for(var key in input)if(input.hasOwnProperty(key))output[key]=input[key];return output}function matches(test,subject){return typeof test==="string"?test===subject:test.test(subject)}function filter(list,iterator){var l=list.length;var output=[];for(var i=0;i<
l;i++)if(iterator(list[i]))output.push(list[i]);return output}var eventQueue=[];var callingHandlers=0;var log={info:function logInfo(){if(log.level>logLevel.INFO)return;if(console&&console.info)console.info.apply(console,arguments)},error:function logError(){if(log.level>logLevel.ERROR)return;if(console&&console.error)console.error.apply(console,arguments)}};logLevel.ALL=0;logLevel.INFO=1;logLevel.ERROR=2;logLevel.OFF=3;logLevel(logLevel.ERROR);var uv={on:on,emit:emit,once:once,events:[],listeners:[],
logLevel:logLevel};return uv}if(typeof module==="object"&&module.exports)module.exports=createUv;else if(window&&window.uv===undefined)window.uv=createUv()})();var allEventsByType={};var unqueuedEvents=[];var inititated=false;var inititatedSuccessfully=false;var global$$0=qubit.Define.global();var PubSub={allEventsByType:allEventsByType,subscribe:function(eventName,callback){if(inititatedSuccessfully){var uv=getUV();uv.on(eventName,callback)}else unqueuedEvents.push({on:[eventName,callback]})},getEventHistory:function(name){return this.allEventsByType[name]},
publish:function(eventName,event){if(inititatedSuccessfully){var uv=getUV();uv.emit(eventName,event)}else unqueuedEvents.push({emit:[eventName,event]})},connect:function(){initiate()}};PubSub.connect();qubit.Define.namespace("qubit.qprotocol.PubSub",PubSub);(function(){function QProtocolVariable(config){QProtocolVariable.SUPER.apply(this,arguments)}var PubSub=qubit.qprotocol.PubSub;var Utils=qubit.opentag.Utils;var DELIMITER=":";qubit.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",QProtocolVariable,
qubit.opentag.pagevariable.BaseVariable);QProtocolVariable.prototype.init=function(){if(this.initialized)return false;else this.initialized=(new Date).valueOf();this.callHandlersOnRead=true;if(!this.handlerAttached){var _this=this;var result=this.getValueAndPath(this.value);this.eventName=result[0];this.objectPath=result[1];this.updateValue();PubSub.subscribe(this.eventName,function(event){_this.updateValue(event)});this.handlerAttached=(new Date).valueOf()}};QProtocolVariable.prototype.getValueAndPath=
function(value){var eventName=value;var opath;if(eventName){var idx=value.indexOf(DELIMITER);if(idx!==-1){eventName=value.substring(0,idx);opath=value.substring(idx+1)}}return[eventName,opath]};QProtocolVariable.prototype.getValue=function(){this.init();return this.currentValue};QProtocolVariable.prototype.getEventsHistory=function(){return PubSub.getEventHistory(this.eventName)};QProtocolVariable.prototype.updateValue=function(event){if(!event){var history=this.getEventsHistory();if(history)event=
history.current}var newValue;var opath=this.objectPath;if(event&&opath)newValue=Utils.getObjectUsingPath(opath,event);else newValue=event;this._updateCurrentValue(newValue);return newValue};QProtocolVariable.prototype.startObservingForChanges=function(){};QProtocolVariable.prototype.stopObservingForChanges=function(){}})();(function(){function TagHelper(){}function findParamatersForVariable(tag,varRef){var ret=[];try{var params=tag.parameters;if(params)for(var i=0;i<params.length;i++)if(tag.getVariableForParameter(params[i])===
varRef)ret.push(params[i])}catch(ex){}return ret}var Utils=qubit.opentag.Utils;var TagsUtils=qubit.opentag.TagsUtils;var Timed=qubit.opentag.Timed;var BaseVariable=qubit.opentag.pagevariable.BaseVariable;var Expression=qubit.opentag.pagevariable.Expression;var UniversalVariable=qubit.opentag.pagevariable.UniversalVariable;var DOMText=qubit.opentag.pagevariable.DOMText;var Cookie=qubit.opentag.pagevariable.Cookie;var URLQuery=qubit.opentag.pagevariable.URLQuery;qubit.Define.clazz("qubit.opentag.TagHelper",
TagHelper);TagHelper.injectHTMLForLoader=function(tag,callback,tryWrite,altHtml){var html=altHtml!==undefined?altHtml:tag.getHtml();if(html){var append=tag.config.locationPlaceHolder==="END";var location=TagsUtils.getHTMLLocationForTag(tag);tag.injectHTMLNotFinished=true;try{if(location)TagsUtils.injectHTML(location,append,html,function(){tag.injectHTMLNotFinished=false;if(callback)try{callback()}catch(e){}}.bind(tag));else if(tryWrite&&document.readyState==="loading"){document.write(html);tag.injectHTMLNotFinished=
false}else tag.injectHTMLFailed=(new Date).valueOf()}catch(ex){tag.injectHTMLNotFinished=false;tag.injectHTMLFailed=(new Date).valueOf()}}};TagHelper.getAllVariablesWithParameters=function(tag){var vars=tag.getPageVariables();var results=[];for(var i=0;i<vars.length;i++){var pageVar=vars[i];var parameters=findParamatersForVariable(tag,pageVar);for(var j=0;j<parameters.length;j++)results.push({parameter:parameters[j],variable:pageVar})}return results};var _lock_obj={};TagHelper.allParameterVariablesReadyForTag=
function(tag,tryDefaults){var useDefaults=tryDefaults;var allReady=true;var vars=tag.getPageVariables();for(var i=0;i<vars.length;i++){var pageVar=vars[i];try{var parameters=findParamatersForVariable(tag,pageVar);var exist=pageVar.exists();if(!exist&&useDefaults){if(parameters.length>0)exist=!!parameters[0].defaultValue;exist=exist||pageVar.exists(true)}if(!exist){allReady=false;break}}catch(ex){allReady=false;break}}return allReady};var JS_VALUE="2";var QUERY_PARAM="3";var COOKIE_VALUE="4";var ELEMENT_VALUE=
"5";TagHelper.validateAndGetVariableForParameter=function(param){if(param.hasOwnProperty("variable")&&param.variable)param.variable=TagHelper.initPageVariable(param.variable);return param.variable};TagHelper.initPageVariable=function(cfg){if(!cfg||cfg instanceof BaseVariable)return cfg;if(typeof cfg==="string"){var tmp=Utils.getObjectUsingPath(cfg);if(tmp&&tmp instanceof BaseVariable)return tmp}switch(cfg.type){case JS_VALUE:return new Expression(cfg);case QUERY_PARAM:return new URLQuery(cfg);case COOKIE_VALUE:return new Cookie(cfg);
case ELEMENT_VALUE:return new DOMText(cfg);case "EPRESSION":return new Expression(cfg);case "URL_PARAMETER":return new URLQuery(cfg);case "COOKIE_VALUE":return new Cookie(cfg);case "DOM_VALUE":return new DOMText(cfg);default:return new BaseVariable(cfg)}}})();(function(){function GenericLoader(config){this.log=new Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.urlsLoaded=0;this.urlsFailed=0;this.runCounter=0;this.events=new qubit.Events({});this._depLoadedHandler=
function(){if(this.dependenciesLoaded()&&this.awaitingDependencies)this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+nameCounter++,async:true,usesDocumentWrite:false,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:false,noMultipleLoad:false,loadDependenciesOnLoad:false,restartable:true};this.restartCounter=0;this.cancelled=false;this.runtimeId=Utils.UUID();this.delayDocWrite=false;
this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(config){if(!config.name){var n="Tag-"+nameCounter++;this.config.name=n}this.addState("INITIAL");for(var prop in config)this.config[prop]=config[prop];if(config.genericDependencies)this.genericDependencies=this.genericDependencies.concat(config.genericDependencies);if(config.dependencies)this.dependencies=config.dependencies.concat(this.dependencies);if(config.PACKAGE)this._package=config.PACKAGE;
this.onInit()}}function _waitForDependencies(){if(this.cancelled){this._handleCancel();return}this.waitForDependenciesFinished=(new Date).valueOf();var fullBodyNeededAndUnLoaded=this._fullBodyNeededAndUnLoaded();var interactiveBodyNeededButNotReady=this._bodyNeededButNotAvailable();if(fullBodyNeededAndUnLoaded||interactiveBodyNeededButNotReady)this.waitForDependenciesFinished=false;else{if(!this.timeoutCountdownStart)this.timeoutCountdownStart=(new Date).valueOf();if(this.allDependenciesLoaded())this._markLoadedSuccesfuly();
else if(this._loadingOutOfTimeFrames()){this.loadingTimedOut=(new Date).valueOf();if(this.allDependenciesLoaded(true))this._markLoadedSuccesfuly();else{this.addState("TIMED_OUT");this._markLoadingDependenciesFailed();this._triggerOnLoadTimeout()}}else this.waitForDependenciesFinished=false}if(!this.waitForDependenciesFinished)this._setTimeout(_waitForDependencies.bind(this),65);else this.addState("LOADED_DEPENDENCIES")}var Utils=qubit.opentag.Utils;var TagsUtils=qubit.opentag.TagsUtils;var Timed=
qubit.opentag.Timed;var TagHelper=qubit.opentag.TagHelper;var nameCounter=0;var Log=qubit.opentag.Log;qubit.Define.clazz("qubit.opentag.GenericLoader",GenericLoader);var AFTER_EVENT="after";var BEFORE_EVENT="before";var RESTART_EVENT="restart";GenericLoader.prototype.EVENT_TYPES={AFTER_EVENT:AFTER_EVENT,BEFORE_EVENT:BEFORE_EVENT,RESTART_EVENT:RESTART_EVENT};GenericLoader.prototype.onInit=EMPTY_FUN;GenericLoader.prototype.LOADING_TIMEOUT=5*1E3;GenericLoader.prototype.getHtml=function(){if(this.config.html)return this.config.html;
if(this.htmlContent)return Utils.trim(this.htmlContent);return null};GenericLoader.prototype._executeScript=function(){var success=false;try{this.script();success=true}catch(ex){this.addState("EXECUTED_WITH_ERRORS");this.executedWithErrors=(new Date).valueOf();this._onError(ex)}finally{this._onExecute(success)}};GenericLoader.prototype.getTimeout=function(){return this._getTimeout()};GenericLoader.prototype._getTimeout=function(chain){var tout=+this.config.timeout;var deps=this.dependencies;if(tout!==
-1&&deps.length>0){var max=0;chain=chain||[];var present=Utils.indexInArray(chain,this)!==-1;if(!present){chain[chain.length]=this;for(var i=0;i<deps.length;i++){var val=deps[i]._getTimeout(chain);if(val>max)max=val}if(max>0)tout+=max}else return 0}return tout};GenericLoader.prototype._onExecute=function(noErrors){this.onExecute(noErrors)};GenericLoader.prototype.onExecute=EMPTY_FUN;GenericLoader.prototype._flushDocWrites=function(cb){var ret=true;this._docWriteNotFlushed=false;try{var loc=TagsUtils.getHTMLLocationForTag(this);
if(loc&&this._securedWrites&&this._securedWrites.length>0){var append=this.config.locationPlaceHolder==="END";ret=TagsUtils.flushDocWritesArray(this._securedWrites,loc,append,this.log,cb);if(ret)this._docWriteFlushed=(new Date).valueOf();else this._docWriteNotFlushed=(new Date).valueOf()}}catch(ex){this._onError(ex)}if(cb)cb();if(this._securedWrites&&this._securedWrites.length>0){ret=false;this._docWriteNotFlushed=(new Date).valueOf()}return ret};GenericLoader.prototype.log=EMPTY_FUN;GenericLoader.prototype.finished=
function(){return!!this.runIsFinished};GenericLoader.prototype.script=function(){};GenericLoader.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call(BEFORE_EVENT,this)}catch(ex){this._onError(ex)}};GenericLoader.prototype.onBefore=function(callback){this.events.on(BEFORE_EVENT,callback)};GenericLoader.prototype.after=function(success){this.afterRun=(new Date).valueOf();try{this.events.call(AFTER_EVENT,{success:success,tag:this})}catch(ex){this._onError(ex)}};GenericLoader.prototype.onAfter=
function(callback){this.events.on(AFTER_EVENT,callback)};GenericLoader.prototype.runOnce=function(){if(!this._runOnceTriggered&&!this.scriptExecuted){this._runOnceTriggered=(new Date).valueOf();this.run()}};GenericLoader.CANCEL_ALL=false;GenericLoader.prototype.run=function(){if(!isNaN(this.config.runningLimit))if(this.config.runningLimit<=this.runCounter)return false;if(this.cancelled||GenericLoader.CANCEL_ALL){this._handleCancel();return false}if(this.isRunning)return false;if(this.lastRun)this.reset();
this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;if(!this._ignoreDeps&&!this.dependenciesLoaded()){this._attachDepsEventsToContinue();return false}return this._triggerLoadingAndExecution()};GenericLoader.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();if(this._ignoreDeps)this.execute();else this.waitForDependenciesAndExecute();return true};GenericLoader.prototype._attachDepsEventsToContinue=
function(){this.awaitingDependencies=(new Date).valueOf();var deps=this.dependencies;for(var i=0;i<deps.length;i++)try{deps[i].events.on("success",this._depLoadedHandler)}catch(ex){}};GenericLoader.prototype.dependenciesLoaded=function(){var deps=this.dependencies;for(var i=0;i<deps.length;i++)if(deps[i]!==this){var executed=+deps[i].scriptExecuted>0;if(!executed)return false}return true};GenericLoader.prototype._setTimeout=function(cb,time){this._wasTimed=(new Date).valueOf();var _runtimeId=this.runtimeId;
var cbWrapped=function(){if(this.runtimeId===_runtimeId)return cb()}.bind(this);return Timed.setTimeout(cbWrapped,time)};GenericLoader.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(ex){this._onError(ex)}};GenericLoader.prototype.waitForDependenciesAndExecute=function(){if(this.loadedDependencies)this.execute();else if(this.loadingDependenciesFailed){this._markFailure();this._markFinished()}else this._setTimeout(this.waitForDependenciesAndExecute.bind(this),
30)};GenericLoader.prototype.execute=function(){this._triggerExecution()};GenericLoader.prototype._triggerExecution=function(){if(this.cancelled){this._handleCancel();return}if(this.scriptExecuted)return;var finished=true;if(this.shouldWaitForDocWriteProtection())finished=false;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();var cancel=false;try{cancel=this.before()}catch(ex){this._onError(ex)}if(cancel){this._markFailure();this._markFinished();return}}finished=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(this.scriptExecuted)return;
if(this.unexpectedFail)finished=true;if(!finished)this._setTimeout(this._triggerExecution.bind(this),30);else{this._flushDocWrites();if(this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail)this._markFailure();else{this.scriptExecuted=(new Date).valueOf();this.addState("EXECUTED");this._executeScript()}if(this.cancelled){this._handleCancel();return false}else{var successful=this.scriptExecuted>0;try{if(!this.afterRun){this.afterRun=(new Date).valueOf();this.after(successful)}}catch(ex){this.executedWithErrors=
(new Date).valueOf()}if(!this.executedWithErrors)if(successful)this.events.call("success")}this._flushDocWrites();this._markFinished()}};GenericLoader.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};GenericLoader.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=false;if(GenericLoader.LOCK_DOC_WRITE===this){this._flushDocWrites();TagsUtils.unlockDocumentWrites();GenericLoader.LOCK_DOC_WRITE=false}this.onFinished(true)};
GenericLoader.prototype.onFinished=EMPTY_FUN;GenericLoader.prototype.onCancel=EMPTY_FUN;GenericLoader.prototype.onFinished=EMPTY_FUN;GenericLoader.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!GenericLoader.LOCK_DOC_WRITE){GenericLoader.LOCK_DOC_WRITE=this;this._secureWriteAndCollectForExecution()}else if(GenericLoader.LOCK_DOC_WRITE!==this){if(!this._lockedDocWriteInformed)this._lockedDocWriteInformed=(new Date).valueOf();return true}return false};GenericLoader.prototype.runWithoutDependencies=
function(){this.ignoreDependencies=true;this.run()};GenericLoader.prototype.loadExecutionURLsAndHTML=function(callback){if(this.cancelled){this._handleCancel();return true}if(!this._loadExecutionURLsAndHTMLInformed)this._loadExecutionURLsAndHTMLInformed=true;this._triggerURLsLoading(callback);if(!this.loadURLsNotFinished){this._flushDocWrites();this._triggerHTMLInjection();this._flushDocWrites();if(!this.injectHTMLNotFinished){this._flushDocWrites();if(!this._docWriteNotFlushed){if(this._docWriteFlushed);
return true}}}return false};GenericLoader.prototype._triggerURLsLoading=function(callback){if(!this._urlLoadTriggered&&this.config.url){this._urlLoadTriggered=true;this.loadURLs(false,callback)}};GenericLoader.prototype._triggerHTMLInjection=function(){if(!this._injectHTMLTriggered&&this.getHtml()){this._injectHTMLTriggered=true;this.injectHTML()}};GenericLoader.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,
FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:2048*2};GenericLoader.prototype.addState=function(stateName){if(this.STATE.hasOwnProperty(stateName)){this.state=this.state|this.STATE[stateName];try{this.onStateChange(stateName)}catch(ex){this._onError(ex)}}};GenericLoader.prototype.onStateChange=EMPTY_FUN;GenericLoader.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};GenericLoader.prototype.unCancel=function(){this.cancelled=
false};GenericLoader.prototype.state=GenericLoader.prototype.STATE.INITIAL;GenericLoader.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};GenericLoader.prototype._secureWriteAndCollectForExecution=function(){if(!this._securedWrites){this._securedWrites=[];TagsUtils.redirectDocumentWritesToArray(this._securedWrites,this.log)}};GenericLoader.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");
this.loadingDependenciesFailed=(new Date).valueOf()};GenericLoader.prototype.allDependenciesLoaded=function(tryDefaults,arrayToAdd){return this.getDependenciesToBeLoaded(tryDefaults,arrayToAdd).length===0};GenericLoader.prototype.getDependenciesToBeLoaded=function(tryDefaults,arrayToAdd){var failures=arrayToAdd||[];if(!this.injectionLocationReady())failures.push("injection location");var i;var deps=this.dependencies;for(i=0;i<deps.length;i++)if(deps[i]!==this){var executed=+deps[i].scriptExecuted>
0;if(!executed){var name=deps[i].config?deps[i].config.name:"anonymous";failures.push("dependant Tag with name -\x3e "+name)}}for(i=0;i<this.genericDependencies.length;i++){var ready=this.genericDependencies[i](this);if(!ready)failures.push("this.genericDependencies["+i+"] (index: "+i+")")}if(failures!=="");return failures};GenericLoader.prototype.docWriteAsksToWaitForBody=function(){return!!(this.delayDocWrite&&this.config.usesDocumentWrite)};GenericLoader.prototype._bodyNeededButNotAvailable=function(){if(this._dontWaitForInjections())return false;
return this._isBodyLocationNeeded()&&!TagsUtils.bodyAvailable()};GenericLoader.prototype._isBodyLocationNeeded=function(){if(!this.isLoadingAsynchronously())return false;if(this._isBodyLocationSet())return true;else{var atHead=this.config.locationObject==="HEAD";return atHead&&this.config.locationPlaceHolder==="END"}};GenericLoader.prototype._isBodyLocationSet=function(){var locObj=this.config.locationObject;return!locObj||locObj==="BODY"};GenericLoader.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return false;
var needed=false;if(this._isBodyLocationNeeded())needed=this.config.locationPlaceHolder==="END";needed=needed||(this.fullbodyNeeded||this.docWriteAsksToWaitForBody());return needed&&!Utils.bodyReady()};GenericLoader.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||GenericLoader.dontWaitForInjectionLocation};GenericLoader.prototype.injectionLocationReady=function(){if(this._dontWaitForInjections())return true;if(this._fullBodyNeededAndUnLoaded())return false;
if(!this.isLoadingAsynchronously())return true;return!!TagsUtils.getHTMLLocationForTag(this)};GenericLoader.prototype._loadingOutOfTimeFrames=function(){if(this.getTimeout()<0)return false;return(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};GenericLoader.prototype.loadDependencies=function(){this._loadDependencies()};GenericLoader.prototype.addClientDependenciesList=function(array,ns){return this.addDependenciesList(array,qubit.Define.clientSpaceClasspath())};GenericLoader.prototype.addDependenciesList=
function(array,ns){if(!array||array.length===0)return;if(!this.failedDependenciesToParse)this.failedDependenciesToParse=[];var dependencies=this.dependencies;for(var i=0;i<array.length;i++){var item=array[i];var bad=false;if(item instanceof GenericLoader)dependencies.push(item);else if(typeof item==="string"){var original=item;if(ns)item=ns+"."+item;var obj=Utils.getObjectUsingPath(item);if(obj)if(obj instanceof GenericLoader)dependencies.push(obj);else bad=true;else this.failedDependenciesToParse.push(original)}else bad=
true;if(bad){this.badDepsObjects=this.badDepsObjects||[];Utils.addToArrayIfNotExist(this.badDepsObjects,item)}}};GenericLoader.prototype._loadDependencies=function(chain){chain=chain||[];var deps=this.dependencies;var present=Utils.indexInArray(chain,this)!==-1;if(!present){chain[chain.length]=this;for(var i=0;i<deps.length;i++)deps[i].load(chain)}};GenericLoader.prototype.onError=EMPTY_FUN;GenericLoader.prototype._onError=function(msg){try{this.onError(msg)}catch(ex){}};GenericLoader.prototype._triggerOnLoadTimeout=
function(){this.onLoadTimeout()};GenericLoader.prototype.onLoadTimeout=EMPTY_FUN;GenericLoader.prototype.onScriptsLoadSuccess=EMPTY_FUN;GenericLoader.prototype.onScriptLoadError=EMPTY_FUN;GenericLoader.prototype.onAllDependenciesLoaded=EMPTY_FUN;GenericLoader.prototype.onBeforeLoad=null;GenericLoader.prototype.load=function(){if(this.loadStarted)return;else{this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(ex){this._onError(ex)}}this.addState("LOADING_DEPENDENCIES");
try{if(!this._ignoreDeps&&this.config.loadDependenciesOnLoad)this.loadDependencies()}catch(ex){throw ex;}_waitForDependencies.call(this)};GenericLoader.prototype._singleUrlLoadHandler=function(success,urls,callback){++this.urlsLoaded;if(!success)++this.urlsFailed;if(this.urlsLoaded===urls.length){this.loadURLsNotFinished=false;if(success&&this.urlsFailed===0){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{if(callback)callback(true)}catch(ex){this._onError(ex)}finally{this.onScriptsLoadSuccess()}}else{var message=
"error loading urls. Failed "+this.urlsFailed;this._onError(message);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=true;if(callback)callback(false)}catch(ex){this._onError(ex)}finally{this.onScriptLoadError(message)}}}};GenericLoader.prototype.loadURLs=function(urlz,callback){var urls=urlz||this.config.url;this.addState("LOADING_URL");try{if(urls&&!(urls instanceof Array))urls=[urls];for(var i=0;i<urls.length;i++){this.loadURLsNotFinished=true;
var url=urls[i];url=this.prepareURL(url);this.loadURL(url,function(success){this._singleUrlLoadHandler(success,urls,callback)}.bind(this))}}catch(ex){this.loadURLsNotFinished=false;this.addState("UNEXPECTED_FAIL");this.unexpectedFail=(new Date).valueOf();this._onError(ex)}};GenericLoader.prototype.prepareLocationObject=function(loc){return loc};GenericLoader.prototype.prepareURL=function(url){return url};GenericLoader.prototype.prepareHTML=function(html){return html};GenericLoader.prototype.loadURL=
function(url,callback,location){var passedUrl=url;this.addState("LOADING_URL");TagsUtils.loadScript({onsuccess:function(){try{if(callback)callback(true)}catch(ex){}}.bind(this),onerror:function(){try{if(callback)callback(false)}catch(ex){}}.bind(this),url:passedUrl,node:location||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};GenericLoader.prototype.onRestart=function(callback){this.events.on(RESTART_EVENT,callback)};GenericLoader.prototype.prepareForRestart=
function(){if(this.config.restartable){var tmp=this.restartCounter+1;this.events.call(RESTART_EVENT,this);this.reset();this.restartCounter=tmp}};GenericLoader.prototype.restart=function(){if(this.config.restartable){this.prepareForRestart();this.run()}};GenericLoader.prototype.reset=function(){var u;this._injectHTMLTriggered=u;this._loadExecutionURLsAndHTMLInformed=u;this._lockedDocWriteInformed=u;this._runOnceTriggered=u;this._urlLoadTriggered=u;this.afterRun=u;this.beforeRun=u;this.filtersRunTriggered=
u;this.injectHTMLFailed=u;this.loadStarted=u;this.loadURLsNotFinished=u;this.loadedDependencies=u;this.loadingDependenciesFailed=u;this.loadingTimedOut=u;this.runIsFinished=u;this.scriptExecuted=u;this.scriptLoadingFailed=u;this.delayDocWrite=u;this._securedWrites=u;this.state=0;this.unexpectedFail=u;this.urlsFailed=0;this.urlsLoaded=0;this.waitForDependenciesFinished=u;this.isRunning=u;this.lastRun=u;this.cancelled=u;this._beforeEntered=u;this.awaitingDependencies=u;this.timeoutCountdownStart=u;
this.restartCounter=0;this.runtimeId=Utils.UUID();this.addState("INITIAL")};GenericLoader.prototype.isLoadingAsynchronously=function(){if(this._wasTimed)return true;return!!(this.config.async||this.forceAsynchronous)};GenericLoader.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};GenericLoader.prototype.injectHTML=function(callback){var tryWriteIfNoLocation=!this.docWriteAsksToWaitForBody();var html=this.prepareHTML(this.getHtml());
if(html)TagHelper.injectHTMLForLoader(this,callback,tryWriteIfNoLocation,html)};GenericLoader.prototype.clone=function(){var clone=new GenericLoader(this.config);return clone}})();(function(){function BaseTag(config){var defaults={filterTimeout:config&&config.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:config&&config.PACKAGE,dedupe:false,needsConsent:false,inactive:false,variables:null,runner:null,disabled:false,locked:false,reRunOnVariableChange:false};Utils.setIfUnset(config,defaults);BaseTag.SUPER.apply(this,
arguments);this.namedVariables={};this._runtimeMarkers={};this.parameters=[];this.filters=[];this.session=null;this.owningContainers=[];this.pingSent=false;this.oldPingSent=false;this.dedupePingSent=false;this.oldDedupePingSent=false;this.reRunCounter=0;if(config){this.addState("INITIAL");try{BaseTag.register(this)}catch(ex){}this.setupConfig(config);this.uniqueRefString=null;if(config.init)try{config.init.call(this,config)}catch(ex){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}
function _getSetNamedVariable(tag,token){var namedVariables=tag.namedVariables;var variable=TagHelper.initPageVariable(namedVariables[token]);namedVariables[token]=variable;return variable}var Utils=qubit.opentag.Utils;var TagsUtils=qubit.opentag.TagsUtils;var Timed=qubit.opentag.Timed;var BaseFilter=qubit.opentag.filter.BaseFilter;var GenericLoader=qubit.opentag.GenericLoader;var TagHelper=qubit.opentag.TagHelper;var BaseVariable=qubit.opentag.pagevariable.BaseVariable;var Cookie=qubit.Cookie;var Define=
qubit.Define;Define.clazz("qubit.opentag.BaseTag",BaseTag,GenericLoader);BaseTag.prototype.setupConfig=function(config){if(!config)return;if(config.filters)this.addFilters(config.filters);if(config.parameters)this.addParameters(config.parameters);if(config.variables)for(var prop in config.variables)if(config.variables.hasOwnProperty(prop)){var param=this.getParameterByTokenName(prop);if(param){var variable=config.variables[prop];param.variable=variable;if(variable.defaultValue!==undefined)param.defaultValue=
variable.defaultValue;if(variable.uv!==undefined)param.uv=variable.uv}}if(config.locked)this.lock()};BaseTag.prototype.valueForToken=function(token,defaults){var param=this.getParameterByTokenName(token);if(param){if(defaults===undefined)if(this.loadingTimedOut)defaults=true;return this.getParameterValue(param,defaults)}var namedVariables=this.namedVariables;if(namedVariables&&namedVariables[token]){var variable=_getSetNamedVariable(this,token);if(variable)return variable.getRelativeValue(defaults)}return undefined};
BaseTag.prototype.addParameters=function(parameters){this.parameters=this.parameters.concat(parameters)};BaseTag.prototype.LOADING_TIMEOUT=5*1E3;BaseTag.prototype.FILTER_WAIT_TIMEOUT=-1;BaseTag.prototype._isVariable=function(variable){return variable!==null&&variable!==undefined};BaseTag.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var params=this.parameters;if(params)for(var i=0;i<params.length;i++){var variable=this.getVariableForParameter(params[i]);
if(!this._isVariable(variable)){this._markLoadingDependenciesFailed();this._markFinished();return}}if(this.config.runner){var ret=false;try{this.addState("AWAITING_CALLBACK");ret=this._runner=(new Date).valueOf();this.config.runner.call(this)}catch(e){}return ret}else{this._runner=false;return this.start()}};BaseTag.prototype.lock=function(){this.locked=true;this._unlock=null};BaseTag.prototype.unlock=function(){this.locked=false;if(this._unlock){this._unlock();this._unlock=false}};BaseTag.prototype.start=
function(){if(!this.locked)return BaseTag.SUPER.prototype.run.call(this);else{this._unlock=function(){return BaseTag.SUPER.prototype.run.call(this)}.bind(this);return false}};BaseTag.prototype.startOnce=function(){if(!this.locked)return BaseTag.SUPER.prototype.runOnce.call(this);else{this._unlock=function(){return BaseTag.SUPER.prototype.runOnce.call(this)}.bind(this);return false}};BaseTag.prototype.getFilters=function(){return this.filters};BaseTag.prototype.runOnceIfFiltersPass=function(){if(!this._runOnceIfFiltersPassTriggered&&
!this.scriptExecuted){this._runOnceIfFiltersPassTriggered=(new Date).valueOf();this.runIfFiltersPass()}};BaseTag.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var state=this.filtersState(true);this.addState("FILTER_ACTIVE");if(!this.filtersRunTriggered)this.filtersRunTriggered=(new Date).valueOf();if(state===BaseFilter.state.SESSION){this.addState("AWAITING_CALLBACK");this.awaitingCallback=(new Date).valueOf()}else if(state===BaseFilter.state.PASS){this.filtersPassed=
(new Date).valueOf();try{this.onFiltersPassed()}catch(ex){}this.run()}else if(state===BaseFilter.state.FAIL){this._markFiltersFailed();this._markFinished()}else if(state>0){var tout=this.config.filterTimeout;if(tout<0||(new Date).valueOf()-this.filtersRunTriggered>tout){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(ex){}}this._setTimeout(this.runIfFiltersPass.bind(this),state)}else{this._markFiltersFailed();this._markFinished();
this.filtersRunTimedOut=(new Date).valueOf()}}try{this.onFiltersCheck(state)}catch(e){}return state};BaseTag.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};BaseTag.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,
TIMED_OUT:4096*2,UNEXPECTED_FAIL:4096*2*2,CANCELLED:4096*2*2*2};BaseTag.prototype.addState=function(stateName){BaseTag.SUPER.prototype.addState.call(this,stateName);try{BaseTag.onStateChange(this)}catch(ex){}this.stateStack=[];var s=this.STATE;var current=this.state;var stack=this.stateStack;if(current&s.INITIAL)stack.push("Initial state.");if(current&s.FILTER_ACTIVE)stack.push("Tag running with filters pass triggered.");if(current&s.FILTERS_FAILED)stack.push("Filters failed to pass.");if(current&
s.AWAITING_CALLBACK)stack.push("Awaiting callback to run this tag. Not pooling.");if(current&s.STARTED)stack.push("Tag is initialised and loading has been started.");if(current&s.LOADING_DEPENDENCIES)stack.push("Dependencies are being loaded.");if(current&s.LOADED_DEPENDENCIES)stack.push("Dependencies loading process has been finished.");if(current&s.LOADING_URL)stack.push("External URL is being loaded.");if(current&s.LOADED_URL)stack.push("External URL has been loaded.");if(current&s.EXECUTED)stack.push("Main script has been executed.");
if(current&s.EXECUTED_WITH_ERRORS)stack.push("Main script has been executed but errors occured.");if(current&s.FAILED_TO_LOAD_DEPENDENCIES)stack.push("Dependencies has failed to load.");if(current&s.FAILED_TO_LOAD_URL)stack.push("URL location failed to load.");if(current&s.FAILED_TO_EXECUTE)stack.push("Script failed to execute.");if(current&s.TIMED_OUT)stack.push("Script timed out awaiting for dependencies.");if(current&s.UNEXPECTED_FAIL)stack.push("Script occured UNEXPECTED exception and is failed.");
if(current&s.CANCELLED)stack.push("Tag has been cancelled.")};BaseTag.prototype.onTagInit=EMPTY_FUN;BaseTag.prototype.postInitialisationSection=EMPTY_FUN;BaseTag.onStateChange=EMPTY_FUN;BaseTag.prototype.onFiltersDelayed=EMPTY_FUN;BaseTag.prototype.onFiltersPassed=EMPTY_FUN;BaseTag.prototype.onFiltersCheck=EMPTY_FUN;BaseTag.prototype.state=BaseTag.prototype.STATE.INITIAL;BaseTag.prototype.arePageVariablesLoaded=function(tryDefaults){return TagHelper.allParameterVariablesReadyForTag(this,tryDefaults)};
BaseTag.prototype.getDependenciesToBeLoaded=function(tryDefaults,arrayToAdd){var failures=arrayToAdd||[];if(!this.arePageVariablesLoaded(tryDefaults))failures.push("page variables");return BaseTag.SUPER.prototype.getDependenciesToBeLoaded.call(this,tryDefaults,failures)};BaseTag.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};BaseTag.prototype.resolveDependencies=function(){var map=this.failedDependenciesToParse;if(map){this.failedDependenciesToParse=
null;this.addDependenciesList(map,Define.clientSpaceClasspath())}return this.dependencies};BaseTag.prototype.addClientVariablesMap=function(map){this.unresolvedClientVariablesMap=this._addVariablesMap(map,Define.clientSpaceClasspath());return this.unresolvedClientVariablesMap};BaseTag.prototype.resolvePageVariables=function(){var map=this.unresolvedClientVariablesMap;if(map){this.unresolvedClientVariablesMap=null;this.addClientVariablesMap(map)}map=this.unresolvedVariablesMap;if(map){this.unresolvedVariablesMap=
null;this.addVariablesMap(map)}return this.getPageVariables()};BaseTag.prototype.addVariablesMap=function(map){this.unresolvedVariablesMap=this._addVariablesMap(map);return this.unresolvedVariablesMap};BaseTag.prototype._addVariablesMap=function(map,ns){if(!map)return;var unresolvedVariablesMap={};var namedVariables=this.namedVariables;for(var prop in map)if(map.hasOwnProperty(prop)){var item=map[prop];if(item instanceof BaseVariable)namedVariables[prop]=item;else if(typeof item==="string"){var original=
item;if(ns)item=ns+"."+item;var obj=Utils.getObjectUsingPath(item);if(obj)if(obj instanceof BaseVariable)namedVariables[prop]=obj;else namedVariables[prop]=item;else unresolvedVariablesMap[prop]=original}else;}return unresolvedVariablesMap};BaseTag.prototype.prepareURL=function(url){return this.replaceTokensWithValues(url)};BaseTag.prototype.prepareLocationObject=function(loc){return this.replaceTokensWithValues(loc)};BaseTag.prototype.prepareHTML=function(html){if(html)html=this.replaceTokensWithValues(html);
return html};BaseTag.prototype._executeScript=function(){if(this.config&&this.config.script)if(typeof this.config.script==="function")this.script=this.config.script;else{var expr=this.replaceTokensWithValues(String(this.config.script));this.script=Utils.expressionToFunction(expr).bind(this)}BaseTag.SUPER.prototype._executeScript.call(this)};BaseTag.prototype.replaceTokensWithValues=function(string){if(!string||string.indexOf("${")===-1)return string;var params=this.parameters;if(params)for(var i=
0;i<params.length;i++){var parameter=params[i];var variable=this.getVariableForParameter(parameter);if(variable){var token=params[i].token;var value=this.valueForToken(token);string=variable.replaceToken(token,string,value)}}return string};BaseTag.prototype.getParameter=function(name){var params=this.parameters;var ret=null;if(params)for(var i=0;i<params.length;i++)if(params[i].name===name)ret=params[i];return ret};BaseTag.prototype.setParameterValueByTokenName=function(tokenName,variable){var param=
this.getParameterByTokenName(tokenName);if(param!==null){param.variable={value:variable};return true}return false};BaseTag.prototype.getParameterValue=function(parameterOrName,defaults){var param=typeof parameterOrName==="string"?this.getParameter(parameterOrName):parameterOrName;if(param){var variable=this.getVariableForParameter(param);if(variable)try{var value;if(defaults&&param.defaultValue!=="")value=Utils.gevalAndReturn(param.defaultValue).result;value=variable.getRelativeValue(defaults,value);
return value}catch(ex){return undefined}}return undefined};BaseTag.prototype.filtersState=function(runLastSessionFIlterIfPresent){var run=runLastSessionFIlterIfPresent;return TagsUtils.filtersState(this.filters,this.session,this,run)};BaseTag.prototype.addFilter=function(filter){Utils.addToArrayIfNotExist(this.filters,filter)};BaseTag.prototype.addFilters=function(filters){for(var i=0;i<filters.length;i++)this.addFilter(filters[i])};BaseTag.prototype.addClientFiltersList=function(filters){this.unresolvedClientFilterClasspaths=
this.addFiltersList(filters,Define.clientSpaceClasspath());return this.unresolvedClientFilterClasspaths};BaseTag.prototype.resolveFilters=function(){var list=this.unresolvedClientFilterClasspaths;if(list){this.unresolvedClientFilterClasspaths=null;this.addClientFiltersList(list)}return this.filters};BaseTag.prototype.addFiltersList=function(filters,ns){var unresolved=[];for(var i=0;i<filters.length;i++)try{var filter=filters[i];var tmp=filter;var cp=null;if(typeof filter==="string"){cp=filter;if(ns)filter=
ns+"."+filter;filter=Utils.getObjectUsingPath(filter)}if(typeof filter==="function"){var FilterClass=filter;filter=new FilterClass}if(!filter);if(!filter instanceof BaseFilter)filter=null;if(filter)this.addFilter(filter);else if(cp)Utils.addToArrayIfNotExist(unresolved,cp)}catch(ex){this.failedFilters=this.failedFilters||[];this.failedFilters.push(filters[i])}return unresolved};BaseTag.prototype.reset=function(){BaseTag.SUPER.prototype.reset.call(this);var u;this.filtersPassed=u;this.dedupePingSent=
false;this.oldDedupePingSent=false;this.pingSent=false;this.oldPingSent=false;this._runOnceIfFiltersPassTriggered=u;this.filtersRunTriggered=u;this._runner=u;this.reRunCounter=0;this.detachVariablesChangedListeners()};BaseTag.prototype.resetFilters=function(){for(var i=0;i<this.filters.length;i++)this.filters[i].reset()};BaseTag.prototype.getParameterByTokenName=function(name){var ret=null;if(this.parameters){var params=this.parameters;for(var i=0;i<params.length;i++)if(params[i].token===name)ret=
params[i]}return ret};BaseTag.prototype.removeFilter=function(filter){Utils.removeFromArray(this.filters,filter)};var _counter_tag_map=0;var tags=[];var tagAccessorsMap={};var UNIQUE_REF={};BaseTag.register=function(tag){var index=Utils.addToArrayIfNotExist(tags,tag);if(index===-1)tag._tagIndex=tags.length-1;else tag._tagIndex=index;if(tag.config.id){var str="Q"+tag.config.id;UNIQUE_REF[str]=tag;tag.uniqueId=str}else UNIQUE_REF[tag.CLASSPATH]=tag};BaseTag.getById=function(id){return UNIQUE_REF[String(id)]};
BaseTag.prototype.getById=BaseTag.getById;BaseTag.prototype.unregister=function(ref){BaseTag.unregister(ref||this)};BaseTag.prototype.destroy=function(){this.destroyed=true;this.cancel();BaseTag.unregister(this)};BaseTag.unregister=function(tag){var index=Utils.removeFromArray(tags,tag);tag._tagIndex=-1};BaseTag.getTags=function(){return tags};BaseTag.getAccessorsMap=function(){return tagAccessorsMap};BaseTag.prototype.getTags=function(){return tags};BaseTag.prototype.getPageVariables=function(){var params=
this.parameters;var vars=[];if(params)for(var i=0;i<params.length;i++){var v=this.getVariableForParameter(params[i]);if(this._isVariable(v))Utils.addToArrayIfNotExist(vars,v)}if(this.namedVariables)for(var key in this.namedVariables)Utils.addToArrayIfNotExist(vars,_getSetNamedVariable(this,key));return vars};BaseTag.prototype.getAccessorString=function(){if(!this._accessorsMapKey){this._accessorsMapKey="_"+_counter_tag_map++;tagAccessorsMap[this._accessorsMapKey]=this}return"qubit.opentag.BaseTag.getAccessorsMap()."+
this._accessorsMapKey};BaseTag.prototype.getVariableForParameter=function(param){var variable;var namedVariables=this.namedVariables;if(namedVariables&&namedVariables[param.token])variable=_getSetNamedVariable(this,param.token);if(!variable)variable=TagHelper.validateAndGetVariableForParameter(param);return variable};BaseTag.prototype.printVariablesState=function(){var res=[];var pairs=TagHelper.getAllVariablesWithParameters(this);for(var i=0;i<pairs.length;i++){var param=pairs[i].parameter;var variable=
pairs[i].variable;var val;if(param&&param.token)val=this.valueForToken(param.token);else val=variable.getRelativeValue(true);var tmp={name:variable.config.name,exists:variable.exists(),token:param?param.token:null,value:val,variable:variable};res.push(tmp)}return res};BaseTag.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};BaseTag.prototype.getId=function(){return this._getUniqueId()};BaseTag.prototype._getUniqueId=function(){if(this.config.id)return this.config.id;if(String(this.CLASSPATH).indexOf(Define.STANDARD_CS_NS)===
0)return this.CLASSPATH.substring(Define.STANDARD_CS_NS.length+1);else return this.CLASSPATH+"#"+this.config.name};var forceCookiePrefix="qubit.tag.forceRunning_";var disableCookiePrefix="qubit.tag.disableRunning_";var cookieRunAll="qubit.tag.forceAllToRun";BaseTag.prototype.cookieSaysToRunEvenIfDisabled=function(){var id=this._getUniqueId();var ret=!!Cookie.get(cookieRunAll);if(!ret)ret=!!Cookie.get(forceCookiePrefix+id);return ret};BaseTag.prototype.setCookieForcingTagToRun=function(){var id=this._getUniqueId();
Cookie.set(forceCookiePrefix+id,"true")};BaseTag.setCookieForcingTagsToRun=function(){Cookie.set(cookieRunAll,"true")};BaseTag.prototype.setCookieToDisable=function(){var id=this._getUniqueId();Cookie.set(disableCookiePrefix+id,"true")};BaseTag.prototype.rmCookieToDisable=function(){var id=this._getUniqueId();Cookie.rm(disableCookiePrefix+id)};BaseTag.prototype.disabledByCookie=function(){var id=this._getUniqueId();return!!Cookie.get(disableCookiePrefix+id)};BaseTag.rmCookieForcingTagsToRun=function(){Cookie.rm(cookieRunAll)};
BaseTag.prototype.rmCookieForcingTagToRun=function(){var id=this._getUniqueId();Cookie.rm(forceCookiePrefix+id)};BaseTag.rmAllDisablingCookies=function(){Utils.rmCookiesMatching(disableCookiePrefix)};BaseTag.rmAllCookiesForcingTagToRun=function(){Utils.rmCookiesMatching(forceCookiePrefix);BaseTag.rmCookieForcingTagsToRun()};BaseTag.prototype.onVariableChanged=function(callback){this.attachVariablesChangedListeners(true);this.events.on("variableChanged",callback)};BaseTag.prototype._handleVariableChange=
function(event){this.events.call("variableChanged",event);if(!this.isRunning&&this.config.reRunOnVariableChange){if(!isNaN(this.config.reRunLimit))if(this.config.reRunLimit<=this.reRunCounter)return;var counterVal=this.reRunCounter+1;this.reset();this.reRunCounter=counterVal;this.resetFilters();this.runIfFiltersPass()}};BaseTag.prototype.attachVariablesChangedListeners=function(force){var variables=this.getPageVariables();var startObserving=!!(this.config.reRunOnVariableChange||this.config.observeVariables||
force);if(startObserving)for(var i=0;i<variables.length;i++){var variable=variables[i];variable.onValueChanged(this.handleVariableChange,startObserving)}};BaseTag.prototype.detachVariablesChangedListeners=function(){var variables=this.getPageVariables();for(var i=0;i<variables.length;i++){var variable=variables[i];variable.deatchOnValueChanged(this.handleVariableChange)}};BaseTag.prototype._markFinished=function(){BaseTag.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()};
BaseTag.prototype.prepareForRestart=function(noFilters){if(this.config.restartable){BaseTag.SUPER.prototype.prepareForRestart.call(this,false);if(!noFilters){var filters=this.getFilters();for(var i=0;i<filters.length;i++)filters[i].prepareForRestart()}}};BaseTag.prototype.restart=function(noFilters){if(this.config.restartable){this.prepareForRestart(noFilters);this.runIfFiltersPass()}}})();(function(){function LibraryTag(config){Utils.setIfUnset(config,LibraryTag.defaultConfig);if(this.singleton){var path=
this.PACKAGE_NAME+"."+this.CLASS_NAME;var zuper=qubit.opentag.Utils.getObjectUsingPath(path,PKG_ROOT);if(zuper.__instance)return zuper.__instance;zuper.__instance=this}LibraryTag.SUPER.call(this,config)}function extractAndEvalFunctionBody(fun,tag){var expr=fun.toString();expr=expr.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,"");expr=expr.substring(0,expr.lastIndexOf("}"));expr=expr.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"');expr=expr.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,
'"${$1}"$2');expr=expr.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"');expr=expr.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2');expr=expr.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3");expr=expr.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3");expr=tag.replaceTokensWithValues(expr);Utils.geval(expr)}var Utils=qubit.opentag.Utils;var Define=qubit.Define;
qubit.Define.clazz("qubit.opentag.LibraryTag",LibraryTag,qubit.opentag.BaseTag);LibraryTag.defaultConfig={vendor:null,imageUrl:null,description:"",async:false,isPrivate:false,upgradeable:true,html:"",parameters:[],prePostWindowScope:false};LibraryTag.prototype.pre=function(){};LibraryTag.prototype.post=function(){};LibraryTag.prototype.before=function(){LibraryTag.SUPER.prototype.before.call(this);try{var cfg=this.config;if(cfg&&cfg.pre)if(typeof cfg.pre==="function")this.pre=cfg.pre;else{var expr=
this.replaceTokensWithValues(String(cfg.pre));this.pre=Utils.expressionToFunction(expr).bind(this)}if(this.config.prePostWindowScope&&this.pre!==LibraryTag.prototype.pre&&this.pre.toString)extractAndEvalFunctionBody(this.pre,this);else this.pre()}catch(ex){return true}return false};LibraryTag.prototype.after=function(success){LibraryTag.SUPER.prototype.after.call(this,success);try{var cfg=this.config;if(cfg&&cfg.post)if(typeof cfg.post==="function")this.post=cfg.post;else{var expr=this.replaceTokensWithValues(String(cfg.post));
this.post=Utils.expressionToFunction(expr).bind(this)}if(this.config.prePostWindowScope&&this.post!==LibraryTag.prototype.post&&this.post.toString)extractAndEvalFunctionBody(this.post,this);else this.post(success)}catch(ex){}};LibraryTag.define=function(namespace,libConfig){namespace=namespace.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");namespace=qubit.Define.vendorsSpaceClasspath(namespace);var libraryDefaultConfig={};if(libConfig.getDefaultConfig)libraryDefaultConfig=libConfig.getDefaultConfig();
var constr=libConfig.CONSTRUCTOR;var prototypeTemplate={};for(var prop in libConfig)if(prop!=="config")prototypeTemplate[prop]=libConfig[prop];var constructor=function(cfg){cfg=cfg||{};cfg=Utils.overrideFromLeftToRight(libraryDefaultConfig,cfg);var ret=qubit.opentag.LibraryTag.call(this,cfg);if(constr)constr.call(this,cfg);if(ret)return ret};var ret$$0=qubit.opentag.Utils.defineWrappedClass(namespace,LibraryTag,prototypeTemplate,GLOBAL,constructor);var ns=Define.STANDARD_VS_NS+".";if(namespace.indexOf(ns)!==
0)Utils.namespace(ns+namespace,ret$$0);return ret$$0};LibraryTag.getLibraryByClasspath=function(namespace){return Utils.getObjectUsingPath(namespace,qubit.Define.getVendorSpace())}})();(function(){function CustomTag(config){var defaults={url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:true};Utils.setIfUnset(config,defaults);CustomTag.SUPER.call(this,config)}var Utils=qubit.opentag.Utils;qubit.Define.clazz("qubit.opentag.CustomTag",CustomTag,qubit.opentag.LibraryTag)})();
(function(){var Utils=qubit.opentag.Utils;var BaseFilter=qubit.opentag.filter.BaseFilter;var Tags=function(){};qubit.Define.clazz("qubit.opentag.Tags",Tags);Tags.getById=function(id){return qubit.opentag.BaseTag.getById(String(id))};Tags.getAllTagsByState=function(){return qubit.opentag.Container.getAllTagsByState(Tags.getTags())};Tags.findTagByName=function(match){var tags=this.getTags();var results=[];for(var i=0;i<tags.length;i++)if(tags[i].config.name===match)results.push(tags[i]);return results};
Tags.findTagByMatch=function(match){var tags=this.getTags();var results=[];for(var i=0;i<tags.length;i++)if(tags[i].config.name.match(match))results.push(tags[i]);return results};Tags.findTagContainers=function(tag){var containers=Tags.getContainers();var containing=[];for(var i=0;i<containers.length;i++){var tagsMap=containers[i].tags;for(var prop in tagsMap)if(tagsMap[prop]===tag){containing.push(containers[i]);break}}return containing};Tags.getTags=function(){return qubit.opentag.BaseTag.getTags()};
Tags.resetAllTags=function(skipFilters){var tags=Tags.getTags();for(var i=0;i<tags.length;i++){tags[i].reset();if(!skipFilters)tags[i].resetFilters()}};Tags.getContainersPageVariables=function(){var containers=Tags.getContainers();var vars=[];for(var i=0;i<containers.length;i++)vars=vars.concat(containers.getPageVariables());return vars};Tags.getAllPageVariables=function(){var tags=Tags.getTags();var vars=[];for(var i=0;i<tags.length;i++)vars=vars.concat(tags[i].getPageVariables());return vars};Tags.cancelAll=
function(){var tags=Tags.getTags();for(var i=0;i<tags.length;i++)tags[i].cancel()};Tags.resetAll=function(skipFilters){var tags=Tags.getTags();for(var i=0;i<tags.length;i++){tags[i].reset();if(!skipFilters)tags[i].resetFilters()}};Tags.getPageVariableByName=function(name){var vars=Tags.getAllPageVariables();var rets=[];for(var i=0;i<vars.length;i++)if(vars[i].config.name===name)rets.push(vars[i]);return rets};Tags.getLoadTime=function(tag){var start=tag.beforeRun;var end=tag.runIsFinished;if(isNaN(end))return{tag:tag,
loadTime:null};else return{tag:tag,loadTime:end-start}};Tags.getLoadTimes=function(tags){var ret=[];if(tags instanceof qubit.opentag.BaseTag){ret.push([Tags.getLoadTime(tags[prop])]);return ret}tags=tags||Tags.getTags();var array=tags instanceof Array;if(array)for(var i=0;i<tags.length;i++){if(tags[i]instanceof qubit.opentag.BaseTag)ret.push(Tags.getLoadTime(tags[i]))}else for(var prop in tags)if(tags[prop]instanceof qubit.opentag.BaseTag)ret.push(Tags.getLoadTime(tags[prop]));return ret};Tags.forceAllContainersAndTagsToRunIfDisabled=
function(){qubit.opentag.Container.setCookieForDisabledContainersToRun();qubit.opentag.BaseTag.setCookieForcingTagsToRun()};Tags.rmAllContainersAndTagsForcingFlags=function(){qubit.opentag.Container.rmCookieForDisabledContainersToRun();qubit.opentag.BaseTag.rmAllCookiesForcingTagToRun()};Tags.getContainers=function(){return qubit.opentag.Container.getContainers()};Tags.findAllTagsByClassPath=function(startsWith){var start=(new Date).valueOf();var ret=[];var excludes=[];try{excludes.push(qubit.opentag.CustomTag);
excludes.push(qubit.opentag.LibraryTag)}catch(ex){}var tags=Tags.getTags();for(var i=0;i<tags.length;i++){var tag=tags[i];if(Utils.indexInArray(excludes,tag)<0&&tag.PACKAGE_NAME.indexOf(startsWith)===0)ret.push(tag)}return ret};Tags.findAllTags=function(pckg,maxDeep){var BaseTag=qubit.opentag.BaseTag;var ret;var excludes=[];var start=(new Date).valueOf();try{excludes.push(qubit.opentag.CustomTag);excludes.push(qubit.opentag.LibraryTag)}catch(ex){}ret=Tags.findAllInstances(pckg,BaseTag,excludes,maxDeep);
return ret};var findAllIn=function(pckg,check,excludes,maxDeep){var instances=[];if(typeof pckg==="string")pckg=Utils.getObjectUsingPath(pckg);if(pckg){var cfg={objectsOnly:true};if(maxDeep)cfg.maxDeep=true;var fun=function(obj,parent,propName,trackPath){if(check(obj)){for(var i=0;i<excludes.length;i++)if(excludes[i]===obj)return true;Utils.addToArrayIfNotExist(instances,obj);return true}return false}.bind(this);Utils.traverse(pckg,fun,cfg)}return instances};Tags.findAllInstances=function(pckg,clazz,
excludes,maxDeep){var check=function(obj){return obj instanceof clazz};return findAllIn(pckg,check,excludes,maxDeep)};Tags.findAllInheriting=function(pckg,clazz,excludes,maxDeep){var check=function(obj){return obj.prototype instanceof clazz};return findAllIn(pckg,check,excludes,maxDeep)};Tags.findAllFilters=function(pckg,maxDeep){var excludes=[];try{excludes.push(qubit.opentag.filter.Filter);excludes.push(qubit.opentag.filter.URLFilter)}catch(ex){}return Tags.findAllInheriting(pckg,BaseFilter,excludes,
maxDeep)}})();q.cookie={};q.cookie.PageView={};q.cookie.PageView.update=function(){var a;var r;r=function _(){return Math.floor(1+Math.random()*65536).toString(36).substring(1)};if(!window.__pageViewId__){a=(new Date).getTime().toString(36);window.__pageViewId__=a+r()+r()+r()}return window.__pageViewId__};q.html.PostData=function(url,data,type,contentType){var _post;var agent;var isIe;var isIe9;var isOldIe;var fullUrl;var loaded;var retry;var retryDelay;var retryCount;retryCount=2;retryDelay=5E3;
loaded=false;retry=function(){if(retryCount>0)setTimeout(function(){if(!loaded){retryCount-=1;_post()}},retryDelay)};agent=navigator.userAgent.toLowerCase();isIe=agent.indexOf("msie")!==-1;isIe9=agent.indexOf("msie 9")!==-1;isOldIe=agent.indexOf("msie 7")!==-1||agent.indexOf("msie 6")!==-1;fullUrl=("https:"===document.location.protocol?"https:":"http:")+url;type=type||"POST";_post=function(){var xhr;try{xhr=null;try{xhr=new XMLHttpRequest}catch(e1){}if(xhr&&!isIe)xhr.open(type,fullUrl,true);else if(typeof XDomainRequest!==
"undefined"){xhr=new XDomainRequest;xhr.open(type,fullUrl)}else xhr=null;try{xhr.withCredentials=false}catch(e2){}if(xhr.setRequestHeader)if(contentType)xhr.setRequestHeader("Content-Type",contentType);else xhr.setRequestHeader("Content-Type","text/plain;charset\x3dUTF-8");xhr.onload=function(){loaded=true};xhr.onreadystatechange=function(){};xhr.ontimeout=function(){};xhr.onerror=function(){};xhr.onprogress=function(){};xhr.send(data)}catch(err){try{try{q.html.fileLoader.load(fullUrl)}catch(err2){if(window.console&&
window.console.log)window.console.log(err)}}catch(e){}}};if(isOldIe){q.html.fileLoader.load(fullUrl);return}else _post()};(function(){function Ping(){}function prepareContainerMsg(container,config){var msgObject={};msgObject.clientId=""+config.clientId;msgObject.containerId=""+container.getContainerId();msgObject.classpath=""+container.PACKAGE_NAME;msgObject.opentagStats=true;if(container.sentPing)msgObject.containerLoad=false;else{container.sentPing=(new Date).valueOf();msgObject.containerLoad=true}msgObject.isS3=
false;msgObject.pageViewId=q.cookie.PageView.update();msgObject.tags=[];return msgObject}var appJsonCT="text/plain;charset\x3dUTF-8";qubit.Define.clazz("qubit.opentag.Ping",Ping);Ping.prototype.sendErrors=function(container,errors){};Ping.getPingID=function(tag){if(tag.config.id)return tag.config.id;var idx=tag.PACKAGE_NAME.lastIndexOf(".");if(idx!==-1)return tag.PACKAGE_NAME.substring(idx+1);else return tag.PACKAGE_NAME};Ping.prototype.send=function(container,loadTimes){var config=container.config;
var msgObject=prepareContainerMsg(container,config);var tagLogs=msgObject.tags;var pingURL=config.pingServerUrl;for(var i=0;i<loadTimes.length;i++){var tag=loadTimes[i].tag;var loadTime=loadTimes[i].loadTime;if(loadTime===null||isNaN(loadTime))continue;var tagMsg={};var tagID=Ping.getPingID(tag);if(!tag.pingSent&&tagID&&loadTime!==null)if(tagID!==undefined){tagMsg.tagId=tagID;tagMsg.loadTime=loadTime;tagMsg.fired=true;tagLogs.push(tagMsg);tag.pingSent=true}else;else if(tag.pingSent);else if(loadTime===
null);}if(pingURL&&(tagLogs.length>0||msgObject.containerLoad)){var pingString=JSON.stringify(msgObject);var url="//"+pingURL;q.html.PostData(url,pingString,"POST",appJsonCT)}else{if(!tagLogs.length);if(!pingURL);}};Ping.prototype.sendDedupe=function(container,tags){var config=container.config;var msgObject=prepareContainerMsg(container,config);var pingURL=config.pingServerUrl;var tagLogs=msgObject.tags;for(var i=0;i<tags.length;i++){var tag=tags[i];var tagId=Ping.getPingID(tag);var tagMsg={};if(tagId===
undefined);else if(!tag.dedupePingSent){tagMsg.tagId=""+tagId;tagMsg.fired=false;tagMsg.loadTime=0;tagLogs.push(tagMsg);tag.dedupePingSent=true}}if(pingURL&&(tagLogs.length>0||msgObject.containerLoad)){var pingString=JSON.stringify(msgObject);var url="//"+pingURL;q.html.PostData(url,pingString,"POST",appJsonCT)}else{if(!tagLogs.length);if(!pingURL);}}})();q.cookie.SimpleSessionCounter={};q.cookie.SimpleSessionCounter._cookieName="_qst_s";q.cookie.SimpleSessionCounter._sessionCookie="_qsst_s";q.cookie.SimpleSessionCounter.update=
function(domain){var c;var s;var ga;var mins=30;c=qubit.Cookie.get(q.cookie.SimpleSessionCounter._cookieName);s=qubit.Cookie.get(q.cookie.SimpleSessionCounter._sessionCookie);if(!c)c=1;else{c=parseInt(c,10);if(!s||parseInt(s,10)<(new Date).getTime()-mins*60*1E3)c+=1}qubit.Cookie.set(q.cookie.SimpleSessionCounter._cookieName,c,365,domain);qubit.Cookie.set(q.cookie.SimpleSessionCounter._sessionCookie,(new Date).getTime().toString(),null,domain);return c};(function(){function LZW(config){if(config)if(config.alphabet){this.alphabet=
config.alphabet;this.dict={};for(var i=0;i<this.alphabet.length;i++)this.dict[this.alphabet[i]]=i}else{this.alphabet=defaultAlphabet;this.dict=xdict}}function getFromDict(code,dict){for(var p in dict)if(code===dict[p])return p;return null}var defaultAlphabet=[];var len=Math.pow(2,8);for(var c=0;c<len;c++)defaultAlphabet.push(String.fromCharCode(c));var xdict={};for(var i$$0=0;i$$0<defaultAlphabet.length;i$$0++)xdict[defaultAlphabet[i$$0]]=i$$0;var Define=qubit.Define;Define.clazz("qubit.compression.LZW",
LZW);LZW.prototype.encode=function(string){var dictsize=this.alphabet.length;var extDict={};var results=[];var index=0;var curr=string.charAt(index++);var next;for(var dict=this.dict;!!(next=string.charAt(index++));){var newWord=curr+next;if(dict.hasOwnProperty(newWord)||extDict.hasOwnProperty(newWord))curr=newWord;else{var val=dict.hasOwnProperty(curr)?dict[curr]:extDict[curr];if(val===undefined)throw"Dictionary base is to small for those contents: "+curr;results.push(val);extDict[newWord]=dictsize++;
curr=next}}if(curr!=="")results.push(extDict.hasOwnProperty(curr)?extDict[curr]:dict[curr]);return results};LZW.prototype.decode=function(codes){var dict=this.dict;var dictSize=this.alphabet.length;var chunk;var locdict={};var prevChar=getFromDict(codes[0],dict);var prevChunk=prevChar;var results=[prevChar];for(var i=1;i<codes.length;i++){var currentCode=codes[i];chunk=getFromDict(currentCode,dict);if(chunk===null){if(locdict.hasOwnProperty(currentCode))chunk=locdict[currentCode];if(chunk===null)chunk=
prevChunk+prevChar}results.push(chunk);prevChar=chunk.charAt(0);locdict[dictSize++]=prevChunk+prevChar;prevChunk=chunk}return results.join("")}})();(function(){function converToMex(number){var rest=0;var minus=number<0;if(minus)number=-number;var newNum="";var first=true;do{rest=number%maxMnum;if(first){newNum=UmexToMexMap[mnums[rest]];first=false}else newNum=mnums[rest]+newNum;number=(number-rest)/maxMnum}while(number>0);if(minus)return"-"+newNum;return newNum}function convertFromMex(mexNum){var newNum=
0;var pow=0;var first=true;for(var i=0;i<mexNum.length;i++){var cur=mexNum.charAt(mexNum.length-1-i);if(first){first=false;cur=mex.charAt(UmexMap[cur])}newNum+=mexMap[cur]*Math.pow(maxMnum,pow++)}return newNum}function Compressor(config){}var mex="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"'%./:\x3c\x3e?[";var Umex="ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"*!-+()@{|}"+'"]^_`~$\x26#';var mexMap={};for(var c=0;c<mex.length;c++)mexMap[mex.charAt(c)]=c;var UmexMap={};for(var ii=0;ii<mex.length;ii++)UmexMap[Umex.charAt(ii)]=
ii;var UmexToMexMap={};for(var iii=0;iii<mex.length;iii++)UmexToMexMap[mex.charAt(iii)]=Umex.charAt(iii);var mnums=mex.split("");var maxMnum=mnums.length;var lzw=new qubit.compression.LZW({});var Define=qubit.Define;Define.clazz("qubit.compression.Compressor",Compressor);Compressor.prototype.compress=function(string,lz){var array=(lz||lzw).encode(string);var result=[];for(var i=0;i<array.length;i++)result.push(String.fromCharCode(array[i]));return result.join("")};Compressor.prototype.compressAnsi=
function(string,lz){var array=(lz||lzw).encode(string);var result=[];for(var i=0;i<array.length;i++){var num=converToMex(array[i]);result.push(num)}return result.join("")};Compressor.prototype.decompressAnsi=function(code,lz){var array=[];var curr="";for(var i=0;i<code.length;i++){var ch=code.charAt(i);if(UmexMap.hasOwnProperty(ch)){var num=curr+ch;curr="";num=convertFromMex(num);array.push(num)}else curr+=ch}return(lz||lzw).decode(array)};Compressor.prototype.decompress=function(code,lz){var array=
[];for(var i=0;i<code.length;i++)array.push(code.charCodeAt(i));return(lz||lzw).decode(array)}})();(function(){function prepareDefinitions(array){var definitions=[];for(var i=0;i<array.length;i++){var preparedString=escapeRegExp(array[i][0]);definitions.push([new RegExp(preparedString,"g"),"*"+array[i][1]])}return definitions}function getDefinitionByChar(ch,definitions){for(var i=0;i<definitions.length;i++)if(definitions[i][1]===ch)return definitions[i][0];return null}function Encoder(config){this._regexDefs=
regexDefinitions;this._defs=definitions;if(config)if(config.definitions){this._regexDefs=prepareDefinitions(config.definitions);this._defs=config.definitions}}function replaceWithUTFEncoding(string,range){var rewrite=[];for(var i=0;i<string.length;i++){var inRange=true;if(range)inRange=string.charCodeAt(i)<=range;var inCookieAlphabet=Cookie.cookieAlphabetMap.hasOwnProperty(string.charAt(i));if(inRange&&!inCookieAlphabet)rewrite.push("*"+string.charCodeAt(i)+".");else rewrite.push(string.charAt(i))}return rewrite.join("")}
function replaceWithDynamicDictionary(ddict,string){string=string.replace(/@/g,"@@");var dict=[];var i=0;for(var j=0;i<ddict.length;i++){var pattern=ddict[i][0];var rx=new RegExp(escapeRegExp(pattern),"g");var out=string.replace(rx,"@"+j+"-");if(out!==string){dict.push(ddict[i][0]);j++;string=out}}return[string,dict]}function escapeRegExp(string){return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function dynamicDictionary(str){var parts={};var word="";for(var i=0;i<str.length;i++){var ch=
str.charAt(i);if(!dynamicDictCharsMap[ch]){if(isNaN(parts[word]))parts[word]=str.split(word).length-1;word=""}else word+=ch}var dict=[];for(var prop in parts)if(parts.hasOwnProperty(prop)){var occurringNum=parts[prop];if(occurringNum>=MIN_OCCURENCE_LEN&&prop.length>=MIN_WORD_LEN)dict.push([prop,occurringNum])}dict=dict.sort(function(a,b){if(a[0].length===b[0].length)return 0;if(b[0].length>a[0].length)return 1;else return-1});return dict}function decodeDynamicDictionary(string,ddict){if(!ddict||ddict.length===
0||!string)return string;var ret="";var codeWord=false;var collectingNum=false;var codeNum="";for(var i=0;i<string.length;i++){var ch=string.charAt(i);if(ch==="@"||codeWord||collectingNum)if(codeWord||collectingNum){codeWord=false;if(ch==="@")ret+="@";else if(!isNaN(+("-"+ch))){collectingNum=true;codeNum=codeNum+ch}else if(collectingNum){if(ddict&&ch==="-"&&ddict[+codeNum])ret+=ddict[+codeNum];else ret+="@"+codeNum+ch;codeNum="";collectingNum=false}else ret+="@"+ch}else codeWord=true;else ret+=ch}if(codeNum)ret+=
"@"+codeNum;if(codeWord)ret+="@";return ret}var Define=qubit.Define;var Cookie=qubit.Cookie;var definitions=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',
"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["\x3c","S"],["\x3e","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]];var regexDefinitions=
prepareDefinitions(definitions);Define.clazz("qubit.opentag.compression.Encoder",Encoder);Encoder.prototype.encode=function encode(string,limitUTFRange){var ret=string.replace(/\*/g,"**");var ininitalDdict=dynamicDictionary(ret);for(var i=0;i<this._regexDefs.length;i++){var pair=this._regexDefs[i];ret=ret.replace(pair[0],pair[1])}ret=ret.replace(/;/g,"*-");ret=ret.replace(/&/g,"*.");ret=ret.replace(/\\/g,"*/");ret=ret.replace(/=/g,"*+");ret=ret.replace(/\n/g,"*N");ret=ret.replace(/ /g,"*_");ret=ret.replace(/\t/g,
"*T");ret=ret.replace(/"/g,"*Q");var ddict=dynamicDictionary(ret);ddict.concat(ininitalDdict);var result=replaceWithDynamicDictionary(ddict,ret);var actualDict=result[1];var replacementsOccured=actualDict.length>0;if(replacementsOccured)ret=result[0];if(!limitUTFRange)ret=replaceWithUTFEncoding(ret);else ret=replaceWithUTFEncoding(ret,limitUTFRange);if(replacementsOccured)return"Y"+actualDict.join("*")+"@"+ret;else return"N"+ret};var dynamicDictChars="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.";
var dynamicDictCharsMap={};for(var i$$0=0;i$$0<dynamicDictChars.length;i$$0++)dynamicDictCharsMap[dynamicDictChars.charAt(i$$0)]=true;var MIN_WORD_LEN=4;var MIN_OCCURENCE_LEN=2;Encoder.prototype.decode=function(string){var ddict=null;if(string.charAt(0)==="N")string=string.substring(1);else if(string.charAt(0)==="Y"){var qMkIdx=string.indexOf("@");if(qMkIdx>=0){ddict=string.substring(1,qMkIdx);ddict=ddict.split("*");string=string.substring(qMkIdx+1);string=decodeDynamicDictionary(string,ddict)}}var ret=
"";var codeWord=false;var collectingNum=false;var utfNum="";for(var i=0;i<string.length;i++){var ch=string.charAt(i);if(ch==="*"||codeWord||collectingNum)if(codeWord||collectingNum){codeWord=false;if(!isNaN(+("-"+ch))){utfNum=utfNum+ch;collectingNum=true}else if(collectingNum){if(ch===".")ret+=String.fromCharCode(+utfNum);else if(ch==="-"&&getDefinitionByChar(utfNum+"-",this._defs))ret+=getDefinitionByChar(utfNum+"-",this._defs);else ret+="*"+utfNum+ch;utfNum="";collectingNum=false}else if(ch==="*")ret+=
"*";else if(ch==="-")ret+=";";else if(ch==="/")ret+="\\";else if(ch===".")ret+="\x26";else if(ch==="+")ret+="\x3d";else if(ch==="N")ret+="\n";else if(ch==="_")ret+=" ";else if(ch==="T")ret+="\t";else if(ch==="Q")ret+='"';else if(getDefinitionByChar(ch,this._defs)!==null){var def=getDefinitionByChar(ch,this._defs);ret+=def}else ret+="*"+ch}else codeWord=true;else ret+=ch}if(utfNum)ret+="*"+utfNum;if(codeWord)ret+="*";return ret}})();(function(){function CookieCompressor(config){this.testBinary=false;
this.binSupported=binSupported;if(config){this.compressor=new qubit.compression.Compressor;this.encoder=new qubit.opentag.compression.Encoder({})}}var Define=qubit.Define;var Cookie=qubit.Cookie;var binSupported=false;Define.clazz("qubit.opentag.compression.CookieCompressor",CookieCompressor);CookieCompressor.prototype.compress=function(string,forceCompression){if(typeof string!=="string"||string==="")return string;var encoded=this.encoder.encode(string);var binOut;if(this.binSupported||this.testBinary){var bin=
this.compressor.compress(encoded);binOut='"B'+this.encoder.encode(bin,128)+'"';Cookie.set("__qtag_test_bin__",binOut,undefined,undefined,true);var o=Cookie.get("__qtag_test_bin__",true);Cookie.rm("__qtag_test_bin__");if(o&&o!==binOut)binOut=null}var ansiOut;var compressed=this.encoder.encode(this.compressor.compressAnsi(encoded));if(!forceCompression&&encoded.length<=compressed.length)ansiOut="E"+encoded;else ansiOut="C"+compressed;if(binOut&&binOut.length<ansiOut.length)return binOut;else return ansiOut};
CookieCompressor.prototype.decompress=function(string){if(typeof string!=="string"||string==="")return string;if(string.charAt(0)==='"')string=string.substring(1,string.length-1);var code=string.charAt(0);string=string.substring(1);switch(code){case "E":return this.encoder.decode(string);case "C":var tmp=this.compressor.decompressAnsi(this.encoder.decode(string));return this.encoder.decode(tmp);case "B":var tmp1=this.compressor.decompress(this.encoder.decode(string));return this.encoder.decode(tmp1);
default:throw"This code is not supported! Code: "+code;}}})();(function(){var Cookie=qubit.Cookie;var Utils=qubit.opentag.Utils;var Session=function(){};qubit.Define.clazz("qubit.opentag.Session",Session);var compressor=new qubit.opentag.compression.CookieCompressor({});Session.readCompressedCookie=function(name){var cookie=Cookie.get(name,true);return compressor.decompress(cookie)};Session.setupSession=function(container){var config=container.config;var session;var i;var cookie;var cookieText;var cookieName;
var now;session={};session.sessionCount=q.cookie.SimpleSessionCounter.update(config.cookieDomain);cookieName="qtag_"+container.getContainerId();var xCookieName="x_qtag_"+container.getContainerId();cookie=Cookie.get(cookieName);var nonCompressedCookie=!!cookie;if(cookie===null){cookie=Cookie.get(xCookieName,true);cookie=compressor.decompress(cookie)}if(cookie)try{cookie=JSON.parse(cookie)}catch(e){cookie={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else cookie=
{sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};now=(new Date).getTime();if(session.sessionCount!==parseInt(cookie.sc,10)){cookie.sessionStartTime=now;cookie.sc=session.sessionCount;cookie.sessionCount+=1;cookie.referrer.push({url:Session.getReferrer(),landing:Utils.getUrl().substring(0,300),time:now});cookie.sessionLandingPage=Utils.getUrl().substring(0,300)}else if(Session.isReferrerDifferent())if(!Session.referrerIsSameAsPrevious(cookie.referrer,now,
30*60*1E3)){cookie.referrer.push({url:Session.getReferrer(),landing:Utils.getUrl().substring(0,300),time:now});cookie.sessionLandingPage=Utils.getUrl().substring(0,300);cookie.sessionStartTime=now;cookie.sessionCount+=1}session.sessionCount=cookie.sessionCount;session.sessionStartTime=cookie.sessionStartTime;session.pageStartTime=now;cookie.pageViews+=1;session.pageViews=cookie.pageViews;session.sessionLandingPage=cookie.sessionLandingPage;session.referrer=cookie.referrer;if(session.referrer.length>
5)session.referrer.splice(2,session.referrer.length-5);cookieText=JSON.stringify(cookie);for(i=0;compressor.compress(cookieText).length>config.maxCookieLength&&i<5;){if(cookie.referrer.length>=3)cookie.referrer.splice(2,1);else if(cookie.referrer.length===2)cookie.referrer=[cookie.referrer[0]];else if(cookie.referrer.length===1)cookie.referrer=[];cookieText=JSON.stringify(cookie);i+=1}session.referrer=cookie.referrer;if(nonCompressedCookie)Cookie.rm(cookieName);var xCookieText=compressor.compress(cookieText);
Cookie.rm(xCookieName);if(config.maxCookieLength>0)Cookie.set(xCookieName,xCookieText,365,config.cookieDomain,true);session.setVariable=function(key,value,time){var t=!!time?time:0;cookie.__v[key]=[value,t];var xCookieText=compressor.compress(JSON.stringify(cookie));if(config.maxCookieLength>0)Cookie.set(xCookieName,xCookieText,365,config.cookieDomain,true);else Cookie.rm(xCookieName)};session.getCookie=function(name,compressed){var res=Cookie.get(name,true);if(res&&(compressed||name.indexOf("x_")===
0))try{res=compressor.decompress(res)}catch(ex){}else if(res!==null)res=Cookie.decode(res);return res};session.getVariable=function(key){var v;var t;var now;v=cookie.__v[key];if(v){t=v[1];if(t===0||t>(new Date).getTime())return v[0]}return null};session.on=function(event,el,fn){if(el.attachEvent)el.attachEvent("on"+event,fn);else if(el.addEventListener)el.addEventListener(event,fn,false)};session.getTagCookie=function(){return Session.readCompressedCookie(xCookieName)};Session.lastSession=session;
return session};Session.referrerIsSameAsPrevious=function(referrers,now,overlapDuration){var url;var landing;var lastReferrer;if(referrers.length>0){url=Session.getReferrer();landing=Utils.getUrl().substring(0,300);lastReferrer=referrers[referrers.length-1];return lastReferrer.url===url&&lastReferrer.landing===landing&&lastReferrer.time+overlapDuration>now}return false};Session.isReferrerDifferent=function(){var start;var end;var ref;ref=Session.getReferrer();start=ref.indexOf("://");if(start===-1)return true;
start+=3;try{if(ref.substring(start).indexOf(Session.getDomain())!==0)return true;return false}catch(ex){return true}};Session.getReferrer=function(){if(document.referrer)return document.referrer.substring(0,300);return"direct"};Session.getDomain=function(){return document.location.host}})();(function(){function Quick(){}var LibraryTag=qubit.opentag.LibraryTag;var Define=qubit.Define;Quick.library=function(){return LibraryTag.define.apply(LibraryTag,arguments)};Quick.libraryRef=function(){return LibraryTag.getLibraryByClasspath.apply(LibraryTag.getLibraryByClasspath,
arguments)};Define.namespace("qubit.Quick",Quick)})();(function(){function Container(config){this.runQueue=[];this.tags=[];this.config={cookieDomain:"",maxCookieLength:1E3,gzip:true,delayDocWrite:false,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:false,containerId:"",scanTags:false,noPings:false,restartable:true};this.ignoreTagsState=false;if(config){this.setConfig(config);if(!config.name)this.config.name="Cont-"+_counter++;Container.register(this);
if(Container.NO_PINGS)this.config.noPings=true;this.ping=new qubit.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(config.init)try{config.init.call(this,config)}catch(ex){}var _this=this;this._tagLoadedHandler=function(event){if(_this._containerAlreadySentPings){_this.sendPingsNotTooOften();if(event.success);}}}this.events=new qubit.Events({});return this}function attachRenamedIfExist(obj,src,name,steps){if(obj[name]){steps[name]=steps[name]+1||1;name+="("+steps[name]+
")"}obj[name]=src}var Utils=qubit.opentag.Utils;var BaseFilter=qubit.opentag.filter.BaseFilter;var Filter=qubit.opentag.filter.Filter;var BaseTag=qubit.opentag.BaseTag;var Timed=qubit.opentag.Timed;var Tags=qubit.opentag.Tags;var Session=qubit.opentag.Session;var Cookie=qubit.Cookie;var _counter=1;try{window.opentag_consentGiven=function(){Container.consentIsGiven=true;var all=Container.getContainers();for(var i=0;i<all.length;i++)try{all[i].run()}catch(ex){}}.bind(this)}catch(ex){}qubit.Define.clazz("qubit.opentag.Container",
Container);var containers$$0=[];var RESTART_EVENT="restart";Container.prototype.EVENT_TYPES={RESTART_EVENT:RESTART_EVENT};Container.register=function(ref){Utils.addToArrayIfNotExist(containers$$0,ref)};Container.prototype.isTellingLoadTimes=function(){var value=this.config.tellLoadTimesProbability;if(value===null)value=0;return value>Math.random()};Container.prototype.destroy=function(withTags){this.destroyed=true;this.unregister();for(var i=0;i<this.tags.length;i++){var tag=this.tags[i];Utils.removeFromArray(tag.owningContainers,
this);if(withTags&&tag instanceof BaseTag)tag.destroy()}this.tags=[]};Container.destroyAll=function(withTags){var items=Container.getContainers();for(var i=0;i<items.length;i++)items[i].destroy(withTags)};Container.findContainersByName=function(name){var items=Container.getContainers();var results=[];for(var i=0;i<items.length;i++)if(items[i].config.name===name)results.push(items[i]);return results};Container.getById=function(id){var items=Container.getContainers();for(var i=0;i<items.length;i++)if(items[i].getContainerId()===
id)return items[i];return null};Container.prototype.unregister=function(withTags){Container.unregister(this,withTags)};Container.unregister=function(ref,withTags){Utils.addToArrayIfNotExist(containers$$0,ref);var index=Utils.removeFromArray(containers$$0,ref);if(withTags){for(var i=0;i<ref.tags.length;i++){var tag=ref.tags[i];tag.owningContainers=[];if(tag instanceof BaseTag)tag.unregister()}ref.tags=[]}if(!index||index.length===0);};Container.prototype.hasConsent=function(){return Cookie.get("qubitconsent")===
"Accepted"};Container.prototype.register=function(ref){Container.register(ref||this)};Container.getContainers=function(){return containers$$0};Container.prototype.getContainers=function(){return Container.getContainers()};Container.prototype.onTagRegistered=function(tag){};Container.prototype.registerTag=function(tag){if(Utils.existsInArray(tag.owningContainers,this))return false;else{this.tags.push(tag);tag.owningContainers.push(this);tag.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(tag)}catch(ex){}}return true};
Container.prototype.unregisterTag=function(tag){var oc=tag.owningContainers;var i;for(i=0;i<oc.length;)if(oc[i]===this)oc.splice(i,1);else i++;for(i=0;i<this.tags.length;)if(this.tags[i]===tag)this.tags.splice(i,1);else i++};Container.prototype.registerTags=function(tags){for(var i=0;i<tags.length;i++)this.registerTag(tags[i])};Container.prototype.setConfig=function(config){for(var prop in config)this.config[prop]=config[prop]};Container.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};
Container.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};Container.prototype.containerScriptLoadedSynchronously=function(){var i;var ii;var script;var scripts;var src;scripts=document.getElementsByTagName("script");for(i=0,ii=scripts.length;i<ii;i+=1){script=scripts[i];src=script.getAttribute("src");if(!!src&&src.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js")>0)return script.getAttribute("async")===null&&(script.getAttribute("defer")===false||script.getAttribute("defer")===
""||script.getAttribute("defer")===null)}return true};Container.prototype.prepareSessionIfNeeded=function(){var trackSession=this.config.trackSession;if(trackSession!==true&&trackSession!==false)for(var j=0;j<this.tags.length;j++){var tmpTag=this.tags[j];tmpTag.resolveAllDynamicData();var filters=tmpTag.getFilters();for(var i=0;i<filters.length;i++){var filter=filters[i];if(filter instanceof Filter&&filter.isSession()){this.trackSession=true;break}}if(this.trackSession)break}else this.trackSession=
trackSession;if(Container.TRACK_SESSION)this.trackSession=true;if(this.trackSession)this.session=Session.setupSession(this);if(this.session);};Container.runtimeCounter=Container.runtimeCounter||1;Container.prototype.runTags=function(config,force){if(this.destroyed)throw"Container has been destroyed.";if(!force)if(Container.LOCKED||Utils.global().QUBIT_CONTAINERS_LOCKED)return;if(this.onBeforeRun)try{this.onBeforeRun()}catch(ex){}var forceAsync=!this.containerScriptLoadedSynchronously();var command=
"runIfFiltersPass";if(config&&config.command)command=config.command;this.runningStarted=(new Date).valueOf();if(this.config.scanTags)if(!this._scanned){this.scanForTags();this._scanned=(new Date).valueOf()}this.prepareSessionIfNeeded();var orderedTags=this.getTagsInOrder();var runtimeMark="___otctnmk"+Container.runtimeCounter++;for(var z=0;z<orderedTags.length;z++)try{var tag=orderedTags[z];if(this.includedToRun(tag))this._checkAndRun(tag,command,forceAsync,runtimeMark)}catch(ex){}Timed.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),
3100);this.waitForAllTagsToFinish();for(var c=0;c<orderedTags.length;c++){orderedTags[c]._runtimeMarkers[runtimeMark]=undefined;delete orderedTags[c]._runtimeMarkers[runtimeMark]}};Container.prototype.getTagsInOrder=function(){var tagsOrdered=[];for(var i=0;i<this.tags.length;i++){var tmpTag=this.tags[i];var priority=tmpTag.config.priority;if(+priority>0){var prIndex=0;for(var c=0;c<tagsOrdered.length;c++){var tmpTagOrdered=tagsOrdered[c];if(tmpTagOrdered){var priorityAlreadyIn=+tmpTagOrdered.config.priority;
if(priorityAlreadyIn>0&&priorityAlreadyIn>priority)prIndex++;else break}}tagsOrdered.splice(prIndex,0,tmpTag)}else tagsOrdered.push(tmpTag)}return tagsOrdered};Container.prototype._checkAndRun=function(tag,command,forceAsync,runtimeMark){if(!tag._runtimeMarkers[runtimeMark])tag._runtimeMarkers[runtimeMark]=true;else return;var deps=tag.resolveDependencies();if(deps.length>0)for(var i=0;i<deps.length;i++)this._checkAndRun(deps[i],command,forceAsync,runtimeMark);this._tagRunner(tag,command,forceAsync)};
Container.prototype._tagRunner=function(tag,command,forceAsync){try{if(this.includedToRun(tag)){if(forceAsync)tag.forceAsynchronous=true;if(this.config.delayDocWrite)tag.delayDocWrite=true;tag.session=tag.session||this.session;tag[command]()}}catch(ex){}};Container.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;else{if(this._pkgName)return this._pkgName;var idx=this.PACKAGE_NAME.split(".");idx=idx[idx.length-1];this._pkgName=idx;return idx}};Container.prototype.includedToRun=
function(tag){if(!tag)return false;var cfg=tag.config;if(cfg.inactive)return false;if(cfg.disabled)if(!tag.cookieSaysToRunEvenIfDisabled())return false;if(tag.disabledByCookie())return false;var consentOk=Container.consentIsGiven||!cfg.needsConsent||this.hasConsent();var atInitialState=tag.state===BaseTag.prototype.STATE.INITIAL;return this.ignoreTagsState||consentOk&&atInitialState};Container.prototype.scanForTags=function(clean,pkg){if(clean)this.tags=[];var tags;if(pkg&&typeof pkg==="object")tags=
this.findAllTags(pkg);else tags=this.findAllTagsByClassPath();this.registerTags(tags);return tags};Container.prototype.findAllTags=function(pckg,maxDeep){pckg=pckg||this.tagsPackageName||this.PACKAGE_NAME;return Tags.findAllTags(pckg,maxDeep)};Container.prototype.findAllTagsByClassPath=function(startsWith){startsWith=startsWith||this.PACKAGE_NAME;return Tags.findAllTagsByClassPath(startsWith)};Container.prototype.findAllFilters=function(pckg,maxDeep){pckg=pckg||this.tagsPackageName||this.PACKAGE_NAME;
return Tags.findAllFilters(pckg,maxDeep)};Container.prototype.waitForAllTagsToFinish=function(){if(this._waitForAllTagsToFinishWaiting)return;if(!this._lastWaited)this._lastWaited=(new Date).valueOf();var timedOut=(new Date).valueOf()-this._lastWaited>15*1E3;var finished=this.allTagsFinished()||timedOut;if(!this._showFinishedOnce&&finished){this._lastWaited=null;if(timedOut);this._showFinishedOnce=true;this.runningFinished=(new Date).valueOf();this._containerAlreadySentPings=(new Date).valueOf();
this.sendPingsNotTooOften();if(this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else if(!finished){this._waitForAllTagsToFinishWaiting=true;this._showFinishedOnce=false;Timed.setTimeout(function(){this._waitForAllTagsToFinishWaiting=false;this.waitForAllTagsToFinish()}.bind(this),100)}else;};Container.prototype.onTagsInitiallyRun=EMPTY_FUN;Container.prototype.resetAllTags=function(skipFilters){for(var i=0;i<this.tags.length;i++){this.tags[i].reset();if(!skipFilters)this.tags[i].resetFilters()}};
Container.prototype._prepareTagsToRestart=function(noFilters){for(var i=0;i<this.tags.length;i++)this.tags[i].prepareForRestart(noFilters)};Container.prototype.reset=function(skipTags,skipFilters){this.runningFinished=undefined;this._waitForAllTagsToFinishWaiting=undefined;this.runningStarted=undefined;this._showFinishedOnce=undefined;if(!skipTags)this.resetAllTags(skipFilters)};Container.prototype.onRestart=function(callback){this.events.on(RESTART_EVENT,callback)};Container.prototype.restart=function(skipTags,
skipFilters){if(this.config.restartable){this.events.call(RESTART_EVENT,this);this.reset(true,true);if(!skipTags)this._prepareTagsToRestart(skipFilters);this.run()}};Container.restartAll=function(noTags,noFilters){var containers=Container.getContainers();for(var i=0;i<containers.length;i++)try{containers[i].restart(noTags,noFilters)}catch(ex){log.ERROR("Restart failed for container "+containers[i].config.name,ex)}};Container.resetAll=function(skipTags,skipFilters){var containers=Container.getContainers();
for(var i=0;i<containers.length;i++)try{containers[i].reset(skipTags,skipFilters)}catch(ex){log.ERROR("Reset failed for container "+containers[i].config.name,ex)}};Container.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};Timed.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};Container.prototype.sendPings=function(){if(this.config.noPings)return;var i;if(this.isTellingLoadTimes()){var results=this.getAllTagsByState();var loadTimes=[];if(results.run)loadTimes=Tags.getLoadTimes(results.run);
this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,loadTimes);loadTimes=Tags.getLoadTimes();var deduplicatedTagsToBeSent=[];for(i=0;i<loadTimes.length;i++){var tag=loadTimes[i].tag;if(tag.config.dedupe&&tag.sendDedupePing)deduplicatedTagsToBeSent.push(tag)}if(deduplicatedTagsToBeSent.length>0){this.lastDedupePingsSentTime=(new Date).valueOf();this.ping.sendDedupe(this,deduplicatedTagsToBeSent)}if(results.other){loadTimes=Tags.getLoadTimes(results.other);var otherTagsToBeSent=[];for(i=
0;i<loadTimes.length;i++)otherTagsToBeSent.push(loadTimes[i]);if(otherTagsToBeSent.length>0)this.ping.send(this,otherTagsToBeSent)}if(results.awaiting){loadTimes=Tags.getLoadTimes(results.awaiting);var awaitingTagsToBeSent=[];for(i=0;i<loadTimes.length;i++)awaitingTagsToBeSent.push(loadTimes[i]);if(awaitingTagsToBeSent.length>0)this.ping.send(this,awaitingTagsToBeSent)}}else this.ping.send(this,[])};Container.prototype.getAllTagsByState=function(){return Container.getAllTagsByState(this.tags)};Container.getAllTagsByState=
function(tags){var runScripts=null;var other=null;var filterReady=null;var failed=null;var consent=null;var locked=null;var steps={};var LOWEST_FAIL_STATE=BaseTag.prototype.STATE.EXECUTED_WITH_ERRORS;for(var i=0;i<tags.length;i++){var tag=tags[i];if(tag instanceof BaseTag){var name=tag.config.name;if(tag.scriptExecuted>0){runScripts=runScripts||{};attachRenamedIfExist(runScripts,tag,name,steps)}else if(tag.locked){locked=locked||{};attachRenamedIfExist(locked,tag,name,steps)}else if(tag.scriptExecuted<
0||tag.state>=LOWEST_FAIL_STATE){failed=failed||{};attachRenamedIfExist(failed,tag,name)}else if(tag.filtersState()===BaseFilter.state.SESSION||tag.filtersState()>0){filterReady=filterReady||{};attachRenamedIfExist(filterReady,tag,name,steps)}else if(tag.config.needsConsent){consent=consent||{};attachRenamedIfExist(consent,tag,name,steps)}else{other=other||{};attachRenamedIfExist(other,tag,name,steps)}}}return{run:runScripts,failed:failed,awaiting:filterReady,consent:consent,locked:locked,other:other}};
Container.prototype.allTagsFinished=function(){for(var i=0;i<this.tags.length;i++){var tag=this.tags[i];if(tag instanceof qubit.opentag.BaseTag){var state=tag.filtersState();if(!tag.config.disabled){var notFailedAndUnlocked=tag.filtersState()<0&&!tag.locked;var tagNotFinishedOrNotRunner=!(tag.finished()||tag.config.runner&&!tag.isRunning);if(notFailedAndUnlocked&&tagNotFinishedOrNotRunner){var isNotSession=state!==BaseFilter.state.SESSION;var doesWaitForDeps=+tag.awaitingDependencies>0;if(isNotSession&&
!doesWaitForDeps)return false}}}}return true};Container.prototype.getPageVariables=function(){var vars=[];for(var j=0;j<this.tags.length;j++){var tVars=this.tags[j].getPageVariables();for(var i=0;i<tVars.length;i++)Utils.addToArrayIfNotExist(vars,tVars[i])}return vars};Container.getPageVariableByName=function(name){var vars=this.getAllPageVariables();var rets=[];for(var i=0;i<vars.length;i++)if(vars[i].config.name===name)rets.push(vars[i]);return rets};var disableCookiePrefix="qubit.opentag.disableContainerRunning_";
var forceCookiePrefix="qubit.opentag.forceContainerRunning";Container.prototype._getCookieNameForDisabling=function(){return disableCookiePrefix+this.getContainerId()+this.config.name};Container.prototype.disabledByCookie=function(){return!!Cookie.get(this._getCookieNameForDisabling())};Container.prototype.setCookieToDisable=function(){Cookie.set(this._getCookieNameForDisabling(),"true")};Container.prototype.rmCookieToDisable=function(){Cookie.rm(this._getCookieNameForDisabling())};Container.rmAllDisablingCookies=
function(){Utils.rmCookiesMatching(disableCookiePrefix)};Container.setCookieForDisabledContainersToRun=function(){Cookie.set(forceCookiePrefix,"true")};Container.rmCookieForDisabledContainersToRun=function(){Cookie.rm(forceCookiePrefix)}})();(function(){function Main(){}function requestedDebugMode(){var isDebug=false;if(Cookie.get("opentag_debug")||document.location.href.indexOf("opentag_debug")>=0)isDebug=true;return isDebug}function requestedDebugTool(){var isDebug=false;if(Cookie.get("opentag_debug_tool")||
document.location.href.indexOf("opentag_debug_tool")>=0)isDebug=true;return isDebug}function disabled(){try{var fun=GLOBAL.TAGSDK_MAIN_DISABLED_FUNCTION;if(fun&&fun())return true}catch(ex){}if(document.location.href.indexOf("opentag_disabled\x3dtrue")>=0)return true;return false}function setIfUnset(object,property,value){if(value&&(object[property]===undefined||object[property]===""||object[property]===null))object[property]=value}function pruneContainerPackage(container){var name=container.PACKAGE_NAME.split(".");
name=name[name.length-1];var pkg=Utils.getParentObject(container.PACKAGE_NAME);pkg[name]=null;delete pkg[name]}function getClientId(container){var parent=Utils.getParentObject(container.PACKAGE_NAME);var cfg=parent.ClientConfig;if(cfg&&cfg.clientId)return cfg.clientId;else{var parts=container.PACKAGE_NAME.split(".");return parts[parts.length-2].substring(1)}}var Cookie=qubit.Cookie;var Utils=qubit.opentag.Utils;qubit.opentag.Log.setLevelFromCookie();Main.run=function(){var needDebugModeButNotInDebug=
false;if(disabled())return;var selfDebug=false;var debugToolRequested=requestedDebugTool();var debugRequested=debugToolRequested||requestedDebugMode();if(!selfDebug&&debugRequested){if(!qubit.DEBUG_MODE)GLOBAL.TAGSDK_NS_OVERRIDE=true;else GLOBAL.TAGSDK_NS_OVERRIDE=false;needDebugModeButNotInDebug=true}if(qubit.DEBUG_MODE)GLOBAL.TAGSDK_NS_OVERRIDE=false;try{q.html.UVListener.init()}catch(uvInitFalure){}Main.runAllContainers(needDebugModeButNotInDebug)};Main.runAllContainers=function(needDebugModeButNotInDebug){try{var containers=
qubit.opentag.Container.getContainers();for(var i=0;i<containers.length;i++){var container=containers[i];var contCfg=container.config;if(!container.runningStarted&&!container.configuredInMain){contCfg.scanTags=true;var clientConfig=Utils.getParentObject(container.PACKAGE_NAME).ClientConfig;if(clientConfig)setIfUnset(container.config,"clientId",clientConfig.id);var sysDefaults=Utils.getParentObject(container.PACKAGE_NAME).SystemDefaults;if(sysDefaults){setIfUnset(contCfg,"pingServerUrl",sysDefaults.pingServerUrl);
setIfUnset(contCfg,"tellLoadTimesProbability",sysDefaults.tellLoadTimesProbability)}container.configuredInMain=true;if(needDebugModeButNotInDebug){container.destroy(true);pruneContainerPackage(container);Main.loadDebugVersion(container)}else if(!GLOBAL.QUBIT_OPENTAG_STOP_MAIN_EXECUTION)container.run();else(function(){var runner=qubit.opentag.RUN_STOPPED_EXECUTON;qubit.opentag.RUN_STOPPED_EXECUTON=function(){try{if(runner)runner()}finally{container.run()}}})(container)}}}catch(ex){}};Main.loadDebugVersion=
function(container){var debugScript=document.createElement("script");var url;var scriptURL=container.config.scriptURL;var clientId=getClientId(container);var containerId=container.getContainerId();if(scriptURL){url=scriptURL;var dLen="-debug.js".length;if(url.lastIndexOf("-debug.js")!==url.length-dLen){url=url.substring(0,url.length-".js".length);url+="-debug.js"}}var urlCDN="//d3c3cq33003psk.cloudfront.net/opentag-"+clientId+"-"+containerId+"-debug.js";if(url&&urlCDN!==url)debugScript.src=url;else debugScript.src=
"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+clientId+"-"+containerId+"-debug.js";document.getElementsByTagName("head")[0].appendChild(debugScript)};qubit.Define.namespace("qubit.opentag.Main",Main)})()})()})();(function(){})();(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Current Domain"});var pkg="live.variables.CurrentDomain1";qubit.Define.clientNamespace(pkg,variable);variable.value='(function () {\n  return document.URL.split("/").slice(0,3)[2].split(".").slice(1).join(".");\n}())'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Referral - Global DeDupe"});var pkg="live.variables.CriteoReferralGlobalDeDupe";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n\n  var queryString \x3d function(a) {\n    for (var b \x3d {}, c \x3d a.split("?")[1] || "", d \x3d c.split("\x26"), e \x3d 0; e \x3c d.length; e++) {\n      var f \x3d d[e].split("\x3d");\n      if ("undefined" \x3d\x3d typeof b[f[0]]) b[f[0]] \x3d f[1];\n      else if ("string" \x3d\x3d typeof b[f[0]]) {\n        var g \x3d [b[f[0]], f[1]];\n        b[f[0]] \x3d g\n      } else b[f[0]].push(f[1])\n    }\n    return b\n  };\n\n  var entranceIndexContains \x3d function(str) {\n    for (var i \x3d window.qb_session.referrer.length - 1; i \x3e\x3d 0; i--) {\n      var qs \x3d queryString(window.qb_session.referrer[i].landing);\n      if (qs.utm_source) {\n        if (qs.utm_source \x3d\x3d str) {\n          return i;\n        } else {\n          return -1;\n        }\n      }\n    }\n    return -1;\n  };\n\n  if (window.qb_session \x26\x26 window.qb_session.referrer.length \x3e 1) {\n    if (entranceIndexContains("criteo") \x3e -1) {\n      window.universal_variable \x3d window.universal_variable || {};\n      universal_variable.events \x3d universal_variable.events || [];\n      universal_variable.events.push({\n        "category": "dedupe",\n        "action": "criteo_refereral",\n        "value": 1,\n        "landing": window.qb_session.referrer\n      });\n      return 1;\n    } else {\n      window.universal_variable \x3d window.universal_variable || {};\n      universal_variable.events \x3d universal_variable.events || [];\n      universal_variable.events.push({\n        "category": "dedupe",\n        "action": "criteo_refereral",\n        "value": 0,\n        "landing": window.qb_session.referrer\n      });\n      return 0;\n    }\n  } else {\n    return 0;\n  }\n})()'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(4)"});var pkg="live.variables.CriteoPartnerIDGLOBAL4";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"User ID","description":"The internal user identifier"});var pkg="live.variables.UserID";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.user.user_id"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"ConversionID(1)"});var pkg="live.variables.ConversionID1";qubit.Define.clientNamespace(pkg,variable);variable.value="(function(uv) {\nvar country\x3duv.user.country_code;\nvar conversionID\x3d'';\nswitch(country){\t\n\tcase 'BR':\n\t\tconversionID\x3d'982799572';\n\t\tbreak;\n    case 'AZ':\n    case 'KZ':\n    case 'UA':\n    case 'BY':\n    case 'LV':\n    case 'LT':\n    case 'GE':\n    case 'AM':\n\t\tconversionID\x3d'943389945';\n\t\tbreak;\n    case 'RU':\n\t\tconversionID\x3d'950200479';\n\t\tbreak;\n\tdefault:\n\t\tconversionID\x3d'1017014381';\n}\n  return conversionID;\n}(window.universal_variable))"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Returns if device is mobile, tablet or desktop"});var pkg="live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n\tvar windowInnerWidth \x3d window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n \n \t//desktop\n \tvar type \x3d "d";\n\n\tif(windowInnerWidth \x3c 767) {\n\t\t//mobile \x3c 767px\n\t\ttype \x3d "m";\n\t} else if(windowInnerWidth \x3e 767 \x26\x26 windowInnerWidth \x3c 1024) {\n\t\t//tablet - 767px -\x3e 1024px\n\t\ttype \x3d "t";\n\t}\n\n\treturn type;\n})()'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"PructSkuListString"});var pkg="live.variables.PructSkuListString";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(unv) {\n\n  if (unv !\x3d\x3d null \x26\x26 unv !\x3d\x3d undefined) {\n\tif (unv.transaction !\x3d\x3d null \x26\x26 unv.transaction !\x3d\x3d undefined) {\n      if (unv.transaction.line_items !\x3d\x3d null \x26\x26 unv.transaction.line_items !\x3d\x3d undefined) {\n        var list \x3d "";\n        if(unv.transaction.line_items.length \x3e 0){\n          \n          list +\x3d unv.transaction.line_items[0].product.id ;\n          for(var i \x3d 1; i \x3c unv.transaction.line_items.length; i ++)\n        \t{\n          \t\tlist +\x3d ","+ unv.transaction.line_items[i].product.id ;\n          \n        \t}\n       \t }\n\t\treturn list;\n      }\n    }\n  }\n\n  return "";\n\t\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID"});var pkg="live.variables.CriteoPartnerID";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Bloomreach AccountId"});var pkg="live.variables.BloomreachAccountId";qubit.Define.clientNamespace(pkg,variable);variable.value='function(){\n  switch(window.universal_variable.user.country_code){\n    case "US": return 5368;\n    case "GB": return 5369;\n    case "AU": return 5371;\n    case "CA": return 5370;\n    case "HK": return 5372;\n    case "NZ": return 5373;\n    default: return "";\n  }\n}'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"OrderTotalWithoutVAT"});var pkg="live.variables.OrderTotalWithoutVAT";qubit.Define.clientNamespace(pkg,variable);variable.value="function()\n{\n  //Calc the % of discount\n  var promoCode \x3d parseFloat(window.universal_variable.transaction.voucher_discount_gbp / window.universal_variable.transaction.total_gbp).toFixed(2);\n  \n  //If the % of dicount \x3e 1 (100%) then use 100%\n  if(promoCode \x3e 1)\n  {\n    promoCode \x3d 1;\n  }\n  \n  var totalPriceWithoutVat \x3d 0.0;\n  var items \x3d window.universal_variable.transaction.line_items;\n  for (var i \x3d0; i\x3c items.length; i++)\n  {\n    totalPriceWithoutVat +\x3d items[i].product.unit_base_price_eur;\n  }\n  \n  //Removing the promo code value from the total and round to two decimal places\n  totalPriceWithoutVat -\x3d totalPriceWithoutVat * promoCode;\n  totalPriceWithoutVat \x3d parseFloat(totalPriceWithoutVat).toFixed(2);\n  \n  return totalPriceWithoutVat;\n}"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":'Criteo Customer ID ("" if empty)'});var pkg="live.variables.CriteoCustomerIDIfEmpty";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv) { \n  if (typeof(uv.user.user_id) !\x3d\x3d "undefined") { \n    return uv.user.user_id;\n  } else { \n    return ""; \n  }\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"IsShippingAddressPage"});var pkg="live.variables.IsShippingAddressPage1";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("page") \x26\x26 uv.page.hasOwnProperty("pageStep") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d "shippingaddress")\n  {\n      return true;\n  }\n  else if (window.location.href.indexOf("shippingaddress.aspx") \x3e -1)\n  {\n    return true;\n  }\n  return false;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Billing Address - Country","description":"The country to which the invoice is to be dispatched"});var pkg="live.variables.TransactionBillingAddressCountry";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.billing.country"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Products Array"});var pkg="live.variables.ProductsArray";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(unv) {\n\n  if (unv !\x3d null \x26\x26 unv !\x3d undefined) {\n\tif (unv.transaction !\x3d null \x26\x26 unv.transaction !\x3d undefined) {\n      if (unv.transaction.line_items !\x3d null \x26\x26 unv.transaction.line_items !\x3d undefined) {\n        var list \x3d [];\n  \t\n        for(var i \x3d 0; i \x3c unv.transaction.line_items.length; i ++)\n        {\n          list.push("products[" + i + "][sku]\x3d" + unv.transaction.line_items[i].product.id);\n          list.push("products[" + i + "][price]\x3d" + unv.transaction.line_items[i].product.unit_sale_price);\n          list.push("products[" + i + "][quantity]\x3d" + unv.transaction.line_items[i].quantity);\n        }\n\t\n\t\treturn "\x26" + list.join("\x26");\n      }\n    }\n  }\n\n  return "";\n\t\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Billing Address - City","description":"The city to which the invoice is to be dispatched"});var pkg="live.variables.TransactionBillingAddressCity";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.billing.city"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)"});var pkg="live.variables.CriteoPartnerIDGLOBAL";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      case "UA": // Ukraine\n        result \x3d 23810;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Customer ID"});var pkg="live.variables.CustomerID";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv) { \n  if (typeof(uv.user.user_id) !\x3d\x3d "undefined") { \n    return uv.user.user_id;\n  } else { \n    return ""; \n  }\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.BaseVariable;var variable=new instance({"name":"Environment"});var pkg="live.variables.Environment";qubit.Define.clientNamespace(pkg,variable);variable.value="LIVE"})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Order Shipping Cost","description":"A valid number with the total amount of shipping costs included in the order"});var pkg="live.variables.TransactionOrderShippingCost";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.shipping_cost"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"FFLoggerList"});var pkg="live.variables.FFLoggerList";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n  var tagList \x3d [ \n    "Google Conversion Tracking",\n    "Linkshare - Transaction",\n    "Bluekai",\n    "console proxy test",\n    "Facebook - Basket",\n    "Adobe - Basket",\n    "Bloomreach - Add to Basket",\n    "Yandex RTB - Basket Updated",\n    "Criteo - Basket",\n    "Analytics - Basket",\n    "Bluekai - Wishlist and Basket",\n\t\t"Adobe Lens - Confirmation",\n\t\t"BI Pixel Tracking",\n\t\t"Certona - Confirmation",\n\t\t"Criteo - Confirmation",\n\t\t"DoubleClick Floodlight - Confirmation",\n\t\t"Facebook - Confirmation",\n\t\t"vIQ (Confirmation)",\n\t\t"Yahoo (JP) - Conversion",\n\t\t"Zanox - Confirmation (FR) (Global)",\n\t\t"Yandex RTB - Basket Updated",\n\t\t"Admitad - Confirmation Page (RU)",\n\t\t"Adobe Lens - Confirmation (RU)",\n\t\t"Top Mail MyTarget - Confirmation (RU)",\n\t\t"Yandex RTB - Confirmation Page (RU)",\n\t\t"vIQ ParFem",\n\t\t"Linkshare - Transaction - LogTemp"\n  ];\n  return tagList;\n}())'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Account Id"});var pkg="live.variables.CriteoAccountId";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.page.subfolder.replace("/", "").toUpperCase()) {\n      case "FR": // France\n        result \x3d 12271;\n        break;\n      case "DE": // Germany\n        result \x3d 12256;\n        break;\n      case "HK": // Hong Kong\n        result \x3d 12261;\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d 6612;\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d 12262;\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d 12260;\n\t\tbreak;\n      case "UK": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      case "UA": // Ukraine\n        result \x3d 23810;\n        break;\n      case "CN": // China\n        result \x3d 33858;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(3)"});var pkg="live.variables.CriteoPartnerIDGLOBAL3";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Line Items - Product Name List","description":"The name of the product that has been sold"});var pkg="live.variables.TransactionLineItemsProductNameList";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.line_items[#].product.name"})();
(function(){var instance=qubit.opentag.pagevariable.BaseVariable;var variable=new instance({"name":"Google Conversion ID"});var pkg="live.variables.GoogleConversionID";qubit.Define.clientNamespace(pkg,variable);variable.value="1017014381"})();(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"IsReviewOrderPage"});var pkg="live.variables.IsReviewOrderPage";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("page") \x26\x26 uv.page.hasOwnProperty("pageStep") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d "review")\n  {\n      return true;\n  }\n  else if (window.location.href.indexOf("revieworder.aspx") \x3e -1)\n  {\n    return true;\n  }\n  return false;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Site Type"});var pkg="live.variables.CriteoSiteType";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n  if (typeof(window.FFAPI) !\x3d\x3d "undefined" \x26\x26\n      typeof(window.FFAPI.variables) !\x3d\x3d "undefined") {\n    var vars \x3d window.FFAPI.variables;\n    if (vars.isMobile) {\n      if (vars.isiPad) {\n        return "t";\n      } else {\n        return "m";\n      }\n    } else {\n\t  return "d";\n    }\n  }\n}())'})();
(function(){var instance=qubit.opentag.pagevariable.BaseVariable;var variable=new instance({"name":"Conversion ID - ROW/US"});var pkg="live.variables.ConversionIDROWUS";qubit.Define.clientNamespace(pkg,variable);variable.value="1017014381"})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Line Items - Quantity List","description":"The number of units being sold"});var pkg="live.variables.TransactionLineItemsQuantityList";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.line_items[#].quantity"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(2)"});var pkg="live.variables.CriteoPartnerIDGLOBAL2";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"IsConfirmationPage"});var pkg="live.variables.IsConfirmationPage";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("page") \x26\x26 uv.page.hasOwnProperty("pageStep") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d "confirmation")\n  {\n      return true;\n  }\n  else if (window.location.href.indexOf("confirmationpage.aspx") \x3e -1)\n  {\n    return true;\n  }\n  return false;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Order Sub-Total","description":"A valid number with the total amount the order including tax per item, but not including shipping or discounts"});var pkg="live.variables.TransactionOrderSubTotal";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.subtotal"})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Order Id","description":"A unique identifier for the order"});var pkg="live.variables.TransactionOrderId";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.order_id"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Zanox Partner ID"});var pkg="live.variables.ZanoxPartnerID";qubit.Define.clientNamespace(pkg,variable);variable.value="(function() {\n  \tvar url \x3d window.location.href\n  \t\n  \tif(url.match(/\\/eu\\//i)){\n  \t  return 14882\n  \t} else if(url.match(/\\/es\\//i)){\n  \t  return 17105\n  \t} else {\n  \t  return 14883\n  \t}\n}())"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Site Type"});var pkg="live.variables.SiteType";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n  if (typeof(window.FFAPI) !\x3d\x3d "undefined" \x26\x26\n      typeof(window.FFAPI.variables) !\x3d\x3d "undefined") {\n    var vars \x3d window.FFAPI.variables;\n    if (vars.isMobile) {\n      if (vars.isiPad) {\n        return "t";\n      } else {\n        return "m";\n      }\n    } else {\n\t  return "d";\n    }\n  }\n}())'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Order Total","description":"A valid number with the total cost including tax, shipping and discounts"});var pkg="live.variables.TransactionOrderTotal";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.total"})();
(function(){var instance=qubit.opentag.pagevariable.BaseVariable;var variable=new instance({"name":"Conversion Label - ROW/US"});var pkg="live.variables.ConversionLabelROWUS";qubit.Define.clientNamespace(pkg,variable);variable.value="RFyDCLvkpgQQ7dD55AM"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Google Conversion Tracking Value"});var pkg="live.variables.GoogleConversionTrackingValue";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n    if(universal_variable.user.country_code.match("US|CA") !\x3d null){\n\t\treturn universal_variable.transaction.total_usd;\n\t}else{\n\t\treturn universal_variable.transaction.total_gbp;\n\t}\n})()'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Product ID","description":"An identifier for the item that is being viewed - this must be the same for items which differ only by colour or size"});var pkg="live.variables.ProductID";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.product.id"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(5)"});var pkg="live.variables.CriteoPartnerIDGLOBAL5";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Order Currency","description":"The standard letter code in captials for the currency type in which the order is being paid, eg EUR, USD, GBP"});var pkg="live.variables.TransactionOrderCurrency";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.currency"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Facebook Pixel ID"});var pkg="live.variables.FacebookPixelID";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var pixelId \x3d "0";\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "BR": // Brazil\n        pixelId \x3d "366191656882615";\n        break;\n      case "RU": //Russia\n        pixelId \x3d "1635172136719771";\n        break;\n      default:\n        pixelId \x3d "371589359697106";\n        break;\n    }\n  }\n  return pixelId;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.BaseVariable;var variable=new instance({"name":"Conversion ID"});var pkg="live.variables.ConversionID";qubit.Define.clientNamespace(pkg,variable);variable.value="1017014381"})();(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo List Keywords"});var pkg="live.variables.CriteoListKeywords";qubit.Define.clientNamespace(pkg,variable);variable.value='(function() {\n  if (typeof(window.universal_variable.page.category) !\x3d\x3d "undefined") {\n    return window.universal_variable.page.category;\n  } else if (typeof(window.universal_variable.page.search_term) !\x3d\x3d "undefined") {\n    return window.universal_variable.page.search_term;\n  } else {\n    return "";\n  }\n}())'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"IsPaymentPage"});var pkg="live.variables.IsPaymentPage";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("page") \x26\x26 uv.page.hasOwnProperty("pageStep") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d "payment")\n  {\n      return true;\n  }\n  else if (window.location.href.indexOf("payment.aspx") \x3e -1)\n  {\n    return true;\n  }\n  return false;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Order Total GBP"});var pkg="live.variables.OrderTotalGBP";qubit.Define.clientNamespace(pkg,variable);variable.value="window.universal_variable.transaction.total_gbp"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(6)"});var pkg="live.variables.CriteoPartnerIDGLOBAL6";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Transaction Product Price List (GLOBAL)"});var pkg="live.variables.CriteoTransactionProductPriceListGLOBAL";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(unv) {\n  var productList \x3d [];\n  if (unv !\x3d\x3d null \x26\x26 unv !\x3d\x3d undefined) {\n    var transaction \x3d unv.transaction,\n    \tuser \x3d unv.user;\n    if (transaction !\x3d\x3d null \x26\x26 transaction !\x3d\x3d undefined \x26\x26\n        user !\x3d\x3d null \x26\x26 user !\x3d\x3d undefined) {\n      var line_items \x3d transaction.line_items,\n          country_code \x3d user.country_code;\n      if (line_items !\x3d\x3d null \x26\x26 line_items !\x3d\x3d undefined \x26\x26\n          country_code !\x3d\x3d null \x26\x26 country_code !\x3d\x3d undefined) {\n        var price_field \x3d "unit_sale_price";\n        switch(unv.user.country_code) {\n          case "AE":\n          case "SA":\n          case "JP":\n          case "US":\n          case "CA":\n          case "KR":\n          case "SG":\n          case "HK":\n            price_field \x3d "unit_sale_price_usd";\n            break;\n          case "AU":\n            price_field \x3d "unit_sale_price_aud";\n            break;\n        }\n        for(var i \x3d 0; i \x3c line_items.length; i ++) {\n          productList.push(line_items[i].product[price_field]);\n        }\n      }\n    }\n  }\n  return productList;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.pagevariable.UniversalVariable;var variable=new instance({"uv":true,"name":"Transaction Line Items - Product ID List","description":"The identifier for the item that has been sold - this must be the same for items which differ only by colour or size"});var pkg="live.variables.TransactionLineItemsProductIDList";qubit.Define.clientNamespace(pkg,variable);variable.value="universal_variable.transaction.line_items[#].product.id"})();
(function(){var instance=qubit.opentag.pagevariable.Expression;var variable=new instance({"name":"Criteo Partner ID (GLOBAL)(1)"});var pkg="live.variables.CriteoPartnerIDGLOBAL1";qubit.Define.clientNamespace(pkg,variable);variable.value='(function(uv){\n  var result \x3d 0;\n  if (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty("user")) {\n    switch(uv.user.country_code) {\n      case "FR": // France\n        result \x3d "12271";\n        break;\n      case "DE": // Germany\n        result \x3d "12256";\n        break;\n      case "HK": // Hong Kong\n        result \x3d "12261";\n\t\tbreak;\n      case "JP": // Japan\n        result \x3d "6612";\n\t\tbreak;\n      case "KR": // South Korea\n        result \x3d "12262";\n\t\tbreak;\n      case "SG": // Singapore\n        result \x3d "12260";\n\t\tbreak;\n      case "GB": // Great Britain\n      case "IE": // Ireland\n        result \x3d 1843;\n\t\tbreak;\n      case "AU": // Australia\n        result \x3d 11502;\n\t\tbreak;\n      case "CA": // Canada\n        result \x3d 8955;\n\t\tbreak;\n      case "RU": // Russia\n        result \x3d 10921;\n\t\tbreak;\n      case "SA": // Saudi Arabia\n        result \x3d 11513;\n\t\tbreak;\n      case "TR": // Turkey\n        result \x3d 10922;\n\t\tbreak;\n      case "AE": // United Arab Emirates\n        result \x3d 11512;\n\t\tbreak;\n      case "US": // United States\n        result \x3d 7408;\n\t\tbreak;\n      case "BR": // Brazil\n        result \x3d 5051;\n        break;\n      default:\n        result \x3d 0;\n\t\tbreak;\n    }\n  }\n  return result;\n}(window.universal_variable))'})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Tapad Cookie does NOT exist"});var pkg="live.filters.TapadCookieDoesNOTExist";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var cookies=document.cookie;if(cookies!==null)return document.cookie.indexOf("TapadCookie_v2")<=0;return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Only product and Basket pages","priority":1});var pkg="live.filters.OnlyProductAndBasketPages1";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){if(window.universal_variable.page.pageId==="shoppingbagempty"||window.universal_variable.page.pageId==="basket"||window.universal_variable.page.pageId==="product"||window.universal_variable.page.pageId==="listing")cb()};filter.customScript=
function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Criteo countries","priority":1});var pkg="live.filters.CriteoCountries";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.user.country_code){case "FR":case "DE":case "HK":case "JP":case "KR":case "SG":case "AU":case "CA":case "GB":case "IE":case "SA":case "TR":case "AE":case "US":case "BR":case "RU":case "UA":return false;default:return true}};
filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Basket","priority":1});var pkg="live.filters.Basket1";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.type==="checkoutBasket"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Dedupe(2)","priority":1});var pkg="live.filters.Dedupe2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];if(!window.universal_variable.transaction)return false;var sendEvent=function(obj){window.universal_variable.events.push(obj);
window._qtd=window._qtd||[];window._qtd.push({resendUniversalVariables:1})};var statObj={};statObj.category="dedupe";statObj.order={};statObj.version=2;if(window.universal_variable.transaction.order_id)statObj.order.id=window.universal_variable.transaction.order_id;if(window.universal_variable.transaction.total)statObj.order.total=window.universal_variable.transaction.total;if(window.universal_variable.transaction.subtotal)statObj.order.subtotal=window.universal_variable.transaction.subtotal;if(window.universal_variable.transaction.currency)statObj.order.currency=
window.universal_variable.transaction.currency;statObj.rules={};if((session.referrer[session.referrer.length-1].landing.toLowerCase().indexOf("checkout/confirmationpage.aspx")>=0||window.universal_variable.transaction)&&session.referrer[session.referrer.length-1].url.toLowerCase().indexOf("direct")>=0){var poppedItem=session.referrer.pop();statObj.debug={};statObj.debug.poppedReferrer=true;statObj.debug.poppedObject=poppedItem}var config={affiliateName:"polyvore",affiliates:["shopstyle.com","polyvore.com",
"polyvore.com","lyst.com","shopstyle.co.uk","shopstyle.com.au","lyst.com","thebargainavenue.com.au","dealmoon.com","viglink.com","rewardStyle.com","shopstyle.fr","rewardStyle.com","shopstyle.ca","designerapparel.com","thefind.com","mybestbrands.de","Carteracommerce.com","polyvore.com","anycodes.com","asosfashionfinder.com","milanstyle.co.uk","lustrelife.com","shopandearn.com.au","shopstyle.com.au","indulgy.com","weluvny.com","styloko.com","purseblog.com","brandpad.ru","fashionstylist.com","skimlinks.com",
"tracdelight.com","bomoda.com","rewardStyle.com","skimlinks.com","iclployalty.com","rahi426.tumblr.com","sheerluxe.com","fashionsauce.com","dealam.com","drblogspot.blogspot.com","shopstyle.co.jp","shmoter.ru","dailymail.co.uk","starstyle.com","fashiola.co.uk","thefashion.com","fashionstylist.com","hiphunters.com","missstylish.co.uk","the-working-girl.com","bizrate.com","kaigaituhan.com","viglink.com","shoerazzi.com","drblogspot.blogspot.com","lwcloset.com","coolspotters.com","dailyfashiontips.co.uk/",
"skimlinks.com","listupp.com","setthat.com","whowhatwear.com","212madison.com","musestyle.comen","redcarpet-fashionawards.com","ministryoffashion.co.uk","fashionmoon.com","redcarpet-fashionawards.com","whowhatwear.com","lustrelife.com","lyst.com","deverser.blog.me","fashionbeans.com","viglink.com","thezoereport.com","upscalehype.com","dealthatworks.com/uk","aydele.blogspot.co.uk","ukoubei.com","pickyup.com","yieldkit.com","uk.rewardgateway.com","shopwiki.com","purseblog.com","dazhe.de/cn/","zigexn.co.jp/shopping",
"searchthesales.com","421shop.com","vollow.me","top10tastes.com","dmarge.com","honglingjin.co.uk","freschstyle.com","fashiontraffic.com","nextjump.co.uk","dmarge.com","confashions.blogspot.com","asap54.com","thefind.com","soletopia.com","nextjump.com","core8.com","keepitchic.com","bagthis.ch/","guamm.blogspot.com","laineygossip.comLifestyle","incentivenetworks.com","goskey.co.nz","upscalehype.com","stylematchshop.com","wanelo.com","go-shop-online.com","shopwiki.co.uk","veryverve.com","whats-he-wearing.com",
"nudevotion.com","thecoveteur.com","motilo.com","sandrascloset.com","shoerazzi.com","laiamagazine.com","popshops.com","spottedfashion.com","shoppe.clozette.co","shoptilyoudrop.com.au","theshoppingtrend.com","hausofrihanna.com","fashionising.com","FashionWhipped.com","hiphunters.com","stylezza.com","delukt.com","theviviennefiles.com","highsnobiety.com","WelkeKledingWinkels.nl","ador.com","fashiontoast.com","trendbee.com","thelilacpages.com","thezoereport.com","stylezeitgeist.com","rdujour.com","hiphunters.com",
"bloglic.commerchants/merchants-overview","shopcade.com","starstyle.com","minipopup.com"],checkReferrer:function(url){var found=false;for(var i=config.affiliates.length-1;i>=0;i--)if(url.toLowerCase().indexOf(config.affiliates[i].toLowerCase())>-1){found=true;statObj.affiliateDomain=config.affiliates[i].toLowerCase()}return found}};statObj.tag=config.affiliateName;if(session.referrer.length<2){statObj.rules.firstSession=true;statObj.tagFire=true;sendEvent(statObj);return true}if(config.checkReferrer(session.referrer[session.referrer.length-
2].url)===false){statObj.rules.affiliateNotPenultimateReferrer=true;statObj.tagFire=true;sendEvent(statObj);return true}var lastReferrer=session.referrer[session.referrer.length-1];var lastReferrerIsPPC=function(url){var fromPPC=false;if(url.indexOf("utm_medium\x3dcpc")>-1)fromPPC=true;if(url.indexOf("utm_medium\x3dppc")>-1)fromPPC=true;if(url.indexOf("gclid\x3d")>-1)fromPPC=true;if(url.indexOf("bfdqbt\x3d")>-1)fromPPC=true;if(url.indexOf("utm_medium\x3dpaid_search")>-1)fromPPC=true;return fromPPC}(lastReferrer.landing);
var lastReferrerIsSEO=function(){return/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(lastReferrer.url)}();var lastReferrerIsAnotherAffliate=function(url,affliate){return/.*utm_medium=(affiliates?).*/.test(url)&&lastReferrer.landing.indexOf(affliate)===-1}(lastReferrer.landing,config.affiliateName);var lastReferrerIsEmail=function(){return lastReferrer.landing.indexOf("utm_medium\x3demail")>-1}();statObj.rules.lastReferrerIsNotPPC=
!lastReferrerIsPPC;statObj.rules.lastReferrerIsNotSEO=!lastReferrerIsSEO;statObj.rules.lastReferrerIsNotAnotherAffliate=!lastReferrerIsAnotherAffliate;statObj.rules.lastReferrerIsNotEmail=!lastReferrerIsEmail;statObj.tagFire=!lastReferrerIsPPC&&!lastReferrerIsSEO&&!lastReferrerIsAnotherAffliate&&!lastReferrerIsEmail;sendEvent(statObj);return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Not in japan","priority":1});var pkg="live.filters.NotInJapan";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return!(window.universal_variable.user.country_code==="JP")};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Not Fire in China","priority":1});var pkg="live.filters.NotFireInChina";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.user.geoSubfolder==="/cn"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Product And Basket","priority":2});var pkg="live.filters.ProductAndBasket";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForUV=function(time){time=time||50;if(window.jQuery&&(window.universal_variable.page.pageId==="shoppingbagempty"||window.universal_variable.page.pageId==="basket"||window.universal_variable.page.pageId==="product"||window.universal_variable.page.pageId===
"listing"))cb();else setTimeout(function(){waitForUV(time*2)},time)};waitForUV()};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - FAQs","pattern":"/faqs"});var pkg="live.filters.CSFAQs";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Dedupe(3)","priority":1});var pkg="live.filters.Dedupe3";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){var statObj={category:"dedupe",order:{},version:2,mode:"live",rules:{},session:session};var config={affiliateName:"linkshare",affiliates:["www.stylight.com","www.stylight.co.uk","www.mybestbrands.de","www.lyst.com","www.shopstyle.co.uk",
"www.polyvore.com","www.rewardStyle.com","www.core8.com","www.skimlinks.com","rahilee.blog.me","www.milanstyle.com","www.shopstyle.de","www.nuji.com","www.lustrelife.com","indulgy.com","www.shopstyle.me","www.missstylish.co.uk","www.dailymail.co.uk","viglink.com","www.fashiola.co.uk","www.tracdelight.com","sneakerheaduk.com","www.sheerluxe.com","www.incentivenetworks.com","www.fashionsauce.co.uk","www.salesgossip.co.uk","www.shopstyle.com.au","www.fashionbeans.com","www.honglingjin.co.uk","www.whowhatwear.com",
"www.dazhe.de","www.styloko.com","fashionstylist.com","partners.rewardgateway.co.uk","www.asosfashionfinder.com","www.fashion-bubble.com","www.mrstyle.co","www.hiphunters.com","www.shopcade.com","www.purseblog.com","cafe.naver.com/rahilee","www.coolspotters.com","www.shareight.com","www.shoebidoo.com","www.threadsstyling.com","www.thesolesupplier.co.uk","www.mybestbrands.de","www.whowhatwear.co.uk","www.ukoubei.com","www.secondkulture.com","www.sendit.to","blog.naver.com/sohostreet_","www.stylonomy.co.uk",
"www.lwcloset.com","www.exclusiveone.com","www.nextjump.com","www.ibuyclub.com","www.bagthis.ch","www.styleproofed.com","www.redcarpet-fashionawards.com","www.giveasyoulive.com","www.thezoereport.com","www.styleflavors.com","www.thelilacpages.com","www.stylect.com","www.commeuncamion.com","intheircloset.com","www.snapfashion.co.uk","www.confashions.blogspot.com","www.shoplemonde.de","www.boopli.com","www.veryfirstto.com","weibo.com/dearcocoli","www.searchthesales.com","www.dmarge.com","www.nettementchic.com",
"www.knomi.com","www.pretaporter.xyz","focusonstyle.com","www.bagsessed.com","www.asap54.com","www.endource.com","www.upscalehype.com","nmrkt.com","www.highststyle.co.uk","blog.naver.com/newyorkblog","www.lovejeffreycampbell.com","www.celebritya.com","00o00.blogspot.com","www.wearingittoday.co.uk","www.shopstyle.fr","www.sandrascloset.com","www.loopos.co.uk","theviviennefiles.blogspot.com","www.cestclairette.com","bargainfairy.co.uk","maydele.blogspot.com","www.wardrobeicons.com","www.theshopally.com",
"www.theukhighstreet.com","www.shopstyle.com","www.ebates.com","www.dealmoon.com","www.weluvny.com/en","modesens.com","www.ebates.kr","www.Carteracommerce.com","www.dealam.com","www.mrrebates.com","www.bhg.com/shop","www.shopstyle.ca","www.55haitao.com","shmoter.ru","www.mifanli.com","tseniq.ru","www.iclployalty.com","www.ebates.ca","www.shoppit.co.kr","www.ebates.cn","brandpad.ru","yieldkit.com","www.starstyle.com","www.nextjump.com","www.snobessentials.com","cools.com","www.dazzled.com","deverser.blog.me",
"www.listupp.it","dealsea.com","www.82coupon.com","polnakorzina.ru","www.musexcarly.com","freschstyle.com","www.wanelo.com","wornontv.net","www.bizrate.com","www.buluanmai.com","www.spottedfashion.com","www.cindersescapism.com","www.stylezeitgeist.com","outfitsforlady.com","www.wantering.com","shoerazzi.com","navi-london.com","www.shoptagr.com","privatelysampled.com","arossgirl.com","www.lecatch.com","www.snapmeeselect.com","www.fashionmoon.com","www.designerapparel.com","styleheritage.com","trendy-u.ru",
"blog.naver.com/modena36","blog.naver.com/yj-style","blog.naver.com/leffe_brune","laviedupapillon.com","www.petit-swag.com","www.FashionWhipped.com","pickyup.com","www.justflyy.com","www.vacationstyle.com","www.waldorfsbazaar.net","www.vogue.com.cn","onlinebuyhk.blogspot.hk","www.bragmybag.com","www.missycoupons.com","derriuspierre.com","fashion-allure.com","www.wear2where.com","www.thecoveteur.com","www.shopstyle.cn","www.incentivenetworks.com","hitoutfit.com","blog.naver.com/elizaroom","www.fashiolista.com",
"yahoous.rewardgateway.com","www.instagram.com/MadelineRosene","www.palshock.com","www.promopro.com","www.duomai.com","www.thebargainavenue.com.au","www.xiyanghui.com","www.iclployalty.com","mastercardrewards.cn","vip.rewardgateway.com.au","mastercardrewards.hk","www.eshops.com.au","www.kaigai2han.com","www.smzdm.com","blog.naver.com/soyouplus","blog.naver.com/27dew","fashionlane.com.au","www.stylematchshop.com","blog.naver.com/freegun1019","www.online-shoppersstop.com","baekstage.com","www.finder.com.au/shopping",
"oystermag.com","www.shop.com","www.manqianmeng.com","www.windowswear.com","www.stylish365.com","www.foenix.co","www.shopstyle.co.jp","www.ana.co.jp/amc/reference/tameru/mileagemall","hapitas.jp","www.jal.co.jp/jmb/e-mile","www.kaigai-tsuhan-guide.com","point-g.rakuten.co.jp/mall","2nd-blog-cafe.sakura.ne.jp/wp","fanista.co.jp","japanlove.info","www.ninki-web.com","www.kaigaituhan.com","moraerumall.com","trendgakaeru.com","ranmaru8291.blog.so-net.ne.jp","www.skymilesshopping.jp","www.tsushin.tv",
"skinnymaster.info","blog.livedoor.jp/madamkemeko","www.modalina.jp","kaiba-shopping.com","ivornirony.net","fashionmagazine.jp","www.ecnavi.jp","www.mileageplusmall.jp","ameblo.jp/dailycelebritydiary2","spottster.com","www.catch-a-trend.com","www.modenova.com/de","fashionzones.xyz"],affiliates_jp:["shopstyle.co.jp","ana.co.jp","hapitas.jp","jal.co.jp","fanista.co.jp","blog.livedoor.jp","2nd-blog-cafe.sakura.ne.jp","ranmaru8291.blog.so-net.ne.jp"],voucher_starts:["m","r","re","rf","mm"],voucher_contains:["10m9",
"27mm","29mm","30mm","20mm","19mm","28mm","26mm","1610","10m1","18mm","12ff","12mm","24mm","25mm","22mm","14mm","17mm","23mm","15mm","13mm","21mm","mm50","m50m","mm10","mmff","10mm","mffm","m10m","FRIE","USmm","USRe"],checkReferrer:function(url){var found=false;if(window.universal_variable.user.country_code==="JP")config.affiliates=config.affiliates_jp;for(var i=config.affiliates.length-1;i>=0;i--)if(url.toLowerCase().indexOf(config.affiliates[i].toLowerCase())>-1){found=true;statObj.affiliateDomain=
config.affiliates[i].toLowerCase()}return found}};if(!window.universal_variable.transaction)return false;statObj.tag=config.affiliateName;var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj);window._qtd=window._qtd||[];window._qtd.push({resendUniversalVariables:1})};if(window.universal_variable.transaction.order_id)statObj.order.id=window.universal_variable.transaction.order_id;
if(window.universal_variable.transaction.total)statObj.order.total=window.universal_variable.transaction.total;if(window.universal_variable.transaction.subtotal)statObj.order.subtotal=window.universal_variable.transaction.subtotal;if(window.universal_variable.transaction.currency)statObj.order.currency=window.universal_variable.transaction.currency;statObj.debug={};if((session.referrer[session.referrer.length-1].landing.toLowerCase().indexOf("checkout/confirmationpage.aspx")>=0||window.universal_variable.transaction)&&
(session.referrer[session.referrer.length-1].url.toLowerCase().indexOf("direct")>=0&&!session.referrer[session.referrer.length-1].landing.match(/email/))){var poppedItem=session.referrer.pop();statObj.debug.poppedReferrer=true;statObj.debug.poppedObject=poppedItem}if(session.referrer.length<2){statObj.rules.firstSession=true;statObj.tagFire=true;sendEvent(statObj);return true}var affliateInReferrers=function(){var result=false;for(var i=1;i<session.referrer.length;i++)if(config.checkReferrer(session.referrer[i].url)!==
false)result=result||true;return result}();var matchesListedVoucher=function(){var result=false;if(!window.universal_variable.transaction.voucher){statObj.debug.voucher="none";return false}var voucher=window.universal_variable.transaction.voucher&&window.universal_variable.transaction.voucher.toLowerCase();statObj.debug.voucher=voucher;var length=config.voucher_contains.length>config.voucher_starts.length?config.voucher_contains.length:config.voucher_starts.length;for(var i=0;i<length;i++)if(config.voucher_starts[i]&&
voucher.indexOf(config.voucher_starts[i])===0){result=true;break}else if(config.voucher_contains[i]&&voucher.indexOf(config.voucher_contains[i])>-1){result=true;break}return result}();var lastReferrer=session.referrer[session.referrer.length-1];var lastReferrerIsPPCNonBrand=function(url$$0){var fromPPC=false;if(url$$0.indexOf("utm_medium\x3dcpc")>-1)fromPPC=true;if(url$$0.indexOf("utm_medium\x3dppc")>-1)fromPPC=true;if(url$$0.indexOf("gclid\x3d")>-1)fromPPC=true;if(url$$0.indexOf("bfdqbt\x3d")>-1)fromPPC=
true;if(url$$0.indexOf("utm_medium\x3dpaid_search")>-1)fromPPC=true;var isbrand=function(url){return url.indexOf("campaign\x3dbrand")>-1}(url$$0);return fromPPC&&!isbrand}(lastReferrer.landing.toLowerCase());var lastReferrerIsSEO=function(){return/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(lastReferrer.url)}();var lastReferrerIsAnotherAffliate=function(url,affliate){return/.*utm_medium=(aff?).*/.test(url)&&
lastReferrer.landing.toLowerCase().indexOf(affliate)===-1}(lastReferrer.landing,config.affiliateName);var lastReferrerIsEmailorDisplay=function(){return(lastReferrer.landing.toLowerCase().indexOf("utm_medium\x3demail")>-1||lastReferrer.landing.toLowerCase().indexOf("utm_medium\x3ddisplay")>-1)&&lastReferrer.landing.toLowerCase().indexOf("linkshare")===-1}();statObj.rules.lastReferrerIsNotPPCNonBrand=!lastReferrerIsPPCNonBrand;statObj.rules.lastReferrerIsNotSEO=!lastReferrerIsSEO;statObj.rules.lastReferrerIsNotAnotherAffliate=
!lastReferrerIsAnotherAffliate;statObj.rules.lastReferrerIsNotEmailorDisplay=!lastReferrerIsEmailorDisplay;statObj.rules.voucherIsNotListed=!matchesListedVoucher;statObj.tagFire=statObj.rules.lastReferrerIsNotPPCNonBrand&&statObj.rules.lastReferrerIsNotSEO&&statObj.rules.lastReferrerIsNotAnotherAffliate&&statObj.rules.lastReferrerIsNotEmailorDisplay&&statObj.rules.voucherIsNotListed;sendEvent(statObj);if(/\/br/.test(window.location.href))return true;else return statObj.tagFire};filter.lexicalPattern=
""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Homepage","priority":1});var pkg="live.filters.Homepage2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.type==="homepage"||window.location.href.indexOf("/shopping/women/items.aspx")>-1||window.location.href.indexOf("/shopping/men/items.aspx")>-1||window.location.href.indexOf("/shopping/kids/items.aspx")>-1};
filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Only User Account","pattern":".*/useraccount\\.aspx\\.*","patternType":"REGULAR_EXPRESSION","priority":1});var pkg="live.filters.OnlyUserAccount";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Sets","pattern":"/sets/","patternType":"CONTAINS","priority":3});var pkg="live.filters.Sets";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"IsIncomingTraffic"});var pkg="live.filters.IsIncomingTraffic";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=function(session){return!(new RegExp("^https://www.farfetch.com")).test(document.referrer)};filter.lexicalPattern='{"rows":[{"operators":[],"starters":[],"variables":[{"type":"pageReferrer","comparator":"6","value":"https://www.farfetch.com"}]}],"operators":[]}'})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Is Listing Or Basket Page Or Product Page","priority":2});var pkg="live.filters.IsListingOrBasketPageOrProductPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.pageId==="listing"||window.universal_variable.page.pageId==="product"||window.universal_variable.page.type==="checkoutBasket"};
filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Share Page","pattern":"/share","patternType":"REGULAR_EXPRESSION","priority":1});var pkg="live.filters.DefaultFilterMatchAll4";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"DeDupe","priority":1});var pkg="live.filters.DeDupe";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];if(!window.universal_variable.transaction)return;var sendEvent=function(obj){window.universal_variable.events.push(obj);
window._qtd=window._qtd||[];window._qtd.push({resendUniversalVariables:1})};var statObj={};statObj.category="dedupe";statObj.order={};if(window.universal_variable.transaction.order_id)statObj.order.id=window.universal_variable.transaction.order_id;if(window.universal_variable.transaction.total)statObj.order.total=window.universal_variable.transaction.total;if(window.universal_variable.transaction.subtotal)statObj.order.subtotal=window.universal_variable.transaction.subtotal;if(window.universal_variable.transaction.currency)statObj.order.currency=
window.universal_variable.transaction.currency;statObj.rules={};if(session.referrer[session.referrer.length-1].landing.toLowerCase().indexOf("checkout/confirmationpage.aspx")>=0&&session.referrer[session.referrer.length-1].url.toLowerCase().indexOf("direct")>=0){var poppedItem=session.referrer.pop();statObj.debug={};statObj.debug.poppedReferrer=true;statObj.debug.poppedObject=poppedItem}var config={affiliateName:"linkshare"};statObj.tag=config.affiliateName;if(session.referrer.length<2){statObj.rules.firstSession=
true;statObj.tagFire=true;sendEvent(statObj);return true}if(session.referrer[session.referrer.length-2].landing.indexOf(config.affiliateName)===-1){statObj.rules.affiliateNotPenultimateReferrer=true;statObj.tagFire=true;sendEvent(statObj);return true}var lastReferrer=session.referrer[session.referrer.length-1];var lastReferrerIsPPC=function(){if(/.*utm_medium=(cpc|ppc|sem|paid_search).*/.test(lastReferrer.landing)||/(?!.*[?&]utm_medium=).*[?&]gclid.*/.test(lastReferrer.landing))return true;else return false}();
var lastReferrerIsSEO=function(){return/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(lastReferrer.url)}();var lastReferrerIsAnotherAffliate=function(){return/.*utm_medium=(affiliates?).*/.test(lastReferrer.landing)&&lastReferrer.landing.indexOf(config.affiliateName)===-1}();var lastReferrerIsEmail=function(){return lastReferrer.landing.indexOf("utm_medium\x3demail")>-1}();statObj.rules.lastReferrerIsNotPPC=
!lastReferrerIsPPC;statObj.rules.lastReferrerIsNotSEO=!lastReferrerIsSEO;statObj.rules.lastReferrerIsNotAnotherAffliate=!lastReferrerIsAnotherAffliate;statObj.rules.lastReferrerIsNotEmail=!lastReferrerIsEmail;statObj.tagFire=!lastReferrerIsPPC&&!lastReferrerIsSEO&&!lastReferrerIsAnotherAffliate&&!lastReferrerIsEmail;sendEvent(statObj);return!lastReferrerIsPPC&&!lastReferrerIsSEO&&!lastReferrerIsAnotherAffliate&&!lastReferrerIsEmail};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude if not United States","priority":1});var pkg="live.filters.ExcludeIfNotUnitedStates";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.user.country_code!=="US"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Terms and Conditions","pattern":"/terms-and-conditions"});var pkg="live.filters.CSTermsAndConditions";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"ReviewOrder page","pattern":"revieworder.aspx","patternType":"ALL_URLS","priority":1});var pkg="live.filters.DefaultFilterMatchAll3";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.qb_session=session;cb(false)};filter.customScript=function(session){if(window.universal_variable!==undefined&&window.universal_variable.hasOwnProperty("page")&&window.universal_variable.page.hasOwnProperty("pageStep")&&
window.universal_variable.page.pageStep.toLowerCase()==="review")return true;else if(window.location.href.indexOf("revieworder.aspx")>-1)return true;return false};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"User Info Available"});var pkg="live.filters.UserInfoAvailable";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var poll=function(){if(window.universal_variable&&window.universal_variable.user)cb();else setTimeout(poll,250)};poll()};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Facebook_QUBIT_GTM"});var pkg="live.filters.FacebookQUBITGTM";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){if(window.Facebook_QUBIT_GTM&&window.Facebook_QUBIT_GTM=="GTM")return true;else{window.Facebook_QUBIT_GTM="QUBIT";return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Privacy and Cookie Policy","pattern":"/privacy-policy"});var pkg="live.filters.CSPrivacyAndCookiePolicy";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"ContactUs Confirm","pattern":"/pag1985.aspx?confirmation\x3dtrue","patternType":"ENDS_WITH"});var pkg="live.filters.ContactUsConfirm";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"People(1)","pattern":"people.aspx","patternType":"CONTAINS","priority":1});var pkg="live.filters.People1";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Landing Page kids","pattern":"shopping/kids/items.aspx"});var pkg="live.filters.LandingPageKids";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude If JP","pattern":"/jp/"});var pkg="live.filters.ExcludeIfJP";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Dedupe Admitad V2"});var pkg="live.filters.DedupeAdmitadV2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForRequire=function(timeout){timeout=timeout&&timeout*2||50;var qb=window.__qubit;var uv=window.universal_variable;if(qb&&qb.amd&&qb.amd.require&&uv&&uv.transaction&&uv.transaction.order_id)dedupe();else setTimeout(waitForRequire,timeout)};var dedupe=function(){window.__qubit.amd.require(["cookieman"],
function(cm){var cookieContent=cm.get("qb-landing-utm").length&&cm.get("qb-landing-utm")[0].value&&decodeURI(cm.get("qb-landing-utm")[0].value);var parseCookie=function(data){try{return data&&JSON.parse(data)||{}}catch(e){return{}}};var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj)};var statObj={name:"admitad",category:"dedupe",order:{id:window.universal_variable.transaction.order_id,
total:window.universal_variable.transaction.total,subtotal:window.universal_variable.transaction.subtotal,currency:window.universal_variable.transaction.currency},version:2,mode:"live",rules:{},session:session};var vouchers=["17","1610","10m1","10m9","10mm","12ff","12mm","13mm","14mm","15mm","RFCH","18mm","19mm","20mm","21mm","22mm","23mm","24mm","25mm","26mm","29mm","fr","FRIE","FRMM","jpmm","k-","m-","m10m","m50m","MELA","MeMe","MEN-","MEN_","Ment","mffm","mm","um","fmh","MMAP","MMBR","uf","28mm",
"30mm","brmm","CS","jpj","MMJU","new-","r-","f-","femm","FFES","fm-","fmfo","RRAL","rumm","SA","u-","USmm","USRe","km","hkm","27mm","ra","re-","REFA","REFE","refe","REFR","REKR","rf-","RF10","YKFG","LLHY","KRTY","VVDC","OUFR","FSTY","USWQ","PTYR","dsdw","puty","LARY"];var voucher=window.universal_variable.transaction.voucher||"";var voucherOK=true;var data$$0=parseCookie(cookieContent);statObj.voucher=voucher;statObj.rules.blockedByVoucher=false;for(var i=0;i<vouchers.length;i++)if(voucher.indexOf(vouchers[i])===
0){statObj.rules.blockedByVoucher=true;break}statObj.cookieData=data$$0;statObj.rules.blockThisSession=!!data$$0.blockThisSession;statObj.rules.blockedBy=data$$0.blockCause;statObj.rules.affiliateMatches=data$$0.affiliate===statObj.name;statObj.tagFire=!statObj.rules.blockThisSession&&statObj.rules.affiliateMatches&&!statObj.rules.blockedByVoucher||/\/br/.test(window.location.href);sendEvent(statObj);if(statObj.tagFire)cb()})};waitForRequire()};filter.customScript=function(session){return true};filter.lexicalPattern=
""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"All pages except product, listing, basket or confirmation page","priority":2});var pkg="live.filters.AllPagesExceptProductListingBasketOrConfirmationPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.pageId!=="product"&&window.universal_variable.page.pageId!=="listing"&&window.universal_variable.page.pageId!=="basket"&&
window.universal_variable.page.pageId!=="transaction"&&window.universal_variable.page.pageId!=="checkout"&&!window.universal_variable.transaction};filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Contact Us Page","pattern":"/pag1985.aspx#ContactUs"});var pkg="live.filters.ContactUsPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude ShareFF","pattern":"/shareff","patternType":"CONTAINS","priority":2});var pkg="live.filters.ExcludeShareFF";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Payment Page","pattern":"\\/checkout\\/payment\\.aspx","patternType":"ALL_URLS","priority":1});var pkg="live.filters.PaymentPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.qb_session=session;cb(false)};filter.customScript=function(session){if(window.universal_variable!==undefined&&window.universal_variable.hasOwnProperty("page")&&window.universal_variable.page.hasOwnProperty("pageStep")&&
window.universal_variable.page.pageStep.toLowerCase()==="payment")return true;else if(window.location.href.indexOf("payment.aspx")>-1)return true;return false};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Newsletter SignUp Thank You Page","pattern":"/Newsletter/SignUpThankYou","patternType":"CONTAINS"});var pkg="live.filters.NewsletterSignUpThankYouPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":'only if "dontshowqubiteucookie" cookie is not present and not on https',"priority":1});var pkg="live.filters.OnlyIfDontshowqubiteucookieCookieIsNotPresentAndNotOnHttps";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){if(document.cookie.indexOf("dontshowqubiteucookie")!==-1)return false;else return true};filter.lexicalPattern=
""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"UV pageId available"});var pkg="live.filters.UVPageIdAvailable";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var poll=function(){if(window.universal_variable&&window.universal_variable.page&&window.universal_variable.page.pageId&&window.universal_variable.user&&window.universal_variable.user.userSubfolder!==undefined)cb();else setTimeout(poll,250)};poll()};filter.customScript=function(session){return true};
filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Add To Basket And Wishlist Pages","priority":1});var pkg="live.filters.AddToBasketAndWishlistPages";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.pageId==="listing"||window.universal_variable.page.pageId==="product"||window.universal_variable.page.type==="checkoutBasket"};filter.lexicalPattern=
""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Include if Country Bloomreach","priority":1});var pkg="live.filters.IncludeIfCountryBloomreach";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.user.country_code){case "GB":case "US":case "AU":case "CA":case "HK":case "NZ":return true;default:return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"My Account","pattern":"useraccount.aspx","patternType":"CONTAINS","priority":1});var pkg="live.filters.MyAccount";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Dedupe(1)","priority":2});var pkg="live.filters.Dedupe1";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){var statObj={category:"dedupe",order:{},version:2,mode:"live",rules:{},session:session};var config={affiliateName:"zanox",affiliates:["www.stylight.com","www.stylight.co.uk","www.mybestbrands.de","modenova.com","listupp.it",
"www.modebasar.com","www.shopello.no","styletorch.com","www.watchmyhippo.dk","www.sellektor.com","www.stylectapp.com","www.stylectapp.com","www.collagevintage.com","www.thelabelfinder.nl","www.louiseadolphson.se","www.shotnshop.com","www.rewardstyle.com","monstyle.nl","www.cirqle.nl","www.shoppingscanner.co.uk","www.rewardstyle.com","www.cirqle.nl","www.luxurytrends.club","www.cuponesmagicos.com","www.storetip.com","www.fashionlab.nl","www.sneakersnob.de","fashion-square-shopping.de","www.miarmarioenruinas.com",
"www.yourtopstores.com","ibplustore.iberia.com","www.skoteket.se","addictedtofashion.net","www.5candiesaweek.com","www.spot-a-shop.fi","www.kleding.nl","www.fashiola.de","www.fashiola.de","www.ummust.com","www.digidip.net","leadhaber.com","www.fashion-db.nl","whimed.com/trends","www.fasha.nl","www.footmall.se","whatstylewant.com","newlimits.es","www.menwithballs.pl","fotograf-leipzig.blogspot.de","www.combyneapp.com","stiliusos.lt","shoppable.nl","katrineberner.dk","www.theslctd.com","www.revendless.com",
"www.themandiary.com","www.skimlinks.com","www.shopstyle.fr","fr.flayr.com","www.stylonomy.fr","www.meschaussures.fr","www.skimlinks.com","www.fashiola.fr","www.lebarboteur.com","www.bloghln.com","televisionstyle.com","www.thebeautyandthegeek.fr","www.marieluvpink.com","www.befashionlike.net","asap54.com","asap54.com","mevio.fr","www.befashionlike.net","neeed.com","www.shopcade.com","www.shoppingscanner.co.uk","www.unmec.fr","skonh-blog.com","borasification.blogspot.fr","www.lookstar.fr"],affiliates_jp:["shopstyle.co.jp",
"ana.co.jp","hapitas.jp","jal.co.jp","fanista.co.jp","blog.livedoor.jp","2nd-blog-cafe.sakura.ne.jp","ranmaru8291.blog.so-net.ne.jp"],voucher_starts:["m","r","re","rf","mm"],voucher_contains:["10m9","27mm","29mm","30mm","20mm","19mm","28mm","26mm","1610","10m1","18mm","12ff","12mm","24mm","25mm","22mm","14mm","17mm","23mm","15mm","13mm","21mm","mm50","m50m","mm10","mmff","10mm","mffm","m10m","FRIE","USmm","USRe"],checkReferrer:function(url){var found=false;for(var i=config.affiliates.length-1;i>=
0;i--)if(url.toLowerCase().indexOf(config.affiliates[i].toLowerCase())>-1){found=true;statObj.affiliateDomain=config.affiliates[i].toLowerCase()}return found}};if(!window.universal_variable.transaction)return false;statObj.tag=config.affiliateName;var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj);window._qtd=window._qtd||[];window._qtd.push({resendUniversalVariables:1})};
if(window.universal_variable.transaction.order_id)statObj.order.id=window.universal_variable.transaction.order_id;if(window.universal_variable.transaction.total)statObj.order.total=window.universal_variable.transaction.total;if(window.universal_variable.transaction.subtotal)statObj.order.subtotal=window.universal_variable.transaction.subtotal;if(window.universal_variable.transaction.currency)statObj.order.currency=window.universal_variable.transaction.currency;if(window.universal_variable.transaction.voucher)statObj.order.voucher=
window.universal_variable.transaction.voucher;statObj.debug={};if(session.referrer[session.referrer.length-1].landing.toLowerCase().indexOf("checkout/confirmationpage.aspx")>=0&&(session.referrer[session.referrer.length-1].url.toLowerCase().indexOf("direct")>=0&&!session.referrer[session.referrer.length-1].landing.match(/email/))){var poppedItem=session.referrer.pop();statObj.debug.poppedReferrer=true;statObj.debug.poppedObject=poppedItem}if(session.referrer.length<2){statObj.rules.firstSession=true;
statObj.tagFire=true;sendEvent(statObj);return true}var affliateInReferrers=function(){var result=false;for(var i=session.referrer.length-2;i>0;i--)if(config.checkReferrer(session.referrer[i].url)!==false)result=true;return result}();var matchesListedVoucher=function(){var result=false;if(!window.universal_variable.transaction.voucher)return false;var voucher=window.universal_variable.transaction.voucher.toLowerCase();statObj.debug.voucher=voucher;var length=config.voucher_contains.length>config.voucher_starts.length?
config.voucher_contains.length:config.voucher_starts.length;for(var i=0;i<length;i++)if(config.voucher_starts[i]&&voucher.indexOf(config.voucher_starts[i])===0){result=true;break}else if(config.voucher_contains[i]&&voucher.indexOf(config.voucher_contains[i])>-1){result=true;break}return result}();var lastReferrer=session.referrer[session.referrer.length-1];var lastReferrerIsPPCNonBrand=function(url$$0){var fromPPC=false;if(url$$0.indexOf("utm_medium\x3dcpc")>-1)fromPPC=true;if(url$$0.indexOf("utm_medium\x3dppc")>
-1)fromPPC=true;if(url$$0.indexOf("gclid\x3d")>-1)fromPPC=true;if(url$$0.indexOf("bfdqbt\x3d")>-1)fromPPC=true;if(url$$0.indexOf("utm_medium\x3dpaid_search")>-1)fromPPC=true;var isbrand=function(url){return url.toLowerCase().indexOf("campaign\x3dbrand")>-1}(url$$0);return fromPPC&&!isbrand}(lastReferrer.landing.toLowerCase());var lastReferrerIsSEO=function(){return/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(lastReferrer.url)}();
var lastReferrerIsAnotherAffliate=function(url,affliate){return/.*utm_medium=(affiliates?).*/.test(url)&&lastReferrer.landing.indexOf(affliate)===-1}(lastReferrer.landing,config.affiliateName);var lastReferrerIsEmailorDisplay=function(){return(lastReferrer.landing.toLowerCase().indexOf("utm_medium\x3demail")>-1||lastReferrer.landing.toLowerCase().indexOf("utm_medium\x3ddisplay")>-1)&&lastReferrer.landing.toLowerCase().indexOf("linkshare")===-1}();statObj.rules.lastReferrerIsNotPPCNonBrand=!lastReferrerIsPPCNonBrand;
statObj.rules.lastReferrerIsNotSEO=!lastReferrerIsSEO;statObj.rules.lastReferrerIsNotAnotherAffliate=!lastReferrerIsAnotherAffliate;statObj.rules.lastReferrerIsNotEmailorDisplay=!lastReferrerIsEmailorDisplay;statObj.rules.voucherIsNotListed=!matchesListedVoucher;statObj.tagFire=statObj.rules.lastReferrerIsNotPPCNonBrand&&statObj.rules.lastReferrerIsNotSEO&&statObj.rules.lastReferrerIsNotAnotherAffliate&&statObj.rules.lastReferrerIsNotEmailorDisplay&&statObj.rules.voucherIsNotListed;sendEvent(statObj);
if(/\/br/.test(window.location.href))return true;else return statObj.tagFire};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Is Confirmation Page and UV Transaction Exists","priority":1});var pkg="live.filters.IsConfirmationPageAndUVTransactionExists";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForUV=function(time){time=time||50;var uv=window.universal_variable;if(uv&&uv.transaction)cb();else setTimeout(function(){waitForUV(time*2)},time)};waitForUV()};filter.customScript=function(session){if(window.location.href.indexOf("/checkout/confirmationpage.aspx")>
-1||window.universal_variable.transaction)return true};filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Listing Page","priority":1});var pkg="live.filters.ListingPage2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.pageId==="listing"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"YahooJP_QUBIT_GTM"});var pkg="live.filters.YahooJPQUBITGTM";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(){if(window.YahooJP_QUBIT_GTM=="GTM")return true;window.YahooJP_QUBIT_GTM="QUBIT";return false};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"EU","priority":1});var pkg="live.filters.EU";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var valInArray=function(val,thearray){var inArray=false;for(var i=0;i<thearray.length;i++)if(thearray[i]===val)inArray=true;return inArray};var euCountries=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","EL","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO",
"SK","SI","ES","SE","GB"];var clientId="farfetch";var cookieId=document.cookie.match(/_qubitTracker=([0-9.]+);/);if(cookieId&&!!cookieId[1])cookieId=cookieId[1];else cookieId="";var getGeo=function(callback){if(document.cookie.indexOf("_qubitCountry")>-1){var countryCookie=document.cookie.match(/_qubitCountry=([A-Z.]+);*/);callback(countryCookie[1])}else{var callbackName="__qubitIPCallBack";window[callbackName]=function(data){var domain=qubit.opentag.pagevariable.BaseVariable.pageVariables.filter(function(x){return x.CLASSPATH.indexOf("CurrentDomain")>
0})[0].currentValue;var date=new Date;date.setTime(date.getTime()+30*24*60*60*1E3);document.cookie="_qubitCountry\x3d"+data.geo.country+";path\x3d/;expire\x3d"+date.toGMTString()+";domain\x3d"+domain+";secure";callback(data.geo.country)};var script=document.createElement("script");script.src="//orca.qubitproducts.com/ns?cid\x3d"+cookieId+"\x26id\x3dfarfetch\x26callback\x3d"+callbackName;document.getElementsByTagName("head")[0].appendChild(script)}};getGeo(function(country){if(valInArray(country,euCountries))cb()})};
filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude If Not Linkshare Order"});var pkg="live.filters.LinkshareOrder";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;return!(uv&&uv.transaction&&uv.transaction.linkshare_destination_currency&&uv.transaction.linkshare_affiliate_mid&&uv.transaction.linkshare_date&&uv.transaction.linkshare_site_id)};
filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"HasDefinedDuplicatedCookies"});var pkg="live.filters.HasDefinedDuplicatedCookies";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){function canWorkWithLocalStorage(){var testToken="storageToken";try{var localStorage=window.localStorage;if(typeof localStorage==="object")try{localStorage.setItem(testToken,testToken);localStorage.getItem(testToken);
localStorage.removeItem(testToken)}catch(e){return false}}catch(e){return false}return true}function isDuplicatedCookie(cookieName){var name=cookieName+"\x3d";var splitCookies=document.cookie.split(";");var cookieCounter=0;var i=0;for(var len=splitCookies.length;i<len&&cookieCounter<2;i++){for(var cookie=splitCookies[i];cookie.charAt(0)===" ";)cookie=cookie.substring(1);if(cookie.indexOf(name)===0)cookieCounter++}return cookieCounter>1}var cookieList=["_qsst_s","_qst_s","_qubitCountry"];var result=
false;var canWriteOnLocalStorage=canWorkWithLocalStorage();var alreadyCleanedCookies=false;var alreadyCleanedCookiesToken="cookiesCleaned";if(canWriteOnLocalStorage)if(localStorage.getItem(alreadyCleanedCookiesToken)!=="true")localStorage.setItem(alreadyCleanedCookiesToken,"true");else alreadyCleanedCookies=true;var i$$0=0;for(var len$$0=cookieList.length;i$$0<len$$0&&!result&&!alreadyCleanedCookies;i$$0++)result=isDuplicatedCookie(cookieList[i$$0]);return result};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Returns and Refunds","pattern":"/returns-and-refunds"});var pkg="live.filters.CSReturnsAndRefunds";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude If Not Criteo Country","priority":1});var pkg="live.filters.ExcludeIfNotCriteoCountry";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.page.subfolder.replace("/","").toUpperCase()){case "FR":case "DE":case "HK":case "JP":case "KR":case "SG":case "AU":case "CA":case "UK":case "IE":case "SA":case "TR":case "AE":case "":case "BR":case "RU":case "UA":case "CN":return false;
default:return true}};filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Product Page","priority":1});var pkg="live.filters.ProductPage2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.pageId==="product"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Include If User Zoom Country","priority":1});var pkg="live.filters.ExcludeIfNotUserZoomCountry";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.user.country_code){case "DE":return true;default:return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Landing page men","pattern":"shopping/men/items.aspx","patternType":"CONTAINS","priority":2});var pkg="live.filters.LandingPageMen";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Detect","priority":1});var pkg="live.filters.Detect";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var poll=function(){if(window.jQuery&&window.jQuery("#productItemDesc").length>0)cb();else setTimeout(poll,250)};poll()};filter.customScript=function(session){if(window.universal_variable.page.pageId!="product")return false;var are_cookies_enabled=function(){var cookieEnabled=
navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=document.cookie.indexOf("testcookie")!=-1?true:false}return cookieEnabled};var isSafari=function(){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("safari")!=-1)if(ua.indexOf("chrome")>-1)return false;else return true;else return false};if(window.location.href.indexOf("qbttest")>-1)return true;return false};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude country BR","priority":1});var pkg="live.filters.ExcludeCountryBR";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.page.subfolder){case "/br":return true;default:return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude if not Japan","priority":1});var pkg="live.filters.ExcludeIfNotJapan";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){if(window.universal_variable&&window.universal_variable.user&&window.universal_variable.user.country_code&&window.universal_variable.user.country_code!=="JP")return true;else return false};filter.lexicalPattern=
""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Home OR Landing","priority":1});var pkg="live.filters.HomeORLanding";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.type==="landing"||window.universal_variable.page.type==="homepage"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"UV UniversalVariableLoaded Event"});var pkg="live.filters.UVUniversalVariableLoadedEvent";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){if(!window.__initialStatePDP_content__){cb(false);return}if(!window.uvLoadedFired)window.events.on("uvLoaded",function(){cb(false)});else cb(false)};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude If BR","pattern":"/br/","patternType":"CONTAINS","priority":2});var pkg="live.filters.ExcludeIfBR";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Wait for require \x26 has no ff referrer","patternType":"ALL_URLS"});var pkg="live.filters.WaitForRequireHasNoFfReferrer";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){function waitForRequire(timeout){timeout=timeout&&timeout*2||50;var qb=window.__qubit;if(qb&&qb.amd&&qb.amd.require)cb();else setTimeout(waitForRequire,timeout)}waitForRequire()};filter.customScript=function(session){return true};
filter.lexicalPattern=""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var pkg="live.filters.DefaultFilterMatchAll";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Criteo - Is Qubit Enabled"});var pkg="live.filters.CriteoIsQubitEnabled";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){if(window.Criteo_QUBIT_GTM=="GTM")return true;else{window.Criteo_QUBIT_GTM="QUBIT";return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Dedupe(4)","priority":1});var pkg="live.filters.Dedupe4";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];if(!window.universal_variable.transaction)return false;var sendEvent=function(obj){window.universal_variable.events.push(obj);
window._qtd=window._qtd||[];window._qtd.push({resendUniversalVariables:1})};var statObj={};statObj.category="dedupe";statObj.order={};statObj.version=2.1;if(window.universal_variable.transaction.order_id)statObj.order.id=window.universal_variable.transaction.order_id;if(window.universal_variable.transaction.total)statObj.order.total=window.universal_variable.transaction.total;if(window.universal_variable.transaction.subtotal)statObj.order.subtotal=window.universal_variable.transaction.subtotal;if(window.universal_variable.transaction.currency)statObj.order.currency=
window.universal_variable.transaction.currency;statObj.rules={};if((session.referrer[session.referrer.length-1].landing.toLowerCase().indexOf("checkout/confirmationpage.aspx")>=0||window.universal_variable.transaction)&&session.referrer[session.referrer.length-1].url.toLowerCase().indexOf("direct")>=0){var poppedItem=session.referrer.pop();statObj.debug={};statObj.debug.poppedReferrer=true;statObj.debug.poppedObject=poppedItem}var config={affiliateName:"linkshare",affiliates:["shopstyle.com","polyvore.com",
"lyst.com","shopstyle.co.uk","shopstyle.com.au","lyst.com","thebargainavenue.com.au","dealmoon.com/","viglink.com","rewardStyle.com","shopstyle.fr","rewardStyle.com","shopstyle.ca","designerapparel.com","thefind.com","mybestbrands.de/","Carteracommerce.com","polyvore.com","anycodes.com","asosfashionfinder.com","milanstyle.co.uk/","lustrelife.com","shopandearn.com.au/","shopstyle.com.au","indulgy.com","weluvny.com/en/","styloko.com/","purseblog.com/","brandpad.ru","fashionstylist.com","skimlinks.com",
"tracdelight.com/","bomoda.com","rewardStyle.com","skimlinks.com","iclployalty.com","rahi426.tumblr.com/","sheerluxe.com/","fashionsauce.com/","dealam.com","drblogspot.blogspot.com","shopstyle.co.jp/","shmoter.ru"," dailymail.co.uk/","starstyle.com","fashiola.co.uk/","thefashion.com","fashionstylist.com","hiphunters.com","missstylish.co.uk/","the-working-girl.com/","bizrate.com","kaigaituhan.com/","viglink.com","shoerazzi.com","drblogspot.blogspot.com","lwcloset.com/","coolspotters.com","dailyfashiontips.co.uk/",
"skimlinks.com","listupp.com","setthat.com/","whowhatwear.com","212madison.com","musestyle.com/en","redcarpet-fashionawards.com","ministryoffashion.co.uk/","fashionmoon.com","redcarpet-fashionawards.com","whowhatwear.com","lustrelife.com","lyst.com","deverser.blog.me/","fashionbeans.com/","viglink.com","thezoereport.com","upscalehype.com","dealthatworks.com/uk/","maydele.blogspot.co.uk/","ukoubei.com/","pickyup.com","yieldkit.com","uk.rewardgateway.com/","shopwiki.com","purseblog.com/","dazhe.de/cn/",
"zigexn.co.jp/shopping","searchthesales.com/","421shop.com/","vollow.me/","top10tastes.com/","dmarge.com","honglingjin.co.uk/","freschstyle.com","fashiontraffic.com","nextjump.co.uk/","dmarge.com","confashions.blogspot.com","asap54.com","thefind.com","soletopia.com","nextjump.com","core8.com/","keepitchic.com","bagthis.ch/","guamm.blogspot.com","laineygossip.com/Lifestyle","incentivenetworks.com","goskey.co.nz","upscalehype.com","stylematchshop.com","wanelo.com","go-shop-online.com","shopwiki.co.uk/",
"veryverve.com/","whats-he-wearing.com/","nudevotion.com","thecoveteur.com","motilo.com","sandrascloset.com","shoerazzi.com","laiamagazine.com","popshops.com","spottedfashion.com/","shoppe.clozette.co/","shoptilyoudrop.com.au/","theshoppingtrend.com","hausofrihanna.com","fashionising.com","FashionWhipped.com","hiphunters.com","stylezza.com/","delukt.com/","theviviennefiles.com/","highsnobiety.com/","WelkeKledingWinkels.nl","ador.com/","fashiontoast.com","trendbee.com","thelilacpages.com/","thezoereport.com",
"stylezeitgeist.com","rdujour.com","hiphunters.com","bloglic.com/merchants/merchants-overview/","shopcade.com","starstyle.com","minipopup.com"],checkReferrer:function(url){var found=false;for(var i=config.affiliates.length-1;i>=0;i--)if(url.toLowerCase().indexOf(config.affiliates[i].toLowerCase())>-1){found=true;statObj.affiliateDomain=config.affiliates[i].toLowerCase()}return found}};statObj.tag=config.affiliateName;if(session.referrer.length<2){statObj.rules.firstSession=true;statObj.tagFire=true;
sendEvent(statObj);return true}if(config.checkReferrer(session.referrer[session.referrer.length-2].url)===false){statObj.rules.affiliateNotPenultimateReferrer=true;statObj.tagFire=true;sendEvent(statObj);return true}var lastReferrer=session.referrer[session.referrer.length-1];var lastReferrerIsPPC=function(url){var fromPPC=false;if(url.indexOf("utm_medium\x3dcpc")>-1)fromPPC=true;if(url.indexOf("utm_medium\x3dppc")>-1)fromPPC=true;if(url.indexOf("gclid\x3d")>-1)fromPPC=true;if(url.indexOf("bfdqbt\x3d")>
-1)fromPPC=true;if(url.indexOf("utm_medium\x3dpaid_search")>-1)fromPPC=true;return fromPPC}(lastReferrer.landing);var lastReferrerIsSEO=function(){return/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(lastReferrer.url)}();var lastReferrerIsAnotherAffliate=function(url,affliate){return/.*utm_medium=(affiliates?).*/.test(url)&&lastReferrer.landing.indexOf(affliate)===-1}(lastReferrer.landing,config.affiliateName);
var lastReferrerIsEmail=function(){return lastReferrer.landing.indexOf("utm_medium\x3demail")>-1}();statObj.rules.lastReferrerIsNotPPC=!lastReferrerIsPPC;statObj.rules.lastReferrerIsNotSEO=!lastReferrerIsSEO;statObj.rules.lastReferrerIsNotAnotherAffliate=!lastReferrerIsAnotherAffliate;statObj.rules.lastReferrerIsNotEmail=!lastReferrerIsEmail;statObj.tagFire=!lastReferrerIsPPC&&!lastReferrerIsSEO&&!lastReferrerIsAnotherAffliate&&!lastReferrerIsEmail;sendEvent(statObj);return statObj.tagFire};filter.lexicalPattern=
""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"People","pattern":"/people(/|$)","patternType":"REGULAR_EXPRESSION","priority":2});var pkg="live.filters.People";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Orders and Shipping","pattern":"/orders-and-shipping"});var pkg="live.filters.CSOrdersAndShipping";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"convideamigos","pattern":"convideamigos.aspx","patternType":"REGULAR_EXPRESSION","priority":1});var pkg="live.filters.Convideamigos";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"IN Subfolders CN or HK","priority":1});var pkg="live.filters.INSubfoldersCNOrHK";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.user!==undefined&&window.universal_variable.user.country_code!==undefined&&(window.universal_variable.user.country_code=="CN"||window.universal_variable.user.country_code==
"HK")};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Dedupe Performance Horizon V2"});var pkg="live.filters.DedupePerformanceHorizonV2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForRequire=function(timeout){timeout=timeout&&timeout*2||50;var qb=window.__qubit;var uv=window.universal_variable;if(qb&&qb.amd&&qb.amd.require&&uv&&uv.transaction&&uv.transaction.order_id)dedupe();else setTimeout(waitForRequire,timeout)};var dedupe=
function(){window.__qubit.amd.require(["cookieman"],function(cm){var cookieContent=cm.get("qb-landing-utm").length&&cm.get("qb-landing-utm")[0].value&&decodeURI(cm.get("qb-landing-utm")[0].value);var parseCookie=function(data){try{return data&&JSON.parse(data)||{}}catch(e){return{}}};var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj)};var statObj={name:"performancehorizon",
category:"dedupe",order:{id:window.universal_variable.transaction.order_id,total:window.universal_variable.transaction.total,subtotal:window.universal_variable.transaction.subtotal,currency:window.universal_variable.transaction.currency},version:2,mode:"live",rules:{},session:session};var vouchers=["jpy1","17","1610","10m1","10m9","10mm","12ff","12mm","13mm","14mm","15mm","RFCH","18mm","19mm","20mm","21mm","22mm","23mm","24mm","25mm","26mm","29mm","fr","FRIE","FRMM","jpmm","k-","m-","m10m","m50m",
"MELA","MeMe","MEN-","MEN_","Ment","mffm","mm","um","fmh","MMAP","MMBR","uf","28mm","30mm","brmm","CS","jpj","MMJU","new-","r-","f-","femm","FFES","fm-","fmfo","RRAL","rumm","SA","u-","USmm","USRe","km","hkm","27mm","ra","re-","REFA","REFE","refe","REFR","REKR","rf-","RF10","ukf","tf","mo","hkt","sgt","ru","ed","fc","uk","kw","n","est","brr","uko","jpt","del","glo","ruu","rfs-","ku-","hm-","ufs-","ktp-","kte-","rtp-","jk-","sdf-","kff-","kfw-","hmf-","YKFG","LLHY","KRTY","VVDC","OUFR","FSTY","USWQ",
"PTYR","dsdw","puty","LARY"];var voucher=window.universal_variable.transaction.voucher||"";var voucherOK=true;var data$$0=parseCookie(cookieContent);statObj.voucher=voucher;statObj.rules.blockedByVoucher=false;for(var i=0;i<vouchers.length;i++)if(voucher.indexOf(vouchers[i])===0){statObj.rules.blockedByVoucher=true;break}statObj.cookieData=data$$0;statObj.rules.blockThisSession=!!data$$0.blockThisSession;statObj.rules.blockedBy=data$$0.blockCause;statObj.rules.affiliateMatches=statObj.name===data$$0.affiliate;
statObj.tagFire=!statObj.rules.blockThisSession&&statObj.rules.affiliateMatches&&!statObj.rules.blockedByVoucher||/\/br/.test(window.location.href);sendEvent(statObj);if(statObj.tagFire)cb()})};waitForRequire()};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"First Checkout Pages","pattern":"(\\/checkout\\/shippingaddress\\.aspx|\\/checkout\\/Checkout\\/Guest)","patternType":"ALL_URLS","priority":1});var pkg="live.filters.FirstCheckoutPages";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.qb_session=session;cb(false)};filter.customScript=function(session){if(window.universal_variable!==undefined&&window.universal_variable.hasOwnProperty("page")&&
window.universal_variable.page.hasOwnProperty("pageStep")&&window.universal_variable.page.pageStep.toLowerCase()==="shippingaddress")return true;else if(window.location.href.indexOf("shippingaddress.aspx")>-1||window.location.href.indexOf("GuestUser/Guest")>-1)return true;return false};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"exclude searchPages","pattern":"items.aspx?q\x3d","patternType":"CONTAINS","priority":2});var pkg="live.filters.ExcludeSearchPages";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Homepage, Product, Confirmation \x26 Basket","priority":1});var pkg="live.filters.HomepageListingProductConfirmationBasket";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.page.pageId){case "homepage":case "geral":case "product":case "basket":case "checkout":case "transaction":return true}return false};
filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Holiday Need To Know","pattern":"/holiday-need-to-know"});var pkg="live.filters.CSHolidayNeedToKnow";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Gift Page","pattern":"","patternType":"ALL_URLS","priority":1});var pkg="live.filters.GiftPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.qb_session=session;cb(false)};filter.customScript=function(session){return document.location.href.indexOf("womens-gifts")>0||document.location.href.indexOf("mens-gifts")>0};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Landing Homepage","priority":1});var pkg="live.filters.LandingHomepage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.location.href.indexOf("/shopping/women/items.aspx")>-1||window.location.href.indexOf("/shopping/men/items.aspx")>-1||window.location.href.indexOf("/shopping/kids/items.aspx")>-1};filter.lexicalPattern=
""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var pkg="live.filters.DefaultFilterMatchAll17";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Shopping Cart","pattern":"checkout/basket.aspx","patternType":"CONTAINS","priority":1});var pkg="live.filters.ShoppingCart";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Landing Page women","pattern":"shopping/women/items.aspx","patternType":"CONTAINS","priority":1});var pkg="live.filters.LandingPageWomen";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Error page","priority":1});var pkg="live.filters.ErrorPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return $("[data-tstid\x3d'PageNotFound_404']").length==1};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude landing pages","pattern":"/shopping/(wo)?(men)?(kids)?/items.aspx","patternType":"REGULAR_EXPRESSION","priority":1});var pkg="live.filters.ExcludeLandingPages";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Search pages","pattern":"items.aspx?q\x3d","patternType":"CONTAINS","priority":1});var pkg="live.filters.SearchPages";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"MentionMe_QUBIT_GTM"});var pkg="live.filters.MentionMeQUBITGTM";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){if(window.MentionMe_QUBIT_GTM&&window.MentionMe_QUBIT_GTM=="GTM")return true;else{window.MentionMe_QUBIT_GTM="QUBIT";return false}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Confirmation page","pattern":"\\/checkout\\/confirmationpage\\.aspx|dedupe-test","patternType":"ALL_URLS","priority":1});var pkg="live.filters.ConfirmationPage1";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.qb_session=session;cb(false)};filter.customScript=function(session){return window.universal_variable&&window.universal_variable.transaction||window.location.href.match(/dedupe-test/)};
filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Not in this rtb country list","priority":1});var pkg="live.filters.NotInThisRtbCountryList";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){switch(window.universal_variable.user.country_code){case "HK":case "JP":case "AU":case "RU":case "US":return false;default:return true}};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Click \x26 Collect","pattern":"/click-and-collect"});var pkg="live.filters.CSClickAndCollect";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - Contact Us","pattern":"/contact-us"});var pkg="live.filters.CSContactUS";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Dedupe Zanox V2"});var pkg="live.filters.DedupeZanoxV2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForRequire=function(timeout){timeout=timeout&&timeout*2||50;var qb=window.__qubit;var uv=window.universal_variable;if(qb&&qb.amd&&qb.amd.require&&uv&&uv.transaction&&uv.transaction.order_id)dedupe();else setTimeout(waitForRequire,timeout)};var dedupe=function(){window.__qubit.amd.require(["cookieman"],
function(cm){var cookieContent=cm.get("qb-landing-utm").length&&cm.get("qb-landing-utm")[0].value&&decodeURI(cm.get("qb-landing-utm")[0].value);var parseCookie=function(data){try{return data&&JSON.parse(data)||{}}catch(e){return{}}};var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj)};var statObj={name:"zanox",category:"dedupe",order:{id:window.universal_variable.transaction.order_id,
total:window.universal_variable.transaction.total,subtotal:window.universal_variable.transaction.subtotal,currency:window.universal_variable.transaction.currency},version:2,mode:"live",rules:{},session:session};var vouchers=["17","1610","10m1","10m9","10mm","12ff","12mm","13mm","14mm","15mm","RFCH","18mm","19mm","20mm","21mm","22mm","23mm","24mm","25mm","26mm","29mm","fr","FRIE","FRMM","jpmm","k-","m-","m10m","m50m","MELA","MeMe","MEN-","MEN_","Ment","mffm","mm","um","fmh","MMAP","MMBR","uf","28mm",
"30mm","brmm","CS","jpj","MMJU","new-","r-","f-","femm","FFES","fm-","fmfo","RRAL","rumm","SA","u-","USmm","USRe","km","hkm","27mm","ra","re-","REFA","REFE","refe","REFR","REKR","rf-","RF10","ukf","tf","mo","hkt","sgt","ru","ed","fc","uk","kw","n","YKFG","LLHY","KRTY","VVDC","OUFR","FSTY","USWQ","PTYR","dsdw","puty","LARY"];var voucher=window.universal_variable.transaction.voucher||"";var voucherOK=true;var data$$0=parseCookie(cookieContent);statObj.voucher=voucher;statObj.rules.blockedByVoucher=
false;for(var i=0;i<vouchers.length;i++)if(voucher.indexOf(vouchers[i])===0){statObj.rules.blockedByVoucher=true;break}statObj.cookieData=data$$0;statObj.rules.blockThisSession=!!data$$0.blockThisSession;statObj.rules.blockedBy=data$$0.blockCause;statObj.rules.affiliateMatches=data$$0.affiliate===statObj.name;statObj.tagFire=!statObj.rules.blockThisSession&&statObj.rules.affiliateMatches&&!statObj.rules.blockedByVoucher||/\/br/.test(window.location.href);sendEvent(statObj);if(statObj.tagFire)cb()})};
waitForRequire()};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Dedupe Linkshare V2"});var pkg="live.filters.DedupeV2";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){var waitForRequire=function(timeout){timeout=timeout&&timeout*2||50;var qb=window.__qubit;var uv=window.universal_variable;if(qb&&qb.amd&&qb.amd.require&&uv&&uv.transaction&&uv.transaction.order_id)dedupe();else setTimeout(waitForRequire,timeout)};var dedupe=function(){window.__qubit.amd.require(["cookieman"],
function(cm){var cookieContent=cm.get("qb-landing-utm").length&&cm.get("qb-landing-utm")[0].value&&decodeURI(cm.get("qb-landing-utm")[0].value);var parseCookie=function(data){try{return data&&JSON.parse(data)||{}}catch(e){return{}}};var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||[];window.universal_variable.events.push(obj)};var statObj={name:"linkshare",category:"dedupe",order:{id:window.universal_variable.transaction.order_id,
total:window.universal_variable.transaction.total,subtotal:window.universal_variable.transaction.subtotal,currency:window.universal_variable.transaction.currency},version:2,mode:"live",rules:{},session:session};var vouchers=["jpy1","17","1610","10m1","10m9","10mm","12ff","12mm","13mm","14mm","15mm","RFCH","18mm","19mm","20mm","21mm","22mm","23mm","24mm","25mm","26mm","29mm","fr","FRIE","FRMM","jpmm","k-","m-","m10m","m50m","MELA","MeMe","MEN-","MEN_","Ment","mffm","mm","um","fmh","MMAP","MMBR","uf",
"28mm","30mm","brmm","CS","jpj","MMJU","new-","r-","f-","femm","FFES","fm-","fmfo","RRAL","rumm","SA","u-","USmm","USRe","km","hkm","27mm","ra","re-","REFA","REFE","refe","REFR","REKR","rf-","RF10","ukf","tf","mo","hkt","sgt","ru","ed","fc","uk","kw","n","est","brr","uko","jpt","del","glo","ruu","rfs-","ku-","hm-","ufs-","ktp-","kte-","rtp-","jk-","sdf-","kff-","kfw-","hmf-","17mm","CS_2","CS_3","CS_M","CSME","mm10","mm50","mmff","mmn","jpf","ust","roe","ukt","skt","jpy","rub","brf","brt","enr","fsr",
"frt","det","cht","ukfo","rfs","ku","hm","ufs","ktp","kte","rtp","jk","sdf","kff","kfw","hmf","au","fr10","uk10","ru10","cn10","go10","es40","de40","br10","hm10","HVE","HVN","LVE","LVN","tf","mo","ukf","YKFG","LLHY","KRTY","VVDC","OUFR","FSTY","USWQ","PTYR","dsdw","puty","LARY"];var voucher=window.universal_variable.transaction.voucher||"";var voucherOK=true;var data$$0=parseCookie(cookieContent);statObj.voucher=voucher;statObj.rules.blockedByVoucher=false;for(var i=0;i<vouchers.length;i++)if(voucher.indexOf(vouchers[i])===
0){statObj.rules.blockedByVoucher=true;break}statObj.cookieData=data$$0;statObj.rules.blockThisSession=!!data$$0.blockThisSession;statObj.rules.blockedBy=data$$0.blockCause;statObj.rules.affiliateMatches=data$$0.affiliate===statObj.name;statObj.tagFire=!statObj.rules.blockThisSession&&statObj.rules.affiliateMatches&&!statObj.rules.blockedByVoucher||/\/br/.test(window.location.href);sendEvent(statObj);if(statObj.tagFire)cb()})};waitForRequire()};filter.customScript=function(session){return true};filter.lexicalPattern=
""})();(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"uv_mapper_qprotocol","priority":1});var pkg="live.filters.Uv_mapper_qprotocol";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){return session.getCookie("uv_mapper_qprotocol")||""};filter.lexicalPattern='{\n    "rows": [{\n        "variables": [{\n            "type": "cookie",\n            "comparator": "0",\n            "value": [\n                "uv_mapper_qprotocol",\n                ""\n            ]\n        }],\n        "starters": [],\n        "operators": []\n    }],\n    "operators": []\n}'})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"refer-a-friend","pattern":"refer-a-friend","patternType":"REGULAR_EXPRESSION","priority":2});var pkg="live.filters.ReferAFriend";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Exclude if RU","pattern":"/ru/","patternType":"CONTAINS","priority":1});var pkg="live.filters.ExcludeIfRU";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Is PDP Slice Page"});var pkg="live.filters.IsPDPSlicePage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.__initialStatePDP_content__!==undefined};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"CS - How to Shop","pattern":"/how-to-shop"});var pkg="live.filters.CSHowToShop";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb(false)};filter.customScript=function(session){var uv=window.universal_variable;if(uv&&uv.page)if(uv.page.subfolder===""||uv.page.subfolder=="/ru"||uv.page.subfolder=="/uk")return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Define __qubitCriteoVariant","priority":1});var pkg="live.filters.Define__qubitCriteoVariant";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Define __qubitRemarketingVariant","priority":1});var pkg="live.filters.Define__qubitRemarketingVariant";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){window.__qubitRemarketingVariant=function(){cb()}};filter.customScript=function(session){return true};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"name":"Login Page","pattern":"/login.aspx"});var pkg="live.filters.LoginPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=null;filter.customScript=null;filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Landing Page","priority":2});var pkg="live.filters.LandingPage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.universal_variable.page.type==="landing"};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":true,"name":"Is Debug mode","priority":1});var pkg="live.filters.IsDebugMode";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return document.cookie.indexOf("opentag_debug_tool")!==-1||/opentag_debug/i.test(window.location.href)};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.filter.Filter;var filter=new instance({"include":false,"name":"Is Not PDP Slice Page"});var pkg="live.filters.IsNotPDPSlicePage";qubit.Define.clientNamespace(pkg,filter);filter.customStarter=function(session,cb){cb()};filter.customScript=function(session){return window.__initialStatePDP_content__===undefined};filter.lexicalPattern=""})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"DoubleClick Floodlight - All Pages","disabled":true});var pkg="live.tags.doubleclickfloodlightallpages.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nvar uv \x3d window.universal_variable;\nvar axel \x3d Math.random() + \"\";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement(\"iframe\");\n\nvar category \x3d \"\", subCategory \x3d \"\";\n\nif(uv.page.category){\n  category \x3d uv.page.category;\n  if(uv.page.breadcrumb \x26\x26 uv.page.breadcrumb.length \x3e 3){\n    category \x3d uv.page.breadcrumb[2];\n    subCategory \x3d uv.page.category;\n  }\n}else if(uv.product){\n  category \x3d uv.product.category;\n}\n\nfl_if.src\x3d'https://5490350.fls.doubleclick.net/activityi;src\x3d5490350;type\x3dpagev0;cat\x3dfarfe0'+\n\t\t';u1\x3d'+ (uv.listing \x26\x26 uv.listing.Designername ? uv.listing.Designername : \"NA\") + //[designer_name]\n\t\t';u2\x3d'+ (category ? category : \"NA\") + //[category]\n\t\t';u3\x3d'+ (subCategory ? subCategory : \"NA\") + //[sub_category]\n\t\t';u4\x3d'+ (uv.product \x26\x26 uv.product.id ? uv.product.id : \"NA\") + //[product_id]\n\t\t';u5\x3d'+ (uv.product \x26\x26 uv.product.name ? uv.product.name : \"NA\") + //[product_name]\n\t\t';u6\x3d'+ (uv.page.currency) + //[currency]\n\t\t';u7\x3d'+ (uv.product \x26\x26 uv.product.color ? uv.product.color : \"NA\") + //[color]\n\t\t';u8\x3d'+ (uv.product \x26\x26 uv.product.department ? uv.product.department : \"NA\") + //[department]\n\t\t';u9\x3d'+ (uv.product \x26\x26 uv.product.stock ? uv.product.stock : \"NA\") + //[total_stock]\n\t\t';u10\x3d'+ (uv.product \x26\x26 uv.product.unit_price ? uv.product.unit_price : \"NA\") + //[unit_price]\n\t\t';u11\x3d'+ (uv.product \x26\x26 uv.product.unit_sale_price ? uv.product.unit_sale_price : \"NA\") + //[unit_sale_price]\n\t\t';u12\x3d'+ (uv.page.contextGenderId) + //[contextGenderId]\n\t\t';u13\x3d'+ (uv.user.basketId) + //[basketId]\n\t\t';u14\x3d'+ (uv.product \x26\x26 uv.product.storeId ? uv.product.storeId : \"NA\") + //[storeId]\n\t\t';u15\x3d'+ (uv.basket \x26\x26 uv.basket.total ? uv.basket.total : \"NA\") + //[basket_total]\n\t\t';u16\x3d'+ (uv.user.user_id ? uv.user.user_id : \"\") + //[userid]\n\t\t';u17\x3d'+ (uv.user.language) + //[language]\n\t\t';u18\x3d'+ (uv.user.country_code) + //[country]\n\t\t';u19\x3d'+ (uv.user.just_registered) + //[just_registered]\n\t\t';u20\x3d'+ (uv.page.subfolder) + //[subfolder]\n\t\t';dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d' + a + '?';\nfl_if.width\x3d\"1\";\nfl_if.height\x3d\"1\";\nfl_if.frameborder\x3d\"0\";\nfl_if.style.display \x3d \"none\";\ndocument.body.appendChild(fl_if);\n\x3c/script\x3e";
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "Filipe Freitas",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"[PDP] Adobe - Basket","disabled":true,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.pdpadobebasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry {\n    var page \x3d window.universal_variable.page;\n\n    if (page.pageId \x3d\x3d\x3d \"product\") {\n         $('button[data-trk\x3daddToBag]').on('click',function(){\n            adobeAddToBasket('BagUpdated', window.universal_variable.product);\n        });\n    } else {\n        $(document).bind(\"BagUpdated\", function(evt, product) {\n            adobeAddToBasket('BagUpdated', product);\n        });\n    }\n\n    function adobeAddToBasket(eventType, product) {\n      try {\n        if (product !\x3d\x3d undefined) {\n          var s \x3d document.createElement(\"img\"),\n              adobe_code \x3d '3517';\n  \n          switch (page.subfolder) {\n              case '/br':\n                  adobe_code \x3d '3670';\n                  break;\n          }\n  \n          s.src \x3d 'https://pixel.everesttech.net/' + adobe_code + '/t?ev_add_to_basket\x3d1';\n          s.style.width \x3d '1px';\n          s.style.height \x3d '1px';\n          s.style.display \x3d 'none'\n          $(\"body\").append(s);\n  \n          ffLogger.tagLogger('Adobe - Basket', {adobe_code:adobe_code}, ffLogger.LogLevelEnum.INFO);\n        }\n      }\n      catch (e) {\n        ffLogger.tagLogger(\"Adobe - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n      }\n    }  \n}\ncatch (e)\n{\n   ffLogger.tagLogger(\"Adobe - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.ProductAndBasket","live.filters.ExcludeIfRU","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Certona - Capture Emails","disabled":false,"id":35687002,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.certonacaptureemails.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js" \x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e \n  var resx \x3d { }; \n  resx.appid \x3d "Farfetch01";\n  (function(w, uv, $, api) {\n    var callCertona \x3d function(email, returnUrl) {\n      resx.customerid \x3d email; \n      var url \x3d certonaResx.getURL(); \n      $.ajax({\n        url: url,\n        dataType: \'jsonp\',\n        jsonp : \'jsonp\',\n        timeout: 10000,\n        complete: function() {\n          if (event.timeout) {\n            clearTimeout(event.timeout);\n          }\n          if (returnUrl !\x3d\x3d undefined) {\n            if (returnUrl !\x3d\x3d \'\') {\n              window.location.href \x3d returnUrl;\n            } else {\n              window.location.reload();\n            }\n          }\n        }\n      });\n    };\n    $(document).bind("FF_MailSignUpEvent", function(event) {\n      callCertona(event.email, event.returnUrl);\n    });\n    if (uv.user \x26\x26 uv.user.just_registered \x26\x26 uv.user.hashedSHA256Email) {\n      callCertona(uv.user.hashedSHA256Email);\n    }\n    var location \x3d w.location.href;\n    if (location.indexOf("signup.aspx") !\x3d\x3d -1 \x26\x26 location.indexOf("email\x3d") !\x3d\x3d -1) {\n      callCertona(api.methods.getUrlVars().email);\n    }\n  }(window, window.universal_variable, window.jQuery, window.FFAPI));\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Product","disabled":false,"id":35686755,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.certonaproduct.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e \nvar resx \x3d {};\nresx.appid \x3d "Farfetch01";\nif (window.universal_variable.user.isLogged) {\n    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email; // ADD WHENEVER AVAILABLE, LEAVE BLANK OTHERWISE\n} else {\n    resx.customerid \x3d "";\n}\nvar itemId \x3d window.universal_variable.product.id;\nvar genderId \x3d window.universal_variable.page.contextGenderId;\nvar countryId \x3d window.universal_variable.user.country_id;\nvar categoryId \x3d window.universal_variable.product.categoryId;\nvar storeId \x3d window.universal_variable.product.storeId;\nvar designerName \x3d window.universal_variable.product.designerName;\nvar department \x3d window.universal_variable.product.department;\nresx.rrec \x3d true;\nresx.event \x3d "product";\nresx.rrelem \x3d "product_rr;";\nresx.itemid \x3d itemId;\nresx.rrnum \x3d "10;";\nresx.rrqs \x3d {\n    countryid: countryId,\n    genderid: genderId,\n    categoryid: categoryId,\n    storeid: storeId,\n    designername: designerName,\n    department: department\n};\nif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n    resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n}\nresx.rrqs \x3d $.param(resx.rrqs);\nvar url \x3d certonaResx.getURL();\n$.ajax({\n    url: url,\n    dataType: \'jsonp\',\n    jsonp: \'jsonp\',\n    timeout: 10000,\n    success: function (response) {\n        $(document).data("recommendations", response);\n    },\n    error: function () {\n        $(document).data("recommendations", false);\n    }\n});\n\x3c/script\x3e';
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleproductpage.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Rebuild Transaction UV","disabled":false,"id":36229983,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.rebuildtransactionuv.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n  var uv \x3d window.universal_variable,\n      tuv \x3d uv.transaction,\n      small_tuv \x3d {};\n  \n  small_tuv.order_id     \x3d tuv.order_id;\n  if (typeof tuv.delivery !\x3d\x3d "undefined") {\n    small_tuv.int_order_id \x3d tuv.delivery.int_order_id;\n  }\n  small_tuv.total \t     \x3d tuv.total;\n  small_tuv.total_gbp    \x3d tuv.total_gbp;\n  small_tuv.currency \t \x3d tuv.currency;\n  \n  uv.transaction \x3d small_tuv;\n  \n  window._qtd \x3d window._qtd || [];\n  window._qtd.push({\n    resendUniversalVariables: 1\n  });\n  \n  uv.transaction \x3d tuv;\n  \n  window._qtd.push({\n    resendUniversalVariables: 1\n  });\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.IsConfirmationPageAndUVTransactionExists"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.qubitqtrackernew.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Adobe - Subscribe Newsletter","disabled":true,"id":35687213,"locked":false,
"locationObject":"HEAD"});var pkg="live.tags.adobesubscribenewsletter.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript language\x3d\"javascript\"\x3e\n  $(document).on('subscribedEmail',function(){\n    var s \x3d document.createElement(\"img\"),\n    \tadobe_code \x3d '3517';\n    \n    switch(window.universal_variable.page.subfolder){\n      case '/br':\n        adobe_code \x3d '3670';\n        break;\n    }\n    s.src\x3d'https://pixel.everesttech.net/' + adobe_code + '/t?ev_email_signup\x3d1';   \n    s.style.width\x3d '1px';\n    s.style.height\x3d '1px';   \n    document.body.append(s);\n  });\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfBR","live.filters.ExcludeIfRU"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"MediaForge (JP)","disabled":false,"id":35686899,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.mediaforgejp.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n// Use any event to append the code\n$(document).ready(function() \n{\n    var s \x3d document.createElement("script");\n  \ts.type \x3d "text/javascript";\n \t  var merchantId \x3d "1565";\n  \tvar baseUrl \x3d "https://tags.mediaforge.com/js/" + merchantId + "/";\n     \n  \tswitch(universal_variable.page.pageId){\n      case "product":\n        s.src \x3d baseUrl + "?" + $.param({"prodID" : universal_variable.product.id});    \n        break;\n      case "listing":\n        s.src \x3d baseUrl + "?" + $.param({"catID" : universal_variable.listing.categoryId});    \n        break;\n      case "basket":\n        var lineItems \x3d  universal_variable.basket.line_items;\n\t\tvar itemsIds \x3d [];\n\t\tfor(var i \x3d 0; i\x3c lineItems.length; i++) {\n\t\t\t\titemsIds.push(universal_variable.basket.line_items[i].product.id);\n\t\t\t}\n        s.src \x3d baseUrl + "?" + $.param({"cart" : universal_variable.basket.subtotal,\n                                  "prodID":itemsIds.join(",")                        \n                                  });    \n        break;\n      case "transaction":\n        s.src \x3d baseUrl + "?" + $.param({"orderNumber" : window.universal_variable.transaction.order_id,\n                                   "price" : window.universal_variable.transaction.subtotal});    \n        break;\n      default:\n        s.src \x3d baseUrl;  \n        break;\n      }\n  \tdocument.body.appendChild(s);\n});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfNotJapan"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Google Universal Analytics - Add To WishList","disabled":false,"id":35687473,"locked":false,"locationObject":"BODY"});var pkg="live.tags.googleuniversalanalyticsaddtowishlist.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  $(document).bind(\"WishListUpdated\", function(evt, product){\n    if(product !\x3d\x3d undefined){\n    \tga('send', 'event', 'product actions', 'add to wishlist', product.name, product.id);\n    }\n  });\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.OnlyProductAndBasketPages1","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"FFLogger","disabled":false});var pkg="live.tags.fflogger.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n    /**********************************************************************************************************************************\n    *     o.OOOo.    .oOOOo.   .oOOOo.  o.OOoOoo                                                                                      *\n    *     O    `o  .O     o. .O     o   O                                                                                             *\n    *     o      O O       o o          o                                                                                             *\n    *     O      o o       O O          ooOO                                                                                          *\n    *     o      O O       o O   .oOOo  O                                                                                             *\n    *     O      o o       O o.      O  o                                                                                             *\n    *     o    .O\' `o     O\'  O.    oO  O                                                                                             *\n    *     OooOO\'    `OoooO\'    `OooO\'  ooOooOoO                                                                                       *\n    *                                                                                                                                 *\n    *                ) _ _ __/\u00b0\u00b0\u00ac                                                                                                     *\n    *                                                                                                                                 *\n    * Tag/Pixel logger. You may use this tag to log information from other tags, in live environment or in staging environment        *\n    * Wow, such logging. Many errors found. Wow. Much sniffing.                                                                       *\n    *                                                                                                                                 *\n    ***********************************************************************************************************************************/\n   /*{\n     VerticalTeam: "PRIME/MKT",\n     Author: "Paulo Campos",\n     ChangedBy: "Filipe Freitas",\n     Reviewer: "Paulo Campos",\n     LastChangedDate: "27/05/2016",\n     Version: "1.1",\n     Description: "Tag Logging"\n   }*/\t\n    var ffLogger \x3d {}\n    ffLogger.build \x3d function() {\n        // Log Endpoint\n        var logEndpoint \x3d "https://jslogs.farfetch.net/logPixel.png?"\n\n        // Log level enumerator\n        var LogLevelEnum \x3d {\n            INFO: "Info",\n            ERROR: "Error"\n        };\n\n        // Environment enumerator\n        var EnvironmentEnum \x3d {\n            LIVE: "Live",\n            STAGING: "Staging"\n        };\n\n        // tagName :: Name of the tag/pixel\n        // obj :: JSON object with the information that should be seen in the log or the error exception\n        // logLevel :: Error or Info\n        function tagLogger(tagName, obj, logLevel) {\n            obj \x3d logLevel !\x3d\x3d LogLevelEnum.ERROR ? obj : {\n                "ErrorMessage": obj.message\n            };\n\n            var environment \x3d "${Environment}"; //LIVE, STAGING, ..\n\n            if (shouldLogInformation(tagName)) {\n\n                var request \x3d {\n                    TagName: tagName,\n                    Message: obj,\n                    LogLevel: logLevel,\n                    Environment: environment\n                };\n\n                // Parsing the json to string\n                var params \x3d JSON.stringify(request);\n\n                if (params.length \x3e 0) {\n                    var image \x3d document.createElement("img");\n                    image.setAttribute(\'style\', \'width: 0px; height: 0px; display: none\');\n                    image.src \x3d getLoggerEndpoint() + params;\n\n                    // Appends the image to the body\n                    document.body.appendChild(image);\n                }\n\n                if (environment \x3d\x3d\x3d "STAGING") {\n                    // Output to console\n                    console.log("[FFLOGGER LOG]: " + tagName + " " + JSON.stringify(obj));\n                }\n            }\n        }\n\n        // private method that calcs if the log should write info\n        function shouldLogInformation(tagName) {\n            if (${FFLoggerList}.indexOf(tagName) \x3e -1) {\n                return true;\n            }\n            return false;\n        }\n\n        function getLoggerEndpoint() {\n            return logEndpoint;\n        }\n\n        // List of things to place publically\n        this.tagLogger \x3d tagLogger;\n        this.LogLevelEnum \x3d LogLevelEnum;\n        this.EnvironmentEnum \x3d EnvironmentEnum;\n    }\n\n    ffLogger.build();\n\x3c/script\x3e';
tag.addClientFiltersList([]);tag.addClientVariablesMap({"Environment":"live.variables.Environment","FFLoggerList":"live.variables.FFLoggerList"});tag.addParameters([{"name":"FFLoggerList","token":"FFLoggerList"},{"name":"Environment","token":"Environment"}]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Landing","disabled":false,"id":35686779,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.certonalanding.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\nvar resx \x3d {};\n\tresx.appid \x3d "Farfetch01";\n\tif (window.universal_variable.user.isLogged) {\n\t    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t} else {\n\t    resx.customerid \x3d "";\n\t}\n\tresx.rrec \x3d true;\n\tresx.rrelem \x3d "landingpage_rr";\n\tresx.rrnum \x3d "10;";\n\t\n\tvar countryId \x3d window.universal_variable.user.country_id;\n\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t    resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t}\n\tresx.rrqs \x3d $.param(resx.rrqs);\n\tvar url \x3d certonaResx.getURL();\n\t$.ajax({\n\t    url: url,\n\t    dataType: \'jsonp\',\n\t    jsonp: \'jsonp\',\n\t    timeout: 10000,\n\t    success: function (response) {\n\t        $(document).data("recommendations", response);\n\t    },\n\t    error: function () { \n\t      \t$(document).data("recommendations", false);\n\t    }\n\t});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.LandingPageMen","live.filters.LandingPageWomen","live.filters.LandingPageKids"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":true,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Linkshare - Media Optimization","disabled":false,"id":35687247,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.linksharemediaoptimization.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript language\x3d"javascript"\x3e\n  (function () {\n    \n        var formatPrice \x3d function(value) {\n            return Math.round(value * 100);\n        };\n\n        var calcTotalDiscountValueFromBasePrice \x3d function(unitbasePrice, discountPercentagePromoCode) {\n            var totalPriceWithoutVat \x3d unitbasePrice;\n            discountPercentagePromoCode \x3d parseFloat(discountPercentagePromoCode);\n            //Calc the % of discount\n            if (!isNaN(discountPercentagePromoCode) \x26\x26 discountPercentagePromoCode \x3e 0 \x26\x26 discountPercentagePromoCode \x3c\x3d 100) {\n                //Removing the promo code value from the total\n                totalPriceWithoutVat \x3d (unitbasePrice - (unitbasePrice * (discountPercentagePromoCode / 100.0)));\n            }\n\n            return Math.round(totalPriceWithoutVat);\n        };\n\n        try {\n            var uv, order_line, order_line_IDS, order_line_Vals,\n                order_line_Qty, i, x, linkSharePixelUrl,\n                valueUrl, skuprefix,\n                linkshare_currency, linkshare_affiliate_mid,\n                linkshare_date, linkshare_site_id, order_total, line_total;\n\n            uv \x3d window.universal_variable;\n            linkshare_currency \x3d uv.transaction.linkshare_destination_currency;\n            linkshare_affiliate_mid \x3d uv.transaction.linkshare_affiliate_mid;\n            linkshare_date \x3d uv.transaction.linkshare_date;\n            linkshare_site_id \x3d uv.transaction.linkshare_site_id;\n    \n            // User didn\'t came from a linkshare link\n            if (!linkshare_currency || !linkshare_affiliate_mid || !linkshare_date || !linkshare_site_id) return;\n            \n           \tvalueUrl\x3d  "eventnvppixel";  \n            order_line \x3d uv.transaction.line_items;\n            order_line_IDS \x3d [];\n            order_line_Vals \x3d [];\n            order_line_Qty \x3d [];\n    \n            //SKUPREFIX LOGIC\n            if (uv.user.returning) {\n                skuprefix \x3d "R_";\n            } else {\n                skuprefix \x3d "";\n            }\n    \n            order_total \x3d 0.0;\n            for (i \x3d 0; i \x3c order_line.length; i++) {\n                order_line_IDS.push(skuprefix + order_line[i].product.id + "_" + order_line[i].product.selectedRealSize);\n                order_line_Qty.push(order_line[i].quantity);\n                switch (linkshare_currency) {\n                    case "GBP":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_gbp * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        break;\n                    case "AUD":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_aud * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        break;\n                    case "USD":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_usd * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        break;\n                    case "EUR":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_eur * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        break;\n                    case "JPY":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(Math.round(order_line[i].product.unit_base_price_jpy * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        break;\n                }\n            }\n\n            var s \x3d document.createElement("img");\n            s.style.width \x3d \'1px\';\n            s.style.height \x3d \'1px\';\n            s.style.display \x3d "none";\n  \n            linkSharePixelUrl \x3d \n                "https://track.linksynergy.com/" +\n                valueUrl +\n                "?mid\x3d" + linkshare_affiliate_mid +\n                "\x26ord\x3d" + uv.transaction.order_id +\n                "\x26tr\x3d" + linkshare_site_id +\n                "\x26land\x3d" + linkshare_date +\n                "\x26skulist\x3d" + order_line_IDS.join("|") + // join array using "|"\n                "\x26qlist\x3d" + order_line_Qty.join("|") + // join array using "|"\n                "\x26amtlist\x3d" + order_line_Vals.join("|") + // join array using "|"\n                "\x26cur\x3d" + linkshare_currency +\n                "\x26img\x3d1";\n    \n            s.src \x3d linkSharePixelUrl;\n            document.body.appendChild(s);\n        } catch (e) {\n            ffLogger.tagLogger("Linkshare - Transaction", e, ffLogger.LogLevelEnum.ERROR);\n        }\n    }());\n\x3c/script\x3e';
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_Transactions","description":"Transactions","disabled":true});var pkg="live.tags.gatransactions.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript language\x3d\"javascript\"\x3e\n\n  // GA Transaction resolve the duplications\n  (function(){\n  tntGAT \x3d {\n      cookieName: \"FFOrderGAQubitTrack\",\n      //////////////////////////////////////////////////////////////////////\n      //// Cookie creation utilities ///////////////////////////////////////\n      //////////////////////////////////////////////////////////////////////\n      createCookie: function(value,days) {\n  \n          var expires;\n          if (days) {\n              var date \x3d new Date();\n              date.setTime(date.getTime() + (days * 24 * 60 * 60 *1000));\n              expires \x3d \"; expires\x3d\" + date.toGMTString();\n          }\n          else {\n              expires \x3d \"\";\n          }\n          document.cookie \x3d this.cookieName + \"\x3d\" + value \n                          + expires \n                          + \";domain\x3d\" + this.hostName()//universal_variable.page.cookieDomainName\n                          + \";path\x3d/\";\n  \n      },\n      getCookieValue: function()\n      {\n          var value \x3d \"; \" + document.cookie;\n          var parts \x3d value.split(\"; \" + this.cookieName + \"\x3d\");\n          if (parts.length \x3d\x3d 2)\n          return parts.pop().split(\";\").shift();\n  \n      },\n      deleteCookie: function() {\n          this.createCookie(\"\",-1);\n      }, \n      hostName: function()\n      {\n          return document.location.hostname.substring(document.location.hostname.lastIndexOf(\".\", document.location.hostname.lastIndexOf(\".\") - 1) + 1);\n      },\n      getRandomArbitrary: function() {\n          return Math.random() * (10 - 2) + 2;\n      },\n      core: function(){\n          for (var i \x3d 0, len \x3d universal_variable.transaction.line_items.length; i \x3c len; i++) { \n              ga('ec:addProduct', {\n                  'id': universal_variable.transaction.line_items[i].product.id,\n                  'name': universal_variable.transaction.line_items[i].product.name,\n                  'price': universal_variable.transaction.line_items[i].product.unit_sale_price,\n                  'brand': universal_variable.transaction.line_items[i].product.designerName,\n                  'category': universal_variable.transaction.line_items[i].product.category,\n                  'quantity': universal_variable.transaction.line_items[i].quantity\n              });\n          }\n          ga('ec:setAction', 'purchase', {\n              'id': universal_variable.transaction.order_id,\n              'affiliation': universal_variable.transaction.stores,\n              'revenue': universal_variable.transaction.total,\n              'tax': universal_variable.transaction.tax,\n              'shipping': universal_variable.transaction.shipping_cost,\n              'coupon': universal_variable.transaction.voucher\n          });\n          ga('send', 'event', 'ecommerce', 'transaction', location.href, 0, {nonInteraction: true});\n      }, \n      init: function() {\n          var cookieVal \x3d this.getCookieValue(this.cookieName);\n  \n          if (cookieVal !\x3d\x3d undefined \x26\x26 universal_variable.transaction.order_id \x3d\x3d cookieVal) \n          {\n              return;\n          }\n          else\n          {\n              this.deleteCookie();\n              this.createCookie(universal_variable.transaction.order_id, 2);\n              this.core();\n              return true;\n          }\n      }\n  }\n  tntGAT.init();\n})();\n\x3c/script\x3e";tag.addClientFiltersList(["live.filters.ConfirmationPage1"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalyticsgenericpageview.Tag","live.tags.googleuniversalanalytics.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Google Universal Analytics - Add to Basket","disabled":false,"id":35687458,"locked":false,"locationObject":"BODY"});var pkg="live.tags.googleuniversalanalyticsaddtobasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry\n{\n  if (window.universal_variable.page.pageId \x3d\x3d\x3d \"product\") {\n    $(document).on('click', '.Go_AddToBag', function() {\n      if ($(\".addToBag_ModelError\").attr(\"class\").indexOf(\"hide\") \x3e -1) {\n  \t    gaAction('AddToCart',window.universal_variable.product); \n  \t  }\n\t  });\n  } else {\n\t  $(document).bind(\"BagUpdated\", function(evt, product){ gaAction('AddToCart',product); });\n  }\n\n  function gaAction(action, product)\n  {\n    try\n    {\n      if(product !\x3d\x3d undefined){\n        ga('set', 'dimension1', product.id);\n      \tga('send', 'event', 'product actions', 'add to basket', product.name, product.id, true);\n      \t\n      \tvar json \x3d { productName: product.name, productId : product.id};\n      \tffLogger.tagLogger(\"Analytics - Basket\", json, ffLogger.LogLevelEnum.INFO);\n      }\n    } catch (a) {\n    \n      ffLogger.tagLogger(\"Analytics - Basket\", a, ffLogger.LogLevelEnum.ERROR);\n    }\n  }\n} catch (e) {\n  ffLogger.tagLogger(\"Analytics - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.OnlyProductAndBasketPages1","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.googleuniversalanalytics.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"Rule - Listing Page","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var pkg="live.tags.rulelistingpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ListingPage2"]);tag.addClientVariablesMap({});tag.addParameters([]);
tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Performance Horizon Conversion"});var pkg="live.tags.performancehorizonconversion.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\nphConversion \x3d \n{\n  //////////////////////////////////////////////////////////////////////\n  //// Settings ////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  cookieName: "PhPinkAcidSid",\n  hostTarget: "https://prf.hn/",\n  unitPrice: 0,\n  unitBasePrice: 0,\n  currentCampaign: "",\n  currentCurrency: "",\n  currencyMapping: {\n        \'1011l267\' : "USD",  // Chine\n        \'1011l270\' : "USD",  // US\n        \'1011l268\' : "JPY",  // Japan\n        \'1101l234\' : "AUD",  // Australia\n        \'1011l273\' : "USD",  // Korea\n        \'1011l271\' : "GBP",  // UK\n        \'1100l243\' : "GBP",  // ROW\n        \'1011l269\' : "EUR",  // German\n        \'1011l272\' : "EUR",  // Netherlands\n        \'1100l244\' : "EUR",  // France\n        \'1100l245\' : "EUR",   // Italy\n        \'1101l233\' : "USD"   // Canada\n    },\n\n  //////////////////////////////////////////////////////////////////////\n  //// Google Analytics Logger /////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  gaLogger: function (category, action, label) \n  {\n    try\n    {      \n        (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']\x3dr;i[r]\x3di[r]||function(){\n            (i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\n            m\x3ds.getElementsByTagName(o)\n            [0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n            })(window,document,\'script\',\'//www.google-analytics.com/analytics.js\',\'ga\');\n          \n        ga(\'create\', \'UA-91193943-1\', \'auto\', \'tntTracker\');\n        ga(\'tntTracker.send\', \'event\', category, action, label);\n       \n    }\n    catch(e)\n    {\n    }\n  },\n\n  //////////////////////////////////////////////////////////////////////\n  //// Utils  //////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n\n  getDeviceType: function()\n  {\n    var windowInnerWidth \x3d window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n   \n    //desktop\n    var type \x3d "desktop";\n\n    if(windowInnerWidth \x3c 767) {\n      //mobile \x3c 767px\n      type \x3d "mobile";\n    } else if(windowInnerWidth \x3e 767 \x26\x26 windowInnerWidth \x3c 1024) {\n      //tablet - 767px -\x3e 1024px\n      type \x3d "tablet";\n    }\n\n    return type;\n  },\n\n  convertArrayToUrl: function(arr)\n  {\n      var result \x3d "", length \x3d arr.length, count \x3d 1;\n      for (var i \x3d 0; i \x3c length; ++i)\n      {\n          result +\x3d "[" + this.convertObjectToUrl(arr[i]) + "]";\n          if(length \x3e count)\n          {\n             result +\x3d "/";\n          }\n          ++count;\n      }\n      return result;\n  },\n\n  convertObjectToUrl: function(json)\n  {\n      var result \x3d "", count \x3d 1;\n      for (key in json)\n      {\n          result +\x3d key + ":" + json[key];\n          if(Object.keys(json).length \x3e count)\n          {\n              result +\x3d "/";\n          }\n          ++count;\n      }\n      return result;\n  },\n\n  getCookieValue: function()\n  {\n      var value \x3d "; " + document.cookie;\n      var parts \x3d value.split("; " + this.cookieName + "\x3d");\n      if (parts.length \x3d\x3d 2) \n        return parts.pop().split(";").shift();\n  },\n\n  //////////////////////////////////////////////////////////////////////\n  //// Performance Horizon Logic ///////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  getCampaignId: function()  // Singleton for Campaign Id\n  {\n      if (this.currentCampaign \x3d\x3d "")\n       return this.currentCampaign \x3d this.getCookieValue(this.cookieName);\n     return this.currentCampaign;\n  },\n  \n  getCurrency: function() // Singleton for Currency based on Campaign\n  {\n    var campaign \x3d this.getCampaignId();\n    if (this.currentCurrency \x3d\x3d "")\n       return this.currentCurrency \x3d this.currencyMapping[campaign];\n    return this.currentCurrency;\n  },\n\n  getTransactionTotal: function()\n  {\n    var currency \x3d this.getCurrency();\n    switch(currency)\n      {\n          case \'USD\':\n          {\n                return universal_variable.transaction.total_usd;\n          }\n          case \'JPY\':\n          {\n                return universal_variable.transaction.total_jpy;\n          }\n          case \'AUD\':\n          {\n                return universal_variable.transaction.total_aud;\n          }\n          case \'KRW\':\n          {\n                return universal_variable.transaction.total_usd;  // \x3c- note the usd for korea\n          }\n          case \'GBP\':\n          {\n                return universal_variable.transaction.total_gbp;\n          }\n          case \'EUR\':\n          {\n                return universal_variable.transaction.total_eur;\n          }\n      }\n\n  },\n  \n  getGenericProperties: function()\n  {\n      var genericParameters \x3d \n      {\n        // Ph Documentation \n        campaign: \'1011l274\',//this.getCampaignId(),\n        conversionref: universal_variable.transaction.order_id,\n        currency: this.getCurrency(),\n        custref: universal_variable.user.user_id,\n        voucher: \'\',\n        customertype: (universal_variable.user.returning ? \'existing\' : \'new\'),\n        country: this.getSubFolder(),\n        // Moved from product parameters\n        device_type: this.getDeviceType(),\n        customer_repeat_visits: \'\', // -----------------------------------------------------------------------------,\n        \'return\' : \'\',\n        return_date: \'\',\n        tax: universal_variable.transaction.tax,\n        delivery_costs: universal_variable.transaction.shipping_cost, // match the generic parameter \'currency\'. The currency where the sale took place on ff website,\n        // Excel Parameters\n        sale_value: this.getTransactionTotal()\n      };\n      return genericParameters;\n  },\n\n  getSubFolder: function(){\n    var uv \x3d window.universal_variable;\n    if(uv.page \x26\x26 uv.page.hasOwnProperty(\'subfolder\')){\n      if (uv.page.subfolder \x3d\x3d "") // This hammer is here to mend the US exception :(\n        return "US"; \n      else if (uv.page.subfolder.replace("/", "").toUpperCase() \x3d\x3d \'UK\')\n        return "GB";\n        \n      return uv.page.subfolder.replace("/", "").toUpperCase();  \n    }\n    return "";\n  },\n\n  hasLineItemsInTransaction: function()\n  {\n      return universal_variable.transaction.line_items \n          \x26\x26 universal_variable.transaction.line_items.length \x3e 0;\n  },\n    \n  populatePrices: function(product)\n  {\n      var currency \x3d this.getCurrency();\n      switch(currency)\n      {\n          case \'USD\':\n          {\n                this.unitPrice \x3d product.unit_price_usd;\n                this.unitBasePrice \x3d product.unit_base_price_usd;\n                break;\n          }\n          case \'JPY\':\n          {\n                this.unitPrice \x3d product.unit_price_jpy;\n                this.unitBasePrice \x3d product.unit_base_price_jpy;\n                break;\n          }\n          case \'AUD\':\n          {\n                this.unitPrice \x3d product.unit_price_aud;\n                this.unitBasePrice \x3d product.unit_base_price_aud;\n                break;\n          }\n          case \'KRW\':\n          {\n                this.unitPrice \x3d product.unit_price_usd;             // \x3c- note the usd \n                this.unitBasePrice \x3d product.unit_base_price_usd;    // \x3c- note the usd      \n                break;\n          }\n          case \'GBP\':\n          {\n                this.unitPrice \x3d product.unit_price_gbp;\n                this.unitBasePrice \x3d product.unit_base_price_gbp;\n                break;\n          }\n          case \'EUR\':\n          {\n                this.unitPrice \x3d product.unit_price_eur;\n                this.unitBasePrice \x3d product.unit_base_price_eur;\n                break;\n          }\n      }\n  },\n\n  getProductsFromTransaction: function()\n  {\n      var products \x3d [];\n      \n      if(this.hasLineItemsInTransaction())\n      {\n          var lineItems \x3d universal_variable.transaction.line_items;\n          var itemsLength \x3d lineItems.length;\n          var campaignId \x3d this.getCampaignId();\n          \n          for(var index \x3d 0; index \x3c itemsLength; ++index)\n          {\n              this.populatePrices(lineItems[index].product);\n              \n              var product \x3d \n              {\n                // PH Documentation parameters\n                category: lineItems[index].product.category,\n                sku: lineItems[index].product.sku_code,\n                value: this.unitBasePrice,\n                quantity: lineItems[index].quantity,\n                product: lineItems[index].product.name,\n                size: lineItems[index].product.selectedRealSize,\n                colour: \'\', // ---------------------------------------------------------------------- WE DONT HAVE COLOUR ON TRANSACTION\n                gender: \'\', // ---------------------------------------------------------------------- CAN WE POPULATE THIS WITH MALE/WOMAN/ KIDS????!?\n                item_product_group: lineItems[index].product.designerName, // ---------------------------- just the desiger for now. BRAND WILL BE ADDED LATER, \n                gross_value: this.unitPrice,\n                gbp_amount: lineItems[index].product.unit_price_gbp,\n                // Excel Parameters\n                brand: \'\', // ----------------------------------------------------------------------- WE DONT HAVE BRAND yet,\n              }\n              products.push(product);\n          }\n      }\n    \n      return products;\n  },\n  \n  createPixel: function()\n  {\n      var currency \x3d this.getCurrency();\n      if(!currency)\n      {\n         this.gaLogger("Live", "Ph Conversion - COM", "campaign missed: " + this.getCampaignId() );\n      }\n      else\n      {\n        var header \x3d this.getGenericProperties();\n        var headerUrl \x3d this.convertObjectToUrl(header);\n        \n        var productsUrl \x3d this.convertArrayToUrl(this.getProductsFromTransaction());\n        \n        var source \x3d this.hostTarget \n                        + "conversion/" \n                        + headerUrl \n                        + "/" \n                        + productsUrl;\n        \n        var image \x3d document.createElement("img");\n        image.src \x3d source;\n        image.height \x3d 1;\n        image.width \x3d 1;\n        \n        return image;\n      }\n\n  },\n  \n  firePixel: function(pixel)\n  {\n      document.body.appendChild(pixel);\n  },\n\n  init: function()\n  {\n    var pixel \x3d this.createPixel();\n    this.firePixel(pixel);\n    this.gaLogger("Live", "Ph Conversion - COM", "fired camp: " + this.getCampaignId() );\n    // Cookie should not be deleted. It\'s dedupe\'s job. \n    // this.deleteCookie();\n  }\n}\nphConversion.init();\n\x3c/script\x3e';tag.addClientFiltersList(["live.filters.DedupePerformanceHorizonV2",
"live.filters.ConfirmationPage1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"DoubleClick Floodlight - Confirmation","description":'{\n\tVerticalTeam : "PRIME/MKT",\n\tAuthor : "",\n\tChangedBy : "Filipe Freitas",\n\tReviewer : "",\n\tLastChangedDate : "01/06/2016",\n\tVersion : "1.0",\n\tDescription : ""\n}',"disabled":true});var pkg="live.tags.doubleclickfloodlightconfirmation.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\ntry {\n\tvar uv \x3d window.universal_variable;\n\t//var axel \x3d Math.random() + \"\";\n\t//var a \x3d axel * 10000000000000;\n\tvar fl_if \x3d document.createElement(\"iframe\");\n\n\tvar lineItems \x3d uv.transaction.line_items;\n\tvar designerNames \x3d [];\n\tvar categories \x3d [];\n\tvar productIds \x3d [];\n\tvar productNames \x3d [];\n\tvar units_price \x3d [];\n\tvar units_sale_price \x3d [];\n\tvar storeIds \x3d [];\n\tvar quantity \x3d 0;\n\n\tvar products \x3d \"\";\n\n\tfor (var i \x3d 0; i \x3c lineItems.length; i++) {\n\t\tdesignerNames.push(lineItems[i].product.designerName);\n\t\tcategories.push(lineItems[i].product.category);\n\t\tproductIds.push(lineItems[i].product.sku_code);\n\t\tproductNames.push(lineItems[i].product.name);\n\t\tunits_price.push(lineItems[i].product.unit_price);\n\t\tunits_sale_price.push(lineItems[i].product.unit_sale_price);\n\t\tstoreIds.push(lineItems[i].product.storeId);\n\t\tquantity +\x3d lineItems[i].quantity;\n\n\t\tproducts +\x3d \"i\" + (i + 1) + \":\" + lineItems[i].product.sku_code + \"|\";\n\t\tproducts +\x3d \"p\" + (i + 1) + \":\" + lineItems[i].product.unit_sale_price + \"|\";\n\t\tproducts +\x3d \"q\" + (i + 1) + \":\" + lineItems[i].quantity + \"|\";\n\t\tproducts +\x3d \"c\" + (i + 1) + \":\" + uv.user.country_code + \"|\";\n\t\tproducts +\x3d \"l\" + (i + 1) + \":\" + uv.user.language + \"|\";\n\t}\n\n\tproducts \x3d products.substring(0, products.length - 1); //remove last '|'\n\n\tfl_if.src \x3d 'https://5472550.fls.doubleclick.net/activityi;src\x3d5472550;type\x3dmacro0;cat\x3dfarfe0' +\n\t\t';qty\x3d' + quantity + //[quantity]\n\t\t';cost\x3d' + uv.transaction.total_gbp + //[revenue]\n\t\t';u1\x3d' + uv.transaction.is_first_order + //[is_first_order]\n\t\t';u2\x3d' + uv.transaction.currency + //[currency];\n\t\t';u3\x3d' + uv.transaction.subtotal + //[subtotal];\n\t\t';u4\x3d' + uv.transaction.shipping_cost + //[shipping_cost];\n\t\t';u5\x3d' + uv.user.user_id + //[user_id];\n\t\t';u6\x3d' + '[' + categories.join('|') + ']' + //[category];\n\t\t';u7\x3d' + //[color];\n\t\t';u8\x3d' + //[department];\n\t\t';u9\x3d' + '[' + designerNames.join('|') + ']' + //[designerName];\n\t\t';u10\x3d' + '[' + productIds.join('|') + ']' + //[product id];\n\t\t';u11\x3d' + '[' + productNames.join('|') + ']' + //[product_name];\n\t\t';u12\x3d' + '[' + storeIds.join('|') + ']' + //[storeId];\n\t\t';u13\x3d' + //[subcategory];\n\t\t';u14\x3d' + '[' + units_price.join('|') + ']' + //[unit_price];\n\t\t';u15\x3d' + '[' + units_sale_price.join('|') + ']' + //[unit_sale_price];\n\t\t';u16\x3d' + uv.user.country_code.toLocaleLowerCase() + //[country];\n\t\t';u17\x3d' + uv.page.subfolder + //[subfolder];\n\t\t';u18\x3d' + uv.user.just_registered + //[just_registered];\n\t\t';u19\x3d' + uv.user.language + //[language]\n\t\t';dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d' +\n\t\t';ord\x3d' + uv.transaction.order_id + '?'; //[OrderID]\n\t//';prd\x3d'+ products + '?';\n\tfl_if.width \x3d \"1\";\n\tfl_if.height \x3d \"1\";\n\tfl_if.frameborder \x3d \"0\";\n\tfl_if.style.display \x3d \"none\";\n\tdocument.body.appendChild(fl_if);\n\n\tffLogger.tagLogger(\"DoubleClick Floodlight - Confirmation\",  {\"ImgSrc\" : fl_if.src}, ffLogger.LogLevelEnum.INFO);\n} catch (e) {\n\tffLogger.tagLogger(\"DoubleClick Floodlight - Confirmation\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"dtxtngytz5im1.cloudfront.net/feedback-min.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"QuBit Exit Feedback","disabled":true,"id":35686689,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubitexitfeedback.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList([]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.uvfixuserproperty.Tag"]);tag.pre=function(){window.q_fb_opts={"showProb":.6,"hideFilter":"farfetch.com/holiday/wonderfulstore/","journeyDepth":1,"trackingId":"farfetch","domain":".farfetch.com","clientId":33446,"profileId":2034,"configId":14}};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"Performance Horizon Inc Traffic"});var pkg="live.tags.performancehorizoninctraffic.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n// Performance Horizon - Inc Traffic Tag\n\nphIncTraffic \x3d \n{\n\t//////////////////////////////////////////////////////////////////////\n\t//// Settings ////////////////////////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\tcookieName: "PhPinkAcidSid",\n\tcookieExpirationDate: 30,\n\tphMediumType: "affiliate",\n\tphCampaignStartsWith: "PH",\n\tcommonDomain: ".farfetch.com",\n    campaignIdMapping: {\n        "PHAU" : "1101l234",\n        "PHCA" : "1101l233",\n        "PHCN" : "1011l267",\n        "PHFR" : "1100l244",\n        "PHDE" : "1011l269",\n        "PHIT" : "1100l245",\n        "PHJP" : "1011l268",\n        "PHKR" : "1011l273",\n        "PHNL" : "1011l272",\n        "PHROW" : "1100l243",\n        "PHUK" : "1011l271",\n        "PHUS" : "1011l270"\n    },\n\n\t//////////////////////////////////////////////////////////////////////\n\t//// Google Analytics Logger /////////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\tgaLogger: function (category, action, label) {\n\t\ttry\n\t\t{      \n          (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']\x3dr;i[r]\x3di[r]||function(){\n              (i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\n              m\x3ds.getElementsByTagName(o)\n              [0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n              })(window,document,\'script\',\'//www.google-analytics.com/analytics.js\',\'ga\');\n            \n          ga(\'create\', \'UA-91193943-1\', \'auto\', \'tntTracker\');\n          ga(\'tntTracker.send\', \'event\', category, action, label);\n     \n       }\n       catch(e)\n       {\n       }\n    },\n\n\t//////////////////////////////////////////////////////////////////////\n\t//// Perfomance Horizon Tag Start ////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\t\n\tinit: function() {\n\t\tvar utm_medium \x3d this.getParameterByName("utm_medium");\n\t\tvar utm_campaign \x3d this.getParameterByName("utm_campaign");\n\n\t\tif (this.isPhSource(utm_medium, utm_campaign))\n\t\t{\n\t\t\tthis.createCookie(this.getCampaignIdFromMap(utm_campaign), this.cookieExpirationDate);\n\t\t\tthis.gaLogger("Debug", "COM - PhIncTraffic", "medium: " + utm_medium + " campaign: " + utm_campaign);\n\t\t}\n\t},\n\n\t//////////////////////////////////////////////////////////////////////\n\t//// Cookie creation utilities ///////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\tcreateCookie: function(value,days) {\n\t\tvar expires;\n\t    if (days) {\n\t        var date \x3d new Date();\n\t        date.setTime(date.getTime() + (days * 24 * 60 * 60 *1000));\n\t        expires \x3d "; expires\x3d" + date.toGMTString();\n\t    }\n\t    else {\n\t        expires \x3d "";\n\t    }\n\t    document.cookie \x3d this.cookieName + "\x3d" + value \n\t    \t\t\t\t+ expires \n\t    \t\t\t\t+ ";domain\x3d" + this.commonDomain \n\t    \t\t\t\t+ ";path\x3d/";\n\t},\n\n\tgetCookieValue: function()\n\t{\n\t var value \x3d "; " + document.cookie;\n\t var parts \x3d value.split("; " + this.cookieName + "\x3d");\n\t if (parts.length \x3d\x3d 2)\n\t   return parts.pop().split(";").shift();\n\t},\n\n\tdeleteCookie: function() {\n\t    this.createCookie("",-1);\n\t},\n\n\t//////////////////////////////////////////////////////////////////////\n\t//// URL Parse ///////////////////////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\tgetParameterByName: function(name) {\n    name \x3d name.replace(/[\\[]/, "\\\\[").replace(/[\\]]/, "\\\\]");\n    var regex \x3d new RegExp("[\\\\?\x26]" + name + "\x3d([^\x26#]*)"),\n        results \x3d regex.exec(location.search);\n    return results \x3d\x3d\x3d null ? "" : decodeURIComponent(results[1].replace(/\\+/g, " "));\n\t},\n\n\t//////////////////////////////////////////////////////////////////////\n\t//// Performance Horizon Logic ///////////////////////////////////////\n\t//////////////////////////////////////////////////////////////////////\n\tisPhSource: function(medium, campaign){\n\t\treturn medium \x3d\x3d this.phMediumType \x26\x26\n\t\t\t   campaign in this.campaignIdMapping;\n\t},\n\n\tisValidPhCampaignId: function(campaign){\n\t\treturn campaign.startsWith(this.phCampaignStartsWith);\n\t},\n\n\t// Give a utm_campaign like PHUK or PHROW or PHJP \n\t// it will return the correspondent campaign id if exists in the map\n\tgetCampaignIdFromMap: function(utm_campaign){\n\t\treturn this.campaignIdMapping[utm_campaign];\n\t}\n}\nphIncTraffic.init();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.IsIncomingTraffic"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"FFRef Manager"});var pkg="live.tags.ffrefmanager.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ffstorage1.Tag"]);tag.pre=function(){};tag.script=function(){window.ffrefManager=function(){var cookieId="TrackingFfref";var refCookieId="TrackingFfrefRef";var cookieExpirationInHours=
1;var urlFfrefParameterKey="ffref";var pageFfref;var pageReferalFfref;var _setPageFfrefValues=function(){var ffrefData=_getFfrefDataFromCookie(cookieId,window.location.href);pageFfref=ffrefData.ffref;pageReferalFfref=ffrefData.refFfref;if(document.referrer.length>0){var refererFfrefData=_getFfrefDataFromCookie(refCookieId,document.referrer);if(_isUndefinedNullOrEmpty(pageReferalFfref))pageReferalFfref=refererFfrefData.ffref}_addFfrefCookieValue(refCookieId,{url:window.location.href,ffref:pageFfref,
ref_ffref:pageReferalFfref})};var _getFfrefDataFromCookie=function(cookieName,url){var data={ffref:null,refFfref:null};var ffrefCookieValues=FFStorage.getValue(cookieName);for(var i=0;i<ffrefCookieValues.length;i++)if(ffrefCookieValues[i].url==url){data.ffref=ffrefCookieValues[i].ffref;data.refFfref=ffrefCookieValues[i].ref_ffref;ffrefCookieValues.splice(i,1);FFStorage.setValue(cookieName,ffrefCookieValues,cookieExpirationInHours);break}return data};var _addClickEventToLinksWithFfref=function(){var elemsWithDataFfref=
document.querySelectorAll("[data-ffref]");for(var i=0;i<elemsWithDataFfref.length;i++){elemsWithDataFfref[i].removeEventListener("mouseup",_mouseUpEventCallback,true);elemsWithDataFfref[i].addEventListener("mouseup",_mouseUpEventCallback,true)}};var _mouseUpEventCallback=function(event){if(event.button===0||event.button===1)_addFfrefCookieValue(cookieId,{url:this.href,ffref:this.dataset.ffref,ref_ffref:pageFfref?pageFfref:null})};var _addFfrefCookieValue=function(cookieName,value){value.url=_normalizeUrlWithHost(value.url);
var ffrefValues=FFStorage.getValue(cookieName);if(ffrefValues.length===0||ffrefValues.length>0&&(value.ffref!==null||value.ref_ffref!==null)){ffrefValues.push(value);FFStorage.setValue(cookieName,ffrefValues,cookieExpirationInHours)}};var _normalizeUrlWithHost=function(url){if(url.indexOf("http")!==-1)return url;return location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+url};var _getConsolidatedUrlWithFfref=function(url,ffrefValue){if(!url||!ffrefValue||_queryStringParameterExists(url,
urlFfrefParameterKey))return url;else return _addQueryStringParameterToUrl(url,urlFfrefParameterKey,ffrefValue)};var _queryStringParameterExists=function(uri,key){var re=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)","i");return uri.match(re)};var _addQueryStringParameterToUrl=function(uri,key,value){var anchorIndex=uri.indexOf("#");var anchor=anchorIndex!==-1?uri.substring(anchorIndex):"";uri=anchorIndex!==-1?uri.substring(0,anchorIndex):uri;var separator=uri.indexOf("?")!==-1?"\x26":"?";return uri+
separator+key+"\x3d"+value+anchor};var _isUndefinedNullOrEmpty=function(obj){return typeof obj==="undefined"||obj===null||obj.length===0};return{init:function(){_setPageFfrefValues();_addClickEventToLinksWithFfref();var i=0;for(var evs=["AjaxContentLoaded","MeganavItemsLoaded"];i<evs.length;i++)events.on(evs[i],function(ev){_addClickEventToLinksWithFfref()});events.on("AddToBagFfref",function(ev){_addFfrefCookieValue(cookieId,{url:ev.url,ffref:ev.ffref?ev.ffref:"",ref_ffref:pageFfref?pageFfref:null})})},
addCookieValue:function(url,ffref){_addFfrefCookieValue(cookieId,{url:url,ffref:ffref,ref_ffref:pageFfref?pageFfref:null})},getHrefUrl:function(){return _getConsolidatedUrlWithFfref(window.location.href,pageFfref)},getRefererUrl:function(){return _getConsolidatedUrlWithFfref(document.referrer,pageReferalFfref)}}}();window.ffrefManager.init()};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Mention Me","disabled":true,"id":53781248,"locked":false,"locationObject":"BODY"});var pkg="live.tags.mentionme.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n\tvar mm \x3d {\n    userProperties: {\n        firstname: function () {\n            var name \x3d window.universal_variable.user.name;\n            return name ? name.split(" ")[0] : "";\n        },\n\n        surname: function () {\n            var name \x3d window.universal_variable.user.name;\n            return name ? name.split(" ")[name.split(" ").length - 1] : "";\n        },\n      \n      \tfullname: function(){\n        \treturn window.universal_variable.user.name;\n        },\n\n        partnercode: function () {\n            var partnercode \x3d window.universal_variable.page.partnercode;\n            return partnercode ? partnercode : "mm4881d5ac";\n        },\n\n        email: function () {\n            return window.universal_variable.user.email;\n        },\n\n        order_number: function () {\n            return window.universal_variable.transaction.int_order_id;\n        },\n\n        order_total: function () {\n            return window.universal_variable.transaction.total;\n        },\n\n        order_currency: function () {\n            return window.universal_variable.transaction.currency;\n        },\n\n        order_date: function () {\n            return window.universal_variable.transaction.orderDate;\n        },\n\n        customer_id: function () {\n            return window.universal_variable.user.user_id;\n        },\n\n        segment: function () {\n            return window.universal_variable.user.country_code;\n        },\n\n        coupon_code: function () {\n            return window.universal_variable.transaction.voucherCode;\n        },\n\n        getProperty: function (name) {\n            return this[name] ? this[name]() : "";\n        }\n    },\n\n    configuration: {\n        url: "https://tag.mention-me.com/api/v2/",\n\n        pagesProperties: {\n            account: function () {\n                return ["email", "surname", "firstname", "fullname", "segment","customer_id"];\n            },\n\n            revieworder: function () {\n                return ["email", "surname", "firstname", "fullname", "segment", "customer_id"];\n            },\n\n            confirmation: function () {\n                var properties \x3d ["email", "surname", "firstname", "order_number", "order_total", "order_currency", "order_date", "customer_id", "segment"]\n                if (window.universal_variable.transaction.voucherCode) {\n                    properties.push("coupon_code");\n                }\n                return properties;\n            },\n\n            payment: function () {\n                return ["email", "surname", "firstname", "fullname", "segment", "customer_id"];\n            },\n\n            refer: function () {\n                if (window.universal_variable.user.name) {\n                    return ["email", "surname", "firstname", "segment", "customer_id"];\n                } else {\n                    return ["segment"];\n                }\n            },\n\n            share: function () {\n                return ["email", "surname", "firstname", "segment", "customer_id"];\n            }\n        }\n    },\n\n    init: {\n        generateUrl: function (urlProperties, userProperties) {\n            var src \x3d mm.configuration.url\n             + urlProperties.refererType + "/"\n             + mm.userProperties.getProperty("partnercode");\n\n            if (urlProperties.pageType \x3d\x3d "account") {\n                src +\x3d "/" + mm.userProperties.getProperty("email");\n            }\n\n            src +\x3d "?";\n            if (urlProperties.isEmbed) {\n                src +\x3d "implementation\x3dembed\x26";\n            }\n            src +\x3d "situation\x3d" + urlProperties.situation + "\x26" + $.param(userProperties);\n            return src;\n        },\n\n        generateUrlProperties: function (pageType, refererType, situation, isEmbed) {\n            return {\n                "pageType": pageType,\n                "refererType": refererType,\n                "situation": situation,\n                "isEmbed": isEmbed\n            };\n        },\n\n        generateUserProperties: function (pageType) {\n            var userProperties \x3d {};\n            requiredPropertiesNames \x3d mm.configuration.pagesProperties[pageType]();\n\n            for (var i \x3d 0; i \x3c requiredPropertiesNames.length; i++) {\n                if (mm.userProperties[requiredPropertiesNames[i]])\n                {\n                    userProperties[requiredPropertiesNames[i]] \x3d mm.userProperties[requiredPropertiesNames[i]]();\n                }\n            }\n\n            return userProperties;\n        },\n\n        loadMentionMeScript: function (url) {\n            $.ajax({\n                url: url,\n                dataType: "script",\n                success: function (script) {\n                    //Inject css classes for checkout isolation\n                    $(window).load();\n                }\n            });\n        },\n\n        load: function () {\n            var urlProperties \x3d null,\n                userProperties \x3d null,\n                url \x3d "",\n                isConfirmationPage \x3d ${isConfirmationPage},\n                isReviewOrderPage \x3d ${isReviewOrderPage},\n                isPaymentPage \x3d ${isPaymentPage};\n                \n\n            if (window.location.href.indexOf("useraccount.aspx") \x3e -1) {\n                //My Account Page\n                urlProperties \x3d this.generateUrlProperties("account", "dashboard", "dashboard", true);\n                userProperties \x3d this.generateUserProperties("account");\n            } else if (window.location.href.indexOf("refer-a-friend") \x3e -1 || window.location.href.indexOf("convideamigos.aspx") \x3e -1) {\n                //Refer a Friend Page\n                urlProperties \x3d this.generateUrlProperties("refer", "referreroffer", "landingpage", true);\n                userProperties \x3d this.generateUserProperties("refer");\n            } else if (window.location.href.indexOf("/share") \x3e -1 \x26\x26 !window.location.href.indexOf("/shareff") \x3e -1) {\n                //Share Page\n                urlProperties \x3d this.generateUrlProperties("share", "refereefind", "sharepage", true);\n                userProperties \x3d this.generateUserProperties("share");\n            } else if (isPaymentPage) {\n                //Payment Page\n                urlProperties \x3d this.generateUrlProperties("payment", "refereefind", "checkout", false);\n                userProperties \x3d this.generateUserProperties("payment");\n            } else if (isReviewOrderPage) {\n                //Review Order Page\n                urlProperties \x3d this.generateUrlProperties("revieworder", "refereefind", "checkout", false);\n                userProperties \x3d this.generateUserProperties("revieworder");\n            } else if (isConfirmationPage) {\n                //Order Confirmation Page\n                urlProperties \x3d this.generateUrlProperties("confirmation", "referreroffer", "postpurchase", false);\n                userProperties \x3d this.generateUserProperties("confirmation");\n            }\n\n            if (urlProperties \x26\x26 userProperties)\n            {\n                var url \x3d this.generateUrl(urlProperties, userProperties);\n                this.loadMentionMeScript(url);\n            }\n        }\n    }\n};\n  \nif (window.universal_variable.page.mentionMe) {\n  mm.init.load();\n}\n\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.MentionMeQUBITGTM","live.filters.ExcludeShareFF","live.filters.OnlyUserAccount","live.filters.PaymentPage","live.filters.ReferAFriend","live.filters.Convideamigos","live.filters.DefaultFilterMatchAll3","live.filters.DefaultFilterMatchAll4","live.filters.ConfirmationPage1"]);tag.addClientVariablesMap({"isPaymentPage":"live.variables.IsPaymentPage","isConfirmationPage":"live.variables.IsConfirmationPage","isReviewOrderPage":"live.variables.IsReviewOrderPage"});
tag.addParameters([{"name":"isConfirmationPage","token":"isConfirmationPage"},{"name":"isReviewOrderPage","token":"isReviewOrderPage"},{"name":"isPaymentPage","token":"isPaymentPage"}]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"DoubleClick Floodlight - Newsletter SignUp","disabled":true});var pkg="live.tags.doubleclickfloodlightnewslettersignup.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\nvar axel \x3d Math.random() + "";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement("iframe");\nfl_if.src\x3d \'https://5472550.fls.doubleclick.net/activityi;src\x3d5472550;type\x3dmicro0;cat\x3dfarfe00;dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d\' + a + \'?\';\nfl_if.width\x3d"1";\nfl_if.height\x3d"1";\nfl_if.frameborder\x3d"0";\nfl_if.style.display \x3d "none";\ndocument.body.appendChild(fl_if);\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.NewsletterSignUpThankYouPage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Basket, WishList","disabled":true,"id":53044170,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.facebookbasketwishlist.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n    try {\n        $(document).bind(\"WishListUpdated\", function(evt, product) {\n            facebookAddAction('AddToWishlist', product);\n        });\n\n        if (window.universal_variable.page.pageId \x3d\x3d\x3d \"product\") {\n            $(document).on('click', '.Go_AddToBag', function() {\n                if ($(\".addToBag_ModelError\").attr(\"class\").indexOf(\"hide\") \x3e -1) {\n                    facebookAddAction('AddToCart', window.universal_variable.product);\n                }\n            });\n        } else {\n            $(document).bind(\"BagUpdated\", function(evt, product) {\n                facebookAddAction('AddToCart', product);\n            });\n        }\n\n        function facebookAddAction(action, product) {\n            try {\n                if (product !\x3d\x3d undefined) {\n                    var json \x3d {\n                      content_name: product.name,\n                      content_ids: [product.id],\n                      content_type: 'product',\n                      value: product.unit_price,\n                      currency: window.universal_variable.page.currency\n                    };\n                    \n                    fbq('track', action, json);\n\n                    // Logging when the fire is related with AddToCart\n                    if (action \x3d\x3d\x3d 'AddToCart') {\n                        ffLogger.tagLogger('Facebook - Basket', json, ffLogger.LogLevelEnum.INFO);\n                    }\n                }\n            } catch (a) {\n                ffLogger.tagLogger(\"Facebook - Basket\", a, ffLogger.LogLevelEnum.ERROR);\n            }\n        }\n    } catch (e) {\n        ffLogger.tagLogger(\"Facebook - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n    }\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.AddToBasketAndWishlistPages"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"name":"Rule - Confirmation Page","active":true,"disabled":false,"locked":false,"locationObject":"HEAD","url":"","timeout":5E3});var pkg="live.tags.ruleconfirmationpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\nif(window.location.href.match(/dedupe-test/)){\n    window.universal_variable.transaction \x3d {\n        "order_id": "BDTEST",\n        "tax": 0,\n        "billing": {\n            "address": "10 Test Street",\n            "city": "Testertown",\n            "state": "Test",\n            "postcode": "WC2 Test",\n            "country": "Testing"\n        },\n        "orderLang": "en-US",\n        "currency": "USD",\n        "total_eur": 85.29,\n        "total_gbp": 66.96,\n        "voucher_discount_usd": 0,\n        "total": 94.72,\n        "total_jpy": 10732.35,\n        "tax_gbp": 0,\n        "total_usd": 94.72,\n        "voucher_discount_eur": 0,\n        "line_items": [{\n            "product": {\n                "unit_vat_price_usd": 70.72,\n                "unit_base_price_gbp": 49.993,\n                "designerName": "Our Legacy",\n                "unit_base_price_jpy": 8012.781,\n                "unit_vat_price_aud": 94.68,\n                "unit_price_usd": 70.72,\n                "currency": "USD",\n                "storeId": 9735,\n                "unit_sale_price_aud": 94.69,\n                "selectedRealSize": "46",\n                "unit_base_price_eur": 63.679,\n                "name": "\'50\'s Great Sweat\' sweatshirt",\n                "image_url": "http://cdn-images.farfetch.com/11/13/24/33/11132433_5415400_120.jpg",\n                "unit_base_price_usd": 70.718,\n                "unit_base_price_aud": 94.684,\n                "CurrencyCode": "USD",\n                "unit_sale_price_usd": 70.72,\n                "unit_price_aud": 94.69,\n                "unit_vat_price_jpy": 8012.78,\n                "unit_sale_price": 70.72,\n                "unit_vat_price_gbp": 49.99,\n                "unit_price_jpy": 8013.01,\n                "url": "/shopping/women/our-legacy--50-s-great-sweat-sweatshirt-item-11132433.aspx?storeid\x3d9124",\n                "unit_sale_price_eur": 63.68,\n                "unit_vat_price_eur": 63.68,\n                "hasStock": false,\n                "unit_price_eur": 63.68,\n                "categoryId": 136334,\n                "unit_price_gbp": 49.99,\n                "department": "Lab",\n                "unit_base_price": 70.718,\n                "prices": [{\n                    "EUR": [{\n                        "1": 63.68\n                    }, {\n                        "2": 63.68\n                    }]\n                }, {\n                    "USD": [{\n                        "1": 70.72\n                    }, {\n                        "2": 70.72\n                    }]\n                }, {\n                    "GBP": [{\n                        "1": 49.99\n                    }, {\n                        "2": 49.99\n                    }]\n                }, {\n                    "BRL": [{\n                        "1": 264.05\n                    }, {\n                        "2": 264.05\n                    }]\n                }, {\n                    "CAD": [{\n                        "1": 94.28\n                    }, {\n                        "2": 94.28\n                    }]\n                }, {\n                    "AUD": [{\n                        "1": 94.69\n                    }, {\n                        "2": 94.69\n                    }]\n                }, {\n                    "JPY": [{\n                        "1": 8013\n                    }, {\n                        "2": 8013\n                    }]\n                }, {\n                    "RUB": [{\n                        "1": 4811.2\n                    }, {\n                        "2": 4811.2\n                    }]\n                }, {\n                    "KRW": [{\n                        "1": 84227\n                    }, {\n                        "2": 84227\n                    }]\n                }, {\n                    "CHF": [{\n                        "1": 69.77\n                    }, {\n                        "2": 69.77\n                    }]\n                }],\n                "unit_price": 70.72,\n                "unit_sale_price_gbp": 49.99,\n                "discount_percentage_promoCode": "0",\n                "sku_code": "11132433",\n                "id": "11132433",\n                "category": "Sweaters \x26 Knitwear"\n            },\n            "quantity": 1,\n            "subtotal": 70.72,\n            "origin": "187",\n            "origin_code": "ES"\n        }],\n        "voucher_discount_jpy": 0,\n        "linkshare_affiliate_mid": "35653",\n        "CurrencyCode": "USD",\n        "subtotal_include_tax": true,\n        "shipping_cost": 24,\n        "voucher_discount": 0,\n        "stores": "MINI,Madrid",\n        "is_first_order": true,\n        "voucher_discount_gbp": 0,\n        "orderDate": "3/20/2016",\n        "subtotal_eur": 63.68,\n        "subtotal_gbp": 49.99,\n        "subtotal": 70.72,\n        "subtotal_jpy": 8013.01,\n        "shown_creatives": [{\n            "cm": "96721",\n            "e": 21218\n        }, {\n            "cm": "137064",\n            "e": 28579\n        }, {\n            "cm": "178000",\n            "e": 36393\n        }, {\n            "cm": "298278",\n            "e": 56671\n        }, {\n            "cm": "299550",\n            "e": 56900\n        }],\n        "subtotal_usd": 70.72,\n        "shipping_cost_gbp": 16.97,\n        "voucher_discount_aud": 0,\n        "delivery": {\n            "address": "10 Test Street",\n            "city": "Testertown",\n            "state": "Test",\n            "postcode": "WC2 Test",\n            "country": "Testing"\n        },\n        "int_order_id": "5454819",\n        "linkshare_destination_currency": "GBP"\n    }\n  }\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ConfirmationPage1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"locationPlaceHolder":"END","name":"GA_Impressions_v2","description":"GA","disabled":true});var pkg="live.tags.gaimpressionsv2.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ListingPage2"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag"]);
tag.pre=function(){};tag.script=function(){function loaded(){var processedClass="impressed";var pageType=universal_variable.page.breadcrumb[1]+"-"+universal_variable.page.breadcrumb[2];var i=0;for(var len=universal_variable.listing.items.length;i<len;i++){ga("ec:addImpression",{"id":universal_variable.listing.items[i].id,"name":universal_variable.listing.items[i].name,"price":universal_variable.listing.items[i].unit_sale_price,"brand":universal_variable.listing.items[i].manufacturer,"category":universal_variable.listing.items[i].category,
"variant":universal_variable.listing.items[i].color,"list":pageType,"position":i});FFAPI.methods.addClass(FFAPI.lazy.imgs[i],processedClass)}ga("send","event","ecommerce","impressions",location.href,0,{nonInteraction:true})}document.addEventListener("DOMContentLoaded",loaded(),false)};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "MKT/TNT",\n ChangedBy: "Guilherme Quelhos",\n LastChangedDate: "27/02/2017",\n Description: "Tag disabled.  Tag irrelevant to the business."\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Yahoo (JP)","disabled":true,"id":35687063,"locked":false,"locationObject":"BODY"});var pkg="live.tags.yahoojp.Tag";
qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" language\x3d"javascript"\x3e\n/* \x3c![CDATA[ */\nvar yahoo_retargeting_id \x3d \'89FN5QWX8X\';\nvar yahoo_retargeting_label \x3d \'\';\n/* ]]\x3e */\n\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" language\x3d"javascript" src\x3d"https://b92.yahoo.co.jp/js/s_retargeting.js"\x3e\x3c/script\x3e';tag.addClientFiltersList(["live.filters.YahooJPQUBITGTM","live.filters.NotInJapan","live.filters.DefaultFilterMatchAll"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n\tVerticalTeam : "PRIME/MKT",\n\tAuthor : "",\n\tChangedBy : "Filipe Freitas",\n\tReviewer : "",\n\tLastChangedDate : "31/05/2016",\n\tVersion : "1.0",\n\tDescription : ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"BI Pixel Tracking","disabled":false,"id":35687088,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.bipixeltracking.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type \x3d "text/javascript"\x3e\n\tvar uniqueIdInc \x3d 1;\n\ttry {\n\t\tvar _fftrkobj \x3d {\n\t\t\ttrack : function (obj) {\n\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\ttid : obj.tid,\n\t\t\t\t\tval : obj.val,\n\t\t\t\t\ttt : 1\n\t\t\t\t};\n\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\t\t\t},\n\t\t\ttrackAppend : function (obj) {\n\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\ttid : obj.tid,\n\t\t\t\t\tval : obj.val,\n\t\t\t\t\ttt : 1\n\t\t\t\t};\n\t\t\t\t_fftrkobj.insertPixel(extraParam, true);\n\t\t\t},\n\t\t\tinsertPixel : function (extraParams, isAppend) {\n\t\t\t\tvar uv \x3d window.universal_variable;\n\t\t\t\tvar instanceId \x3d 0;\n\t\t\t\tif (typeof(uv.user.instanceId) !\x3d\x3d "undefined") {\n\t\t\t\t\tinstanceId \x3d uv.user.instanceId;\n\t\t\t\t}\n\t\t\t\tvar globalParams \x3d {\n\t\t\t\t\tpurl : typeof window.ffrefManager !\x3d "undefined" ? window.ffrefManager.getHrefUrl() : window.location.href,\n\t\t\t\t\tssid : uv.user.sessionId,\n\t\t\t\t\tcid : uv.user.country_id,\n\t\t\t\t\tild : uv.user.isLogged,\n\t\t\t\t\thv : \'Z\',\n\t\t\t\t\tckt : uv.user.checkoutType,\n\t\t\t\t\tirt : uv.user.returning,\n\t\t\t\t\tbid : universal_variable.user.basketId,\n\t\t\t\t\tiid : instanceId,\n\t\t\t\t\tckid : uv.user.cookieId,\n\t\t\t\t\tip : uv.user.ip,\n\t\t\t\t\tag : window.navigator.userAgent,\n\t\t\t\t\tifrs : uv.page.flatShipRate,\n\t\t\t\t\tref : typeof window.ffrefManager !\x3d "undefined" ? window.ffrefManager.getRefererUrl() : document.referrer,\n\t\t\t\t\tqlab : $.cookie(\'qubit_land_ab\'),\n\t\t\t\t\tblg : navigator.language || navigator.userLanguage,\n\t\t\t\t\tsfd : uv.page.subfolder,\n\t\t\t\t\tusfd : uv.user.userSubfolder,\n\t\t\t\t\tgsfd : uv.user.geoSubfolder,\n\t\t\t\t\tpgid : uv.page.pageId,\n\t\t\t\t\tjrd : uv.user.just_registered,\n\t\t\t\t\tret : uv.user.returning,\n\t\t\t\t\tibt : uv.user.isBot,\n\t\t\t\t\trnd : $.now()\n\t\t\t\t};\n\t\t\t\tvar settings;\n\t\t\t\tif (uv.user.isLogged) {\n\t\t\t\t\tvar userId \x3d {\n\t\t\t\t\t\tuid : uv.user.user_id\n\t\t\t\t\t}\n\t\t\t\t\tsettings \x3d $.extend({}, extraParams, globalParams, userId);\n\t\t\t\t} else {\n\t\t\t\t\tsettings \x3d $.extend({}, extraParams, globalParams);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(typeof(uv.listing) !\x3d\x3d "undefined") {\n\t\t\t\t  \n    \t\t\tif(typeof(uv.listing.designerId) !\x3d\x3d "undefined")\n    \t\t\t{\n    \t\t\t  settings \x3d $.extend({}, settings, { did: uv.listing.designerId });\n    \t\t\t}\n    \n    \t\t\tif(typeof(uv.listing.storeId) !\x3d\x3d "undefined")\n    \t\t\t{\n    \t\t\t  settings \x3d $.extend({}, settings, { sid: uv.listing.storeId });\n    \t\t\t}\n        }\n\n\t\t\t\t\n\t\t\t\tvar pixel \x3d "https://clickstream.farfetch.com/?" + jQuery.param(settings);\n\t\t\t\t//Changed in order to always create a new image instead of just changing the "src" attribute. \n\t\t\t\t//Some pages fire the pixel multiple times and since it is async, we think that the src might be replaced before actually firing the pixel\n\t\t\t\t//if ($("#uniquePixelId").length \x3e 0 \x26\x26 !isAppend) {\n\t\t\t\t//\t$("#uniquePixelId").attr(\'src\', pixel).attr("async", "");\n\t\t\t\t//} else {\n\t\t\t\tvar finalPixelId \x3d \'uniquePixelId\' + uniqueIdInc++;\n\t\t\t\t$(\'body\').append($(\'\x3cimg\x3e\').attr(\'style\', \'display:none\').attr(\'src\', pixel).attr(\'id\', finalPixelId).attr("async", ""));\n\t\t\t\t//}\n\t\t\t},\n\t\t\textract : function (elem) {\n\t\t\t\tif (elem \x26\x26 elem.length) {\n\t\t\t\t\tvar trkId \x3d elem.attr("trk");\n\t\t\t\t\tif (typeof(trkId) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t_fftrkobj.parse(trkId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tparse : function (trkId) {\n\t\t\t\tvar intObj \x3d -1;\n\t\t\t\tvar obj \x3d null;\n\t\t\t\tintObj \x3d parseInt(trkId);\n\t\t\t\tif (!isNaN(intObj)) {\n\t\t\t\t\tobj \x3d {\n\t\t\t\t\t\ttid : intObj,\n\t\t\t\t\t\tval : null\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tobj \x3d $.parseJSON(trkId);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tobj \x3d null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (obj !\x3d\x3d null) {\n\t\t\t\t\t_fftrkobj.track(obj);\n\t\t\t\t}\n\t\t\t},\n\t\t\tinit : function () {\n\t\t\t\tvar uv \x3d window.universal_variable;\n\t\t\t\tif (!uv.user.isBot) {\n\t\t\t\t\tvar pageId \x3d uv.page.pageId;\n\t\t\t\t\tswitch (pageId) {\n\t\t\t\t\tcase "product":\n\t\t\t\t\t\tvar extraParam \x3d {};\n\t\t\t\t\t\tif (!uv.product.hasStock) {\n\t\t\t\t\t\t\textraParam \x3d {\n\t\t\t\t\t\t\t\ttt : 2,\n\t\t\t\t\t\t\t\tpid : uv.product.id,\n\t\t\t\t\t\t\t\tcat : uv.product.categoryId,\n\t\t\t\t\t\t\t\tstk : "false"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\textraParam \x3d {\n\t\t\t\t\t\t\t\ttt : 2,\n\t\t\t\t\t\t\t\tsid : uv.product.storeId,\n\t\t\t\t\t\t\t\tpid : uv.product.id,\n\t\t\t\t\t\t\t\tupc : uv.product.currency,\n\t\t\t\t\t\t\t\tupr : uv.product.unit_sale_price,\n\t\t\t\t\t\t\t\tfpr : uv.product.unit_price,\n\t\t\t\t\t\t\t\tcat : uv.product.categoryId,\n\t\t\t\t\t\t\t\ttstk : uv.product.totalStock,\n\t\t\t\t\t\t\t\tstk : "true"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase "designers":\n\t\t\t\t\tcase "invite":\n\t\t\t\t\tcase "geral":\n\t\t\t\t\tcase "homepage":\n\t\t\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\t\t\ttt : 0\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase "listing":\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\t\t\t\ttt : 0,\n\t\t\t\t\t\t\t\tilc : FFAPI.listing.variables.hidJsonData.PagingData,\n\t\t\t\t\t\t\t\tcat : uv.listing.categoryId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\t\t\t\ttt : 0,\n\t\t\t\t\t\t\t\tilc : 0,\n\t\t\t\t\t\t\t\tcat : uv.listing.categoryId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// console.log("hidJsonData.Paging.PagingData.pt error code: " + e.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase "basket":\n\t\t\t\t\tcase "checkout":\n\t\t\t\t\tcase "shoppingbagempty":\n\t\t\t\t\t\tvar basketId \x3d 0;\n\t\t\t\t\t\tvar instanceId \x3d 0;\n\t\t\t\t\t\tif (typeof(uv.user.instanceId) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t\tinstanceId \x3d uv.user.instanceId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof(uv.user.basketId) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t\tbasketId \x3d uv.user.basketId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\t\t\ttt : 7,\n\t\t\t\t\t\t\tbid : basketId,\n\t\t\t\t\t\t\tiid : instanceId\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase "transaction":\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar basketId \x3d 0;\n\t\t\t\t\t\t\tvar instanceId \x3d 0;\n\t\t\t\t\t\t\tvar orderFromPortal \x3d 0;\n\t\t\t\t\t\t\tif (typeof(uv.user.basketId) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t\t\tbasketId \x3d uv.user.basketId;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof(uv.user.instanceId) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t\t\tinstanceId \x3d uv.user.instanceId;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof(uv.transaction.int_order_id) !\x3d\x3d "undefined") {\n\t\t\t\t\t\t\t\torderFromPortal \x3d uv.transaction.int_order_id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar extraParam \x3d {\n\t\t\t\t\t\t\t\ttt : 7,\n\t\t\t\t\t\t\t\tbid : basketId,\n\t\t\t\t\t\t\t\tiid : instanceId,\n\t\t\t\t\t\t\t\toid : orderFromPortal\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_fftrkobj.insertPixel(extraParam, false);\n\n\t\t\t\t\t\t\tffLogger.tagLogger("BI Pixel Tracking", extraParam, ffLogger.LogLevelEnum.INFO);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tffLogger.tagLogger("BI Pixel Tracking", e, ffLogger.LogLevelEnum.ERROR);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t$(document).bind("click", function (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\tvar elem \x3d $(e.target);\n\t\t\t\t\t_fftrkobj.extract(elem);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t */\n\n\t\t\t\t$(document).on("click", "[trk]", function (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar elem \x3d $(this);\n\t\t\t\t\t\t_fftrkobj.extract(elem);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t$(document).trigger(\'clickstream-loaded\');\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t};\n\n\t} catch (e) {\n\t\t// just in case\n\t}\n\t$(document).ready(function () {\n\t\t_fftrkobj.init();\n\t});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.ffrefmanager.Tag","live.tags.uvfixuserproperty.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"Rule - Basket","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var pkg="live.tags.rulebasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.Basket1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=
[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Bloomreach - Add to Basket","disabled":false,"id":55028223,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.bloomreachaddtobasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\ntry {\n    if (window.universal_variable.page.pageId \x3d\x3d\x3d "product") {\n        $(document).on(\'click\', \'.Go_AddToBag\', function() {\n            if ($(".addToBag_ModelError").attr("class").indexOf("hide") \x3e -1) {\n                bloomReachAddToBasket(window.universal_variable.product);\n            }\n        });\n    } else {\n        $(document).bind("BagUpdated", function(evt, product) {\n            bloomReachAddToBasket(product);\n        });\n    }\n\n    function bloomReachAddToBasket(product) {\n        try {\n            if (product !\x3d\x3d undefined) {\n                var json \x3d {\n                    \'prod_id\': product.id,\n                    \'sku\': product.id\n                };\n                BrTrk.getTracker().logEvent(\'cart\', \'click-add\', json);\n                ffLogger.tagLogger("Bloomreach - Add to Basket", json, ffLogger.LogLevelEnum.INFO);\n            }\n        } catch (a) {\n            ffLogger.tagLogger("Bloomreach - Add to Basket", a, ffLogger.LogLevelEnum.ERROR);\n        }\n    }\n} catch (e) {\n    ffLogger.tagLogger("Bloomreach - Add to Basket", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.IncludeIfCountryBloomreach","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.bloomreach.Tag","live.tags.ruleproductorbasketpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"UV - Fix User Property","disabled":false,"id":36630686,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.uvfixuserproperty.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  if(window.universal_variable.user.islogged !\x3d\x3d undefined){\n  \twindow.universal_variable.user.isLogged \x3d window.universal_variable.user.islogged;\n  }\n  if(window.universal_variable.user.chekcoutType !\x3d\x3d undefined){\n  \twindow.universal_variable.user.checkoutType \x3d window.universal_variable.user.chekcoutType;\n  }\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Google Universal Analytics","disabled":false,"id":35687350,"locked":false,"locationObject":"BODY"});var pkg="live.tags.googleuniversalanalytics.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']\x3dr;i[r]\x3di[r]||function(){\n(i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\nm\x3ds.getElementsByTagName(o)[0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "Filipe Freitas",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Criteo - Basket (Criteo countries only)","disabled":true,"id":35687028,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.criteobasketcriteocountriesonly.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://static.criteo.net/js/ld/ld.js" async\x3d"true"\x3e\x3c/script\x3e\n\x3cscript language\x3d"javascript"\x3e\n    try {\n      \n        var email \x3d window.universal_variable.user.hashedEmail ? window.universal_variable.user.hashedEmail : "";\n       email \x3d email ? email : (window.universal_variable.user.email ? window.universal_variable.user.email : "");\n  \n        $(document).bind("WishListUpdated", function(evt, product) {\n            criteoAddAction(\'AddToWishlist\', product);\n        });\n\n        if (window.universal_variable.page.pageId \x3d\x3d\x3d "product") {\n            $(document).on(\'click\', \'.Go_AddToBag\', function() {\n              if(window.Criteo_QUBIT_GTM !\x3d \'GTM\'){\n                if ($(".addToBag_ModelError").attr("class").indexOf("hide") \x3e -1) {\n                    criteoAddAction(\'AddToCart\', window.universal_variable.product);\n                }\n              }\n            });\n        } else {\n            $(document).bind("BagUpdated", function(evt, product) {\n              if(window.Criteo_QUBIT_GTM !\x3d \'GTM\'){\n                criteoAddAction(\'AddToCart\', product);\n              }\n            });\n        }\n\n        function criteoAddAction(action, productData) {\n            try {\n                if (productData !\x3d\x3d undefined) {\n                    var product \x3d {\n                        id: productData.id,\n                        price: productData.unit_price,\n                        quantity: productData.quantity\n                    };\n\n                    window.criteo_q \x3d window.criteo_q || [];\n\n                    window.criteo_q.push({\n                        event: "setAccount",\n                        account: ${criteo_accountId}\n                    }, {\n                        event: "setSiteType",\n                        type: "${siteType}"\n                    }, {\n                        event: "setHashedEmail",\n                        email: email\n                    }, {\n                        event: "viewBasket",\n                        item: [product]\n                    });\n                    var json \x3d {\n                        account: ${criteo_accountId},\n                        type: "${siteType}",\n                        item: product.id\n                    };\n                    ffLogger.tagLogger("Criteo - Basket", json, ffLogger.LogLevelEnum.INFO);\n                } \n            } catch (a) {\n                ffLogger.tagLogger("Criteo - Basket", a, ffLogger.LogLevelEnum.ERROR);\n            }\n        }\n\n        if (window.universal_variable.basket !\x3d\x3d undefined \x26\x26 window.universal_variable.basket.line_items !\x3d\x3d undefined) {\n            var basketProductsList \x3d window.universal_variable.basket.line_items;\n            window.criteo_q \x3d window.criteo_q || [];\n            window.criteo_q.push({\n                event: "setAccount",\n                account: ${criteo_accountId}\n            }, {\n                event: "setSiteType",\n                type: "${siteType}"\n            }, {\n                event: "setHashedEmail",\n                email: email\n            }, {\n                event: "viewBasket",\n                item: function() {\n                    var pl \x3d [];\n                    for (var i \x3d 0; i \x3c basketProductsList.length; ++i) {\n                        pl.push({\n                            id: basketProductsList[i].product.id,\n                            price: basketProductsList[i].product.unit_price,\n                            quantity: basketProductsList[i].quantity\n                        });\n                    }\n                    return pl;\n                }\n            });\n        }\n    } catch (e) {\n        ffLogger.tagLogger("Criteo - Basket", e, ffLogger.LogLevelEnum.ERROR);\n    }\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.IsListingOrBasketPageOrProductPage","live.filters.ExcludeIfNotCriteoCountry","live.filters.CriteoIsQubitEnabled"]);tag.addClientVariablesMap({"criteo_accountId":"live.variables.CriteoAccountId","siteType":"live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop"});tag.addParameters([{"name":"Criteo Account Id","description":null,"token":"criteo_accountId"},{"name":"Returns if device is mobile, tablet or desktop","description":null,"token":"siteType"}]);tag.genericDependencies=
[];tag.addClientDependenciesList(["live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Criteo - Homepage (Criteo countries only)","disabled":true,"id":35686949,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.criteohomepagecriteocountriesonly.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://static.criteo.net/js/ld/ld.js" async\x3d"true"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e\n\n  var email \x3d window.universal_variable.user.hashedEmail ? window.universal_variable.user.hashedEmail : "";\n  email \x3d email ? email : (window.universal_variable.user.email ? window.universal_variable.user.email : "");\n  \n  window.criteo_q \x3d window.criteo_q || [];\n  window.criteo_q.push(\n    { event: "setAccount", account: ${criteo_accountId}},\n    { event: "setSiteType", type: "${siteType}" },\n    { event: "setHashedEmail", email: email },        \n    { event: "viewHome"}\n  ); \n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.AllPagesExceptProductListingBasketOrConfirmationPage","live.filters.ExcludeIfNotCriteoCountry","live.filters.CriteoIsQubitEnabled"]);tag.addClientVariablesMap({"criteo_accountId":"live.variables.CriteoAccountId","siteType":"live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop"});tag.addParameters([{"name":"Returns if device is mobile, tablet or desktop","description":null,"token":"siteType"},{"name":"Criteo Account Id","description":null,"token":"criteo_accountId"}]);
tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Shopping Cart","disabled":false,"id":35686732,
"locked":false,"locationObject":"BODY"});var pkg="live.tags.certonashoppingcart.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\nvar resx \x3d {};\n\tresx.appid \x3d "Farfetch01";\n\tif (window.universal_variable.user.isLogged) {\n\t    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t} else {\n\t    resx.customerid \x3d "";\n\t}\n\tvar shoppingCartTotal;\n\tvar countryId \x3d window.universal_variable.user.country_id;\n\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\tif (typeof window.universal_variable.basket \x3d\x3d\x3d \'undefined\') {\n\t    shoppingCartTotal \x3d 0;\n\t} else {\n\t    shoppingCartTotal \x3d window.universal_variable.basket.total;\n\t}\n\tif (shoppingCartTotal) {\n\t    resx.rrelem \x3d "shoppingcart_rr;";\n\t    resx.event \x3d "cart";\n\t    var tmp1 \x3d window.universal_variable.basket.line_items;\n\t    var IDS \x3d [];\n\t    for (var i \x3d 0; i \x3c tmp1.length; i++) {\n\t        IDS.push(tmp1[i].product.id);\n\t    }\n\t    resx.itemid \x3d IDS.join(";") + ";";\n\t} else {\n\t    resx.event \x3d "cart";\n\t    resx.rrelem \x3d "emptycart_rr;";\n\t\n\t}\n\tresx.rrec \x3d true;\n\tresx.rrnum \x3d "10;";\n\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t    resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t}\n\tresx.rrqs \x3d $.param(resx.rrqs);\n\tvar url \x3d certonaResx.getURL();\n\t$.ajax({\n\t    url: url,\n\t    dataType: \'jsonp\',\n\t    jsonp: \'jsonp\',\n\t    timeout: 10000,\n\t    success: function (response) {\n\t        $(document).data("recommendations", response);\n\t    },\n\t    error: function () {\n\t        $(document).data("recommendations", false);\n\t    }\n\t});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ShoppingCart"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Carolina Cardoso",\n Reviewer: "",\n LastChangedDate: "19/10/2016",\n Version: "2.0",\n Description: "Add validation to check if pixel is not fire twice"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Riskified Beacon","disabled":true,"id":35687192,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.riskifiedbeacon.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e \n//\x3c![CDATA[\n(function() {\n  if(window.riskifiedAlreadyExists \x3d\x3d\x3d undefined){\n      var url \x3d \"https://beacon.riskified.com?shop\x3dfarfetch.com\x26sid\x3d\" + window.universal_variable.user.cookieId;\n      var s \x3d document.createElement('script');\n      s.type \x3d 'text/javascript';\n      s.async \x3d true;\n      s.src \x3d url;\n      var x \x3d document.getElementsByTagName('script')[0];\n      x.parentNode.insertBefore(s, x);\n      \n      window.riskifiedAlreadyExists \x3d true;\n    }\n})(); \n//]]\x3e\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n\tVerticalTeam : "PRIME/MKT",\n\tAuthor : "",\n\tChangedBy : "Filipe Freitas",\n\tReviewer : "",\n\tLastChangedDate : "01/06/2016",\n\tVersion : "1.0",\n\tDescription : ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Confirmation","disabled":true,"id":53044177,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.facebookconfirmation.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry {\n\tvar uv \x3d window.universal_variable;\n\tvar productList \x3d uv.transaction.line_items;\n\tvar productIds \x3d [];\n\tfor (i \x3d 0; i \x3c productList.length; i++) {\n\t\tproductIds.push(productList[i].product.id);\n\t}\n\n\tvar purchase \x3d {\n\t\tcontent_ids : productIds,\n\t\tcontent_type : 'product',\n\t\tvalue : uv.transaction.total,\n\t\tcurrency : uv.transaction.currency,\n\t\tnum_items : uv.transaction.line_items.length,\n\t\torder_id : uv.transaction.order_id\n\t};\n\n\tfbq('track', 'Purchase', purchase);\n\n\tffLogger.tagLogger(\"Facebook - Confirmation\", purchase, ffLogger.LogLevelEnum.INFO);\n} catch (e) {\n\tffLogger.tagLogger(\"Facebook - Confirmation\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.facebook.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"User Zoom - Feedback","disabled":true,"locked":false,"locationObject":"HEAD"});
var pkg="live.tags.userzoomuk.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\" language\x3d\"javascript\"\x3e\n  (function() {\n    var uz \x3d document.createElement('script'), uz.type \x3d 'text/javascript', uz.async \x3d true, uz.charset \x3d 'utf-8';\n    uz.src \x3d 'https://cdn4.userzoom.com/files/js/Qzc5OFQy.js?t\x3duz_feed\x26cuid\x3dA4AFCB4774DAE311BEDA0022196C4538';\n    var s \x3d document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uz, s);\n  })();\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.ExcludeIfNotUserZoomCountry"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Payment Info","disabled":true,"id":53044199,"locked":false,"locationObject":"BODY"});var pkg="live.tags.facebookpaymentinfo.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  fbq('track', 'AddPaymentInfo', {\n    currency: window.universal_variable.basket.currency, \n    value: window.universal_variable.basket.total\n  });\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.PaymentPage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_ClickTrackSend","disabled":true});var pkg="live.tags.gaclicktracksend.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ProductPage2"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag","live.tags.ffstorage1.Tag",
"live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){if(!FFStorage.checkStorageSupport())return;var storageKey="track_"+window.universal_variable.product.id;var localStorage=window.localStorage;var fromStorage=JSON.parse(localStorage.getItem(storageKey));if(fromStorage!==undefined&&fromStorage!==null){ga("ec:addProduct",{"id":fromStorage.id,"name":fromStorage.name,"price":fromStorage.unit_sale_price,"brand":fromStorage.manufacturer,"category":fromStorage.category,
"variant":fromStorage.color});ga("ec:setAction","click",{list:fromStorage.pageType});ga("send","event","ecommerce","product click",fromStorage.name,0,{nonInteraction:false});localStorage.removeItem(storageKey)}};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":-1,"async":true,"usesDocumentWrite":false,"name":"MediaForge (US)","disabled":false,"id":35686817,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.mediaforgeus.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n// Use any event to append the code\n$(document).ready(function() \n{\n    var s \x3d document.createElement("script");\n  \ts.type \x3d "text/javascript";\n \t  var merchantId \x3d "1564";\n  \tvar baseUrl \x3d "https://tags.mediaforge.com/js/" + merchantId + "/";\n     \n  \tswitch(universal_variable.page.pageId){\n      case "product":\n        s.src \x3d baseUrl + "?" + $.param({"prodID" : universal_variable.product.id});    \n        break;\n      \n      case "listing":\n        s.src \x3d baseUrl + "?" + $.param({"catID" : universal_variable.listing.categoryId});    \n        break;\n        \n      case "basket":\n        var lineItems \x3d  universal_variable.basket.line_items;\n\t\tvar itemsIds \x3d [];\n\t\tfor(var i \x3d 0; i\x3c lineItems.length; i++) {\n\t\t\t\titemsIds.push(universal_variable.basket.line_items[i].product.id);\n\t\t\t}\n        s.src \x3d baseUrl + "?" + $.param({"cart" : universal_variable.basket.total,\n                                  "prodID":itemsIds.join(",")                        \n                                  });    \n        break;\n\n      case "transaction":\n        s.src \x3d baseUrl + "?" + $.param({"orderNumber" : window.universal_variable.transaction.order_id,\n                                   "price" : window.universal_variable.transaction.subtotal_usd});    \n        break;\n      default:\n        s.src \x3d baseUrl;\n        break;\n      }\n  \tdocument.body.appendChild(s);\n});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfNotUnitedStates"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"FF - Clean Defined Duplicated Cookies"});var pkg="live.tags.ffcleandefinedduplicatedcookies.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  (function () {\n  \n  var subdomainsToRemoveCookies \x3d ['www.farfetch.com','secure.farfetch.com','www.secure.farfetch.com','email.farfetch.com','emailbr.farfetch.com','emailcis.farfetch.com'];\n  var cookieList \x3d ['_qsst_s','_qst_s','_qubitCountry'];\n  var expirationDate \x3d new Date(0);\n  \n  for (var i \x3d 0, len \x3d cookieList.length; i \x3c len; i ++)\n  {\n      for(var j \x3d 0, leny \x3d subdomainsToRemoveCookies.length; j \x3c leny; j ++)\n      {\n          document.cookie \x3d cookieList[i] + '\x3d0; expires\x3d' + expirationDate.toUTCString() + \";domain\x3d\" + subdomainsToRemoveCookies[j] + \";path\x3d/;secure;\";\n          //// DELETE HOST ONLY COOKIES\n          document.cookie \x3d cookieList[i] + '\x3d0; expires\x3d' + expirationDate.toUTCString() + \";path\x3d/;secure;\";\n      }\n  }\n})();\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.HasDefinedDuplicatedCookies"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Rule - Product or Basket Page"});var pkg="live.tags.ruleproductorbasketpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.OnlyProductAndBasketPages1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Baidu CN and HK - All Pages","disabled":true,"id":45800519,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.baiducnandhkallpages.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\nvar _hmt \x3d _hmt || [];\n(function() {\n  var hm \x3d document.createElement("script");\n  hm.src \x3d "https://hm.baidu.com/hm.js?f2215c076b3975f65e029fad944be10a";\n  document.body.appendChild(hm);\n})();\n\x3c/script\x3e';tag.addClientFiltersList(["live.filters.INSubfoldersCNOrHK"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);
tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"[PDP] Google Universal Analytics - Add to Basket","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var pkg="live.tags.pdpgoogleuniversalanalyticsaddtobasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry\n{\n  if (window.universal_variable.page.pageId \x3d\x3d\x3d \"product\") {\n     $('button[data-trk\x3daddToBag]').on('click',function(){\n  \t    gaAction('AddToCart',window.universal_variable.product);\n\t  });\n  } else {\n\t  $(document).bind(\"BagUpdated\", function(evt, product){ gaAction('AddToCart',product); });\n  }\n\n  function gaAction(action, product)\n  {\n    try\n    {\n      if(product !\x3d\x3d undefined){\n        ga('set', 'dimension1', product.id);\n      \tga('send', 'event', 'product actions', 'add to basket', product.name, product.id, true);\n      \t\n      \tvar json \x3d { productName: product.name, productId : product.id};\n      \tffLogger.tagLogger(\"Analytics - Basket\", json, ffLogger.LogLevelEnum.INFO);\n      }\n    } catch (a) {\n    \n      ffLogger.tagLogger(\"Analytics - Basket\", a, ffLogger.LogLevelEnum.ERROR);\n    }\n  }\n} catch (e) {\n  ffLogger.tagLogger(\"Analytics - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.OnlyProductAndBasketPages1","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.googleuniversalanalytics.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":-1,"async":true,"usesDocumentWrite":false,"name":"User in EU","disabled":false,"id":35686867,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.userineu.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e;\x3c/script\x3e";tag.addClientFiltersList(["live.filters.EU"]);tag.addClientVariablesMap({});
tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"FFAdblocker"});var pkg="live.tags.ffadblocker.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){FFAdblocker={};FFAdblocker.start=function(){this.maybeExecute=function(tagCodeToExecute){if(FFAdblocker.isEnabled===undefined){var adblockTester=
document.createElement("div");adblockTester.innerHTML="\x26nbsp",adblockTester.style.position="absolute",adblockTester.style.top="-100px",adblockTester.id="ads-banner",adblockTester.className="ads-block";document.body.appendChild(adblockTester);window.setTimeout(function(){if(adblockTester.offsetHeight===0)FFAdblocker.isEnabled=true;else{FFAdblocker.isEnabled=false;tagCodeToExecute()}},100)}else if(!FFAdblocker.isEnabled)tagCodeToExecute()}};FFAdblocker.start()};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Tapad"});var pkg="live.tags.tapad.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n  function createTapadImage() {\n    // Creates the image only if exists source\n    var cacheBuster \x3d Date.now();\n    var imageSrc \x3d "//tapestry.tapad.com/tapestry/1?ta_partner_id\x3d950\x26ta_redirect\x3d" + encodeURIComponent("https://t.myvisualiq.net/impression_pixel?r\x3d" + cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-30\x26si\x3d-30\x26ci\x3d-30\x26pi\x3d-354\x26ad\x3d-354\x26sv1\x3d-30\x26advt\x3d-30\x26chnl\x3d-30\x26vndr\x3d1138\x26u\x3dTAPAD_${IDS:key}\x26pt\x3di");\n    if (imageSrc.length \x3e 0) {\n      var image \x3d document.createElement("img");\n      image.style.width \x3d "1";\n      image.style.height \x3d "1";\n      image.src \x3d imageSrc;\n      image.style.display \x3d "none";\n  \n      document.body.appendChild(image);\n    }\n  }\n    \n  function createTapadCookie() {\n    var tapadCookie \x3d "TapadCookie_v2";\n    var days \x3d 7;\n    date \x3d new Date();\n    date.setTime(date.getTime()+(days*24*60*60*1000));\n    expires \x3d "; expires\x3d"+date.toGMTString();\n    document.cookie \x3d tapadCookie + \'\x3dtrue\' + expires + ";domain\x3d.${CURRENTDOMAIN}; path\x3d/;secure";\n  }\n  \n  function createTapadTag() {\n    createTapadImage();\n    createTapadCookie();\n  }\n  \n  $(document).ready(createTapadTag());\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.TapadCookieDoesNOTExist"]);tag.addClientVariablesMap({"CURRENTDOMAIN":"live.variables.CurrentDomain1"});tag.addParameters([{"name":"Current Domain","token":"CURRENTDOMAIN"}]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Qubit Save Affiliate Landing Details","description":'{\n VerticalTeam: "TNT/MKT",\n Author: "Qubit",\n ChangedBy: "Qubit",\n Reviewer: "",\n LastChangedDate: "30/03/2017",\n Version: "1.0",\n Description: ""\n}'});var pkg="live.tags.qubitsaveaffiliatelandingdetails.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.WaitForRequireHasNoFfReferrer"]);tag.addClientVariablesMap({"CURRENTDOMAIN":"live.variables.CurrentDomain1"});
tag.addParameters([{"name":"CURRENT DOMAIN","token":"CURRENTDOMAIN"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.qubitdeliver1.Tag"]);tag.pre=function(){};tag.script=function(){window.__qubit.amd.require(["cookieman"],function(cm){var statObj={name:"new-session-landing",category:"dedupe",version:1,mode:"live",landing:window.location.href,userID:cm.get("_qubitTracker").length&&cm.get("_qubitTracker")[0].value,referrer:document.referrer||"direct"};var href=window.location.href;
var cookieContent=cm.get("qb-landing-utm").length&&cm.get("qb-landing-utm")[0].value&&decodeURI(cm.get("qb-landing-utm")[0].value);var parseCookie=function(data){try{data=data&&JSON.parse(data)||{};data.delay=parseInt(data.delay,10)||new Date((new Date).getTime()+6E4*60*24*30)-0}catch(e){data={};data.delay=new Date((new Date).getTime()+6E4*60*24*30)-0}return data};var sendEvent=function(obj){window.universal_variable=window.universal_variable||{};window.universal_variable.events=window.universal_variable.events||
[];window.universal_variable.events.push(obj)};var resetBlockThisSession=function(data){if(data.blockThisSession){delete data.blockThisSession;delete data.blockCause}};var getAffiliate=function(affiliate){var affiliates={linkshare:["http://www.polyvore.com","http://www.lyst.com","http://www.rewardStyle.com","http://www.shoppingscanner.co.uk","http://www.milanstyle.com","http://www.shopstyle.fr","http://www.octer.co.uk","http://www.topcashback.co.uk","http://www.quidco.com","http://www.shopstyle.co.uk",
"http://www.dailymail.co.uk/","https://www.nuji.com","http://www.skimlinks.com","http://www.fashiola.co.uk","http://www.lustrelife.com","http://www.thesolesupplier.co.uk","http://reginachow.blogspot.com","http://www.rebatesme.com","http://www.shopcade.com","http://www.fashionsauce.co.uk","http://www.easyfundraising.org.uk","http://www.redcarpet-fashionawards.com","http://www.whowhatwear.com","http://rahilee.blog.me","http://www.sheerluxe.com","http://www.missstylish.co.uk","http://www.whowhatwear.co.uk",
"http://www.threadsstyling.com","http://www.endource.com","http://www.fashionbeans.com","http://www.wardrobeicons.com","http://www.ibuyclub.com/","http://www.solelinks.com","http://www.lwcloset.com/","http://moresneakers.com","http://www.honglingjin.co.uk","http://SneakerMth.com/","http://www.telegraph.co.uk","http://www.weibo.com/5885359931/","http://www.core8.com","https://partners.rewardgateway.co.uk/","http://www.nextjump.com/","http://viglink.com","http://www.digidip.net/en","http://www.meblogging.com",
"http://www.independent.co.uk/","http://www.lovefashionsales.com","http://www.bangli.uk","http://www.incentivenetworks.com/","http://www.chicmi.com/","http://www.thefashion.com","http://fastsole.co.uk","http://www.hinthint.com","http://www.coolspotters.com","http://www.purseblog.com/","http://www.secondkulture.com","www.confashions.blogspot.com","http://www.northernmagpie.com","http://https://www.youtube.com/channel/UCFFDDhKEm6nyFWV8WncAOkw","http://www.commeuncamion.com","http://www.kensingtonnomad.com",
"http://www.highsnobiety.com/","https://weshop.co.uk/","http://www.highststyle.co.uk","http://www.Carteracommerce.com","http://www.fortyfiveten.com","http://www.dealmoon.com/","http://givingassistant.org","http://www.shoppingscanner.com","http://www.stylinity.com","http://dealsea.com","http://stylesshopping.com","http://yieldkit.com","http://fashionstylist.com","http://www.starstyle.com","https://bam-x.com","http://www.linktech.cn","http://kojin-yunyu.net/","http://materialworld.co","https://www.lyst.com/",
"http://shmoter.ru","http://www.shopstyle.com","http://www.modalist.com","http://cools.com/","http://www.stylelounge.com/","http://www.shoptagr.com","https://heartit.kr","http://www.briholloway.com","http://www.weluvny.com/en/","http://polnakorzina.ru","http://www.fashiola.com","http://www.nextjump.com","http://modesens.com","http://www.ebates.com","http://bagsnob.com","http://www.shoppingJing.com","http://keepitchic.com","http://www.ebates.kr","http://stylemi.ru","http://www.dealam.com","http://www.mifanli.com",
"http://www.glamkids.com","http://www.linkhaitao.com","http://intheircloset.com","http://www.bhg.com/shop","http://www.brandreward.com/","http://vergle.com/","http://www.thezoereport.com","http://www.nettavisen.no/rabattkode/","http://arossgirl.com","http://www.on-mkt.com","http://onlineshopmy.com/","http://www.foenix.co","http://stylemi.co","http://shoerazzi.com","http://luxury.dealam.com","http://www.timeinc.com","http://sneakerhack.com/","http://www.incentivenetworks.com","http://www.brickandportal.com",
"http://freschstyle.com","http://www.stylonomy.com","http://www.kufed.com","http://www.stylezeitgeist.com","https://www.octer.com","http://www.trendmill.com","http://www.iclployalty.com","http://www.listupp.it","http://www.gocashback.com","http://www.flexoffers.com","http://www.hausofrihanna.com","http://www.haishang.cn","http://armarium.com","http://www.shopstyle.cn","http://www.55haitao.com","https://www.thinkover.com","http://thefashionmedley.com/","http://www.duomai.com","http://www.finder.com.au/shopping",
"http://www.goxip.com","http://www.shopback.sg","http://www.yiqifa.com","http://mastercardrewards.hk/","http://www.blinghour.com","http://fashionlane.com.au","http://www.linkprice.com/home/linkprice0101_eng.htm","http://www.biyroamer.com","http://www.kaigai2han.com/","http://mastercardrewards.cn/","http://www.promospro.com","http://cafe.naver.com/dieselmania","http://celiawong.com","http://www.shop.com","http://blog.naver.com/27dew","http://blog.naver.com/directpang","http://www.thebargainavenue.com.au",
"http://haitao.smzdm.com/","http://deals.huaren.us; http://forums.huaren.us","http://www.manqianmeng.com","http://blog.naver.com/halims83","http://www.buluanmai.com","http://www.shopstyle.com.au","http://www.eshops.com.au","http://blog.naver.com/hunyaholic","http://melbournewarehousesales.com.au","http://www.thelilacmannequin.com","https://www.stylicy.com/au/"],zanox:["http://www.VigLink.com","http://www.fashiola.fr","https://www.stylelounge.fr","http://sneakermyth.com","http://www.shoppingscanner.co.uk",
"http://listupp.com/","http://www.dealscove.com/","http://www.rewardStyle.com","http://digidip.net","http://skimlinks.com","http://fr.flayr.com/","https://twitter.com/ballinsneaks","http://publickids.com/","http://www.standard.co.uk/","http://www.37-express.com/fr/?___from_store\x3dcn","http://www.soleandshape.com/","http://yifenqian.fr/app","http://www.meschaussures.fr","https://www.codereductions.fr/","http://www.estelleblogmode.com","http://cityads.com","http://www.skimlinks.com","http://www.shoppingscanner.it",
"http://www.kleding.nl","http://listupp.it","http://www.fashiola.it","https://www.fashiola.ch","http://www.sellektor.com","http://www.shopalike.dk","http://www.fashiola.pl","https://www.fashiola.dk","http://www.fashiola.se","https://www.rebatly.com/es","http://www.thelabelfinder.nl","http://www.shopello.se","onlineshopping.miles-and-more.com","http://shoppable.nl","http://modasto.se","http://www.fashiola.pt","http://www.shopello.fi/","http://earnonline.flyingbluenews.com","http://www.footmall.se",
"http://www.wossel.com","https://gutscheine.heise.de","http://listupp.jp","http://fashiola.fi","http://www.couturefashion.nl/","http://www.champagnerzumfruehstueck.com","http://www.brandreward.com/","http://www.shopcade.com","http://www.stylehunt.dk","http://www.dogsanddresses.com","http://www.shopello.no","http://www.revendless.com","http://www.storetip.de","http://www.fashionfinder.nl","http://www.shoppingscanner.pl","http://www.fashiola.no","http://www.fashiola.es","http://es.listupp.com","http://descuentos.lavanguardia.com/",
"http://ibplustore.iberia.com/","http://www.catalogate.es","http://www.shoppingscanner.es"],admitad:["http://r24-tech.com","http://justbutik.ru/","http://lookbuck.com/","http://shopsy.com.ua/","http://likewear.ru/","http://shoppingsbest.ru/","http://mecash.ru/","http://\u043a\u0430\u043d\u0430\u0434\u0430\u0433\u0443\u0441.\u0440\u0444/","http://snik.co/","http://modamay.ru/","http://www.kz.clouty.com/","http://lepodium.ru/","https://smartshopper.ru/","http://lagarderob.ru/","http://moneyshopping.ru/",
"http://buduvmode.ru/","http://yieldkit.com/","https://target.mail.ru/","http://daybag.ru/","http://kelkoo.ru/","http://thestore.ru/","http://odevajka-obuvajka.ru/","http://www.be-in.ru/","http://goodlookapp.com/","https://www.youtube.com/user/DiGa3000/","http://fixon.ru/","http://by.megashop-online.ru/","https://themodish.ru/","https://www.youtube.com/user/ValeryDolgova","http://vk.com/sneakersearch","http://fashiondetails.ru/","http://dealr.ru/","http://telegram.me/epytombot","http://vk.com/"],
performancehorizon:["http://shopstyle.com.au","http://www.asperity.com","http://www.viglink.com","http://www.fashiola.es","http://www.thebargainavenue.com.au","http://www.cashrewards.com.au","http://www.kaigai2han.com/","http://www.dealmoon.com.au","https://shopping.avios.com/","http://www.promospro.co.uk/","http://www.shopstyle.co.uk","http://www.shopstyle.com.au","http://www.ebates.com","https://www.shopstyle.ca","http://skimlinks.com","http://www.blinghour.com","http://www.topcashback.com","http://www.mifanli.com",
"http://www.extrabux.com","https://www.chinesean.com","http://www.55haitao.com","http://www.duomai.com/","http://www.linkhaitao.com","http://www.xiyanghui.com/","http://modesens.com","http://www.shihuo.cn/","http://www.smzdm.com/","http://www.rebatesme.com","http://www.yiqifa.com","http://firefoxchina.net","https://www.shopstyle.de/","http://www.schnaeppchenfuchs.com","http://www.gutscheinrausch.de/","http://www.payback.de","http://www.shoop.de","http://www.style-observer.com","http://www.shoppingscanner.it",
"http://www.adgoal.de","https://www.stylelounge.nl/","http://Fashionhype.com","https://heartit.kr","http://www.ebates.kr","http://fashionlab.nl/","http://www.sneakers4u.nl","http://www.StyleLounge.nl","http://www.euroclix.nl","https://www.couturefashion.nl/","http://www.lyst.com","https://www.ozdiscount.net/","https://www.shopstyle.co.uk/","http://weibo.com/ukshopstop","http://www.brandreward.com/","http://www.dealmoon.com","http://givingassistant.org","http://www.mrrebates.com","http://cheepish.com/w888bizmarriottcsl/",
"http://www.gocashback.com","http://www.dealam.com","http://www.fashiola.de","http://www.fashiola.co.uk","http://www.fashiola.fr","http://www.kleding.nl","https://www.rewards-redspottedhanky.com/","https://www.shopping.ba.com","https://www.stylelounge.de","http://stylelounge.se","http://www.horloges4u.com","http://www.slipperswinkel.com","http://www.fyvor.com/","https://www.savelution.com/","https://www.allecodes.de/","https://www.codespromofr.com/","https://www.promospro.com"]};affiliates=affiliates[affiliate];
var matchingAffiliate=document.referrer.match(new RegExp(affiliates.join("|")));return matchingAffiliate&&matchingAffiliate[0]};var saveIfZanoxLinkshareAdmitadPerformanceHorizon=function(data){if(href.match(/utm_medium=(aff|referral)/i)||href.match(/src=(linkshare|zanox|admitad)/i)||href.match(/utm_campaign=PH(AU|CA|CN|FR|DE|IT|JP|KR|NL|ROW|UK|US)/ig)){var affiliate;if(href.match(/linkshare|zanox|admitad/i))affiliate=href.match(/linkshare|zanox|admitad/i);else if(href.match(/PH(AU|CA|CN|FR|DE|IT|JP|KR|NL|ROW|UK|US)/ig))affiliate=
["performancehorizon"];affiliate=affiliate&&affiliate[0]&&affiliate[0].toLowerCase();if(affiliate){data.delay=new Date((new Date).getTime()+6E4*60*24*30)-0;data.affiliate=affiliate}else{data.blockThisSession=true;data.blockCause="non-linkshare/zanox/admitad/performancehorizon affiliate"}}};var saveIfDisplayOrEmailLink=function(data){if(href.match(/utm_medium=(email|display)/i)&&!href.match(/AUTOMA|SAV_|BR_|WELCOM|Welcome1|AUTOMWISH/i)){data.blockThisSession=true;data.blockCause="email or display"}};
var saveIfSEOLink=function(data){if(/google|bing|yahoo|baidu|duckduckgo|exalead|gigablast|sogou|soso|volunia|yandex|yodao|dogpile|yippy|blingo|info|deeperweb|hotbot|kayak/.test(document.referrer)){data.blockThisSession=true;data.blockCause="seo"}};var saveIfPPCLink=function(data){var fromPPC=href.match(/(utm_medium=(cpc|paid_search|ppc)|gclid=|bfdqbt=)/i);var notBrand=href.match(/^((?!campaign=brand).)*$/i);if(fromPPC&&notBrand){data.blockThisSession=true;data.blockCause="ppc"}};var data$$0=parseCookie(cookieContent);
resetBlockThisSession(data$$0);saveIfZanoxLinkshareAdmitadPerformanceHorizon(data$$0);saveIfDisplayOrEmailLink(data$$0);saveIfSEOLink(data$$0);statObj.data=data$$0;sendEvent(statObj);if(data$$0.affiliate){if(getAffiliate(data$$0.affiliate))data$$0.affiliateDomain=getAffiliate(data$$0.affiliate);cm.set("qb-landing-utm",encodeURI(JSON.stringify(data$$0)),{path:"/",expires:new Date(data$$0.delay),domain:".farfetch.com"})}})};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"Google Universal Analytics - Generic Page View","active":true,"disabled":true,"locked":false,"locationObject":"HEAD","url":"","timeout":5E3});var pkg="live.tags.googleuniversalanalyticsgenericpageview.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  \tga('create', 'UA-3819811-6', 'auto', {'allowLinker': true});\n    if(window.universal_variable.user.user_id){\n      ga('set','\x26uid',window.universal_variable.user.user_id);\n    }\n     if(window.universal_variable.page.currency){\n      ga('set', '\x26cu', window.universal_variable.page.currency);\n    }\n    \n    var pagetype \x3d window.universal_variable.page.type\n    \n    // Creates an adblock detection custom dimension.\n    ga('provide', 'adblockTracker', function(tracker, opts) {\n      var ad \x3d document.createElement('ins');\n      ad.className \x3d 'AdSense';\n      ad.style.display \x3d 'block';\n      ad.style.position \x3d 'absolute';\n      ad.style.top \x3d '-1px';\n      ad.style.height \x3d '1px';\n      document.body.appendChild(ad);\n      tracker.set('dimension' + opts.dimensionIndex, !ad.clientHeight);\n      document.body.removeChild(ad);\n    });\n    \n    \n    ga('require', 'ec');\n  \tga('require', 'displayfeatures');\n   \tga('require', 'linkid', 'linkid.js');\n\t  ga('require', 'linker');\n\t  ga('linker:autoLink', ['farfetch.com', 'farfetch.cn']);\n\t  ga('require', 'adblockTracker', {dimensionIndex: 8});\n\t  ga('set', 'dimension11', pagetype);\n  \tga('send', 'pageview');\n\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Certona - Listing","disabled":false,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.certonalisting.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e \nvar resx \x3d {};\nvar multiSelectCallBackObject \x3d $("#MultiSelectCallbackCenter");\nif (multiSelectCallBackObject.length \x3e 0 \x26\x26 multiSelectCallBackObject.hasClass("qbit_ab_lnd") \x3d\x3d false) {\n    multiSelectCallBackObject.on("item-render.multiselect", function (e) {\n        if (e.fireCertona) {\n            resx.appid \x3d "Farfetch01";\n            if (window.universal_variable.user.isLogged) {\n                resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n            } else {\n                resx.customerid \x3d "";\n            }\n            resx.rrec \x3d true;\n            resx.rrelem \x3d "category_rr;";\n            resx.rrnum \x3d "10;";\n            var productList \x3d window.universal_variable.listing.items;\n            var productIds \x3d [];\n            for (i \x3d 0; i \x3c productList.length; i++) {\n                productIds.push(productList[i].id, ";");\n            }\n            resx.links \x3d productIds.join("");\n            var storeId \x3d "";\n            var categoryId \x3d "";\n            var Designername \x3d "";\n            if (window.universal_variable.listing.hasOwnProperty("storeId")) {\n                storeId \x3d window.universal_variable.listing.storeId;\n            }\n            if (window.universal_variable.listing.hasOwnProperty("categoryId")) {\n                categoryId \x3d window.universal_variable.listing.categoryId;\n            }\n            if (window.universal_variable.listing.hasOwnProperty("Designername")) {\n                Designername \x3d window.universal_variable.listing.Designername;\n            }\n            var genderId \x3d window.universal_variable.page.contextGenderId;\n            resx.rrqs \x3d {\n                countryid: window.universal_variable.user.country_id,\n                genderid: genderId,\n                storeid: storeId,\n                categoryid: categoryId,\n                designername: Designername\n            };\n            if (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n                resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n            }\n            resx.rrqs \x3d $.param(resx.rrqs);\n            var url \x3d certonaResx.getURL();\n            $.ajax({\n                url: url,\n                dataType: \'jsonp\',\n                jsonp: \'jsonp\',\n                timeout: 10000,\n                success: function (response) {\n                    if (window.location.href.indexOf("/sets/") \x3d\x3d\x3d -1) {\n                        $(document).data("recommendations", response);\n                    } else {\n                        $(document).data("recommendations", false);\n                    }\n                },\n                error: function () {\n                    $(document).data("recommendations", false);\n                }\n            });\n        }\n    });\n    \n\t$("#MultiSelectCallbackCenter").trigger({ type: "item-render.multiselect", fireCertona: true });\n} else {\n    var resx \x3d {};\n\tvar divNoRecordMoreInfoObject \x3d $(".divNoRecordMoreInfo");\n\tdivNoRecordMoreInfoObject.on("no-results-event", function (e) {\n\t\t\n\t\tresx.appid \x3d "Farfetch01";\n\t\tif (window.universal_variable.user.isLogged) {\n\t\t\tresx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t\t} else {\n\t\t\tresx.customerid \x3d "";\n\t\t}\n\t\tresx.rrec \x3d true;\n\t\tresx.rrelem \x3d "nosearch_rr";\n\t\tresx.rrnum \x3d "10;";\n\t\tvar countryId \x3d window.universal_variable.user.country_id;\n\t\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\t\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\t\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t\t\tresx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t\t}\n\t\tresx.rrqs \x3d $.param(resx.rrqs);\n\t\tvar url \x3d certonaResx.getURL();\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: \'jsonp\',\n\t\t\tjsonp: \'jsonp\',\n\t\t\ttimeout: 1000,\n\t\t\tsuccess: function (response) {\n\t\t\t\t$(document).data("recommendations", response);\n\t\t\t},\n\t\t\terror: function () {\n\t\t\t\t$(document).data("recommendations", false);\n\t\t\t}\n\t\t});\t\t\n\t});\n\t$(".divNoRecordMoreInfo").trigger("no-results-event");\n}\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ListingPage2","live.filters.Sets","live.filters.ExcludeSearchPages","live.filters.ExcludeLandingPages"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.rulelistingpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"DoubleClick Floodlight - Login","disabled":true});var pkg="live.tags.doubleclickfloodlightlogin.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\nvar uv \x3d window.universal_variable;\nvar axel \x3d Math.random() + "";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement("iframe");\nfl_if.src\x3d \'https://5472550.fls.doubleclick.net/activityi;src\x3d5472550;type\x3dmicro0;cat\x3dfarfe0\'+\n            \';u16\x3d\' + uv.user.country_code + //[country]\n            \';u17\x3d\' + uv.page.subfolder + //[subfolder]\n            \';u18\x3d\' + uv.user.just_registered + //[just_registered]\n            \';dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d\' + a + \'?\';\nfl_if.width\x3d"1";\nfl_if.height\x3d"1";\nfl_if.frameborder\x3d"0";\nfl_if.style.display \x3d "none";\ndocument.body.appendChild(fl_if);\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.LoginPage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Google Conversion Tracking (ROW)","disabled":true});var pkg="live.tags.googleconversiontrackingrow1.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\" src\x3d\"https://www.googleadservices.com/pagead/conversion_async.js\" charset\x3d\"utf-8\"\x3e\x3c/script\x3e\n\n\x3cscript type\x3d\"text/javascript\"\x3e\n    var googleConversionTracking \x3d (function () {\n        function googleConversionTracking() {\n            this.uv \x3d universal_variable;\n        }\n        googleConversionTracking.prototype.init \x3d function () {\n            try {\n                this.currencyJson \x3d this.setCurrencyByCountry();\n                this.setTrackConversion(this.currencyJson);\n            }\n            catch (e) {\n                ffLogger.tagLogger(\"Google Conversion Tracking\", e, ffLogger.LogLevelEnum.ERROR);\n            }\n        };\n        googleConversionTracking.prototype.setCurrencyByCountry \x3d function () {\n            switch (this.uv.user.country_code.toLowerCase()) {\n                case 'us':\n                case 'ca':\n                    return this.getCurrencyToUSD();\n                case 'jp':\n                    return this.getCurrencyToGBP();\n                case 'br':\n                    return this.getCurrencyToGlobal();\n                case 'uk':\n                    return this.getCurrencyToGBP();\n                case 'ru':\n                    return this.getCurrencyToGBP();\n                default:\n                    return this.getCurrencyToGBP();\n            }\n        };\n        googleConversionTracking.prototype.getCurrencyToUSD \x3d function () {\n            return { currency: 'USD', amount: this.uv.transaction.total_usd };\n        };\n        googleConversionTracking.prototype.getCurrencyToJPY \x3d function () {\n            return { currency: 'JPY', amount: this.uv.transaction.total_jpy };\n        };\n        googleConversionTracking.prototype.getCurrencyToGBP \x3d function () {\n            return { currency: 'GBP', amount: this.uv.transaction.total_gbp };\n        };\n        googleConversionTracking.prototype.getCurrencyToGlobal \x3d function () {\n            return { currency: this.uv.transaction.currency, amount: this.uv.transaction.total };\n        };\n        googleConversionTracking.prototype.setTrackConversion \x3d function (thisCurrencyJson) {\n            var request \x3d {\n                google_conversion_id: 992356468,\n                google_conversion_label: 'c_M2CKSykgcQ9NCY2QM',\n                google_conversion_language: 'en',\n                google_conversion_color: 'ffffff',\n                google_conversion_format: '1',\n                google_conversion_value: thisCurrencyJson.amount,\n                google_remarketing_only: false,\n                google_conversion_currency: thisCurrencyJson.currency\n            };\n            window.google_trackConversion(request);\n        };\n        return googleConversionTracking;\n    }());\n    \n    var thisConvertion \x3d new googleConversionTracking();\n    thisConvertion.init();\n\x3c/script\x3e";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Rule - Homepage","disabled":false,"id":35687296,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.rulehomepage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e;\x3c/script\x3e";tag.addClientFiltersList(["live.filters.Homepage2"]);tag.addClientVariablesMap({});
tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n Version: "1.1"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Criteo - Confirmation (Criteo countries only)","disabled":true,"id":35686985,"locked":false,"locationObject":"BODY"});var pkg="live.tags.criteoconfirmationcriteocountriesonly.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://static.criteo.net/js/ld/ld.js" async\x3d"true"\x3e\x3c/script\x3e \n\x3cscript type\x3d"text/javascript"\x3e\n\ttry {\n\t  \n\t  var email \x3d "";\n\t  if(window.universal_variable.page.pageStep){ //portal checkout\n\t    email \x3d window.universal_variable.user.email || "";\n\t  }else{ //old portal\n\t     email \x3d window.universal_variable.user.hashedEmail ? window.universal_variable.user.hashedEmail : "";\n       email \x3d email ? email : (window.universal_variable.user.email ? window.universal_variable.user.email : "");\n\t  }\n\t  \n\t\tvar transactionProductsList \x3d window.universal_variable.transaction.line_items;\n\t\twindow.criteo_q \x3d window.criteo_q || [];\n\t\twindow.criteo_q.push({\n\t\t\tevent : "setAccount",\n\t\t\taccount : ${criteo_accountId}\n\t\t}, {\n\t\t\tevent : "setSiteType",\n\t\t\ttype : "${siteType}"\n\t\t}, {\n\t\t\tevent : "setHashedEmail",\n\t\t\temail : email\n\t\t}, {\n\t\t\tevent : "trackTransaction",\n\t\t\tid : window.universal_variable.transaction.order_id,\n\t\t\titem : function () {\n\t\t\t\tvar pl \x3d [];\n\t\t\t\tfor (var i \x3d 0; i \x3c transactionProductsList.length; ++i) {\n\t\t\t\t\tpl.push({\n\t\t\t\t\t\tid : transactionProductsList[i].product.id,\n\t\t\t\t\t\tprice : transactionProductsList[i].product.unit_sale_price,\n\t\t\t\t\t\tquantity : transactionProductsList[i].quantity\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tffLogger.tagLogger("Criteo - Confirmation", {"items" : pl}, ffLogger.LogLevelEnum.INFO);\n\t\t\t\treturn pl;\n\t\t\t}\n\t\t});\n\n\t} catch (e) {\n\t\tffLogger.tagLogger("Criteo - Confirmation", e, ffLogger.LogLevelEnum.ERROR);\n\t}\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfNotCriteoCountry","live.filters.CriteoIsQubitEnabled"]);tag.addClientVariablesMap({"criteo_accountId":"live.variables.CriteoAccountId","siteType":"live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop"});tag.addParameters([{"name":"Criteo Account Id","description":null,"token":"criteo_accountId"},{"name":"Returns if device is mobile, tablet or desktop","description":null,"token":"siteType"}]);tag.genericDependencies=
[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"Bluekai - GiftGenerator","description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: "Pixel triggered when adding a product to wishlist"\n}',"disabled":false});var pkg="live.tags.bluekaigiftgenerator.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\ntry {\n\t\n$("#gg_game_cta").on(\'click\', function(){\n\n    if($(".GG__GiftGenerator__FormSection").length \x3d\x3d\x3d 3)\n    {\n        var whoAreYou;\n        var whoItFor;\n        var whoAreThey;\n\n        if($(".GG__GiftGenerator__FormSection:eq(0)").children().find(".GG__Select--highlighted").length \x3d\x3d\x3d 1)\n        {\n            whoAreYou \x3d $(".GG__GiftGenerator__FormSection:eq(0)").children().find(".GG__Select--highlighted").attr("data-value");\n        }\n\n\n        if($(".GG__GiftGenerator__FormSection:eq(1)").children().find(".GG__Select--highlighted").length \x3e\x3d 1)\n        {\n            var arrayInitGenerator \x3d $(".GG__GiftGenerator__FormSection:eq(1)").children().find(".GG__Select--highlighted");\n            var arrayValuesGenerator \x3d [];\n\n            for (i \x3d 0; i \x3c arrayInitGenerator.length; i++) { \n                arrayValuesGenerator.push(arrayInitGenerator[i].getAttribute("data-value"));\n            }\n\n\n            whoItFor \x3d arrayValuesGenerator.join(";");\n\n        }\n\n\n        if($(".GG__GiftGenerator__FormSection:eq(2)").children().find(".GG__Select--highlighted").length \x3d\x3d\x3d 1)\n        {\n            whoAreThey \x3d $(".GG__GiftGenerator__FormSection:eq(2)").children().find(".GG__Select--highlighted").attr("data-value");        \n        }\n\n        //-----------------------\n\n        if(typeof whoAreYou !\x3d\x3d "undefined")\n        {\n            bk_addPageCtx("Who are you?", whoAreYou);\n        }\n\n        if(typeof whoItFor !\x3d\x3d "undefined")\n        {\n            bk_addPageCtx("Who\'s it for?", whoItFor);\n        }\n\n        if(typeof whoAreThey !\x3d\x3d "undefined")\n        {\n            bk_addPageCtx("Are they?", whoAreThey);\n        }\n        \n        bk_ignore_meta \x3d true;\n\t\t\t\tbk_doJSTag(30341, 10);\n    }\n\n});\n\n} catch (e) {\n\tffLogger.tagLogger("Bluekai - GiftGenerator", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script \x3e';
tag.addClientFiltersList(["live.filters.GiftPage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.bluekaiv2.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"Bluekai - Subscribe Newsletter","description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Ricardo Silva",\n Reviewer: "",\n LastChangedDate: "08/09/2016",\n Version: "1.3",\n Description: "Added function definition validation"\n}',"disabled":false});var pkg="live.tags.bluekaisubscribenewsletter.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\nif(typeof bk_addPageCtx \x3d\x3d\x3d "undefined" || typeof bk_doJSTag \x3d\x3d\x3d "undefined"){ throw new Error("There was an error with Bluekai (subscribe) tag"); }\n$(document).on(\'subscribedEmail\', function() {\n    var uv \x3d universal_variable;\n    bk_addPageCtx("PageType", uv.page.pageId);\n    bk_addPageCtx("Subfolder", uv.page.subfolder);\n    bk_addPageCtx("NewCustomer", uv.user.returning);\n    bk_addPageCtx("SubscribedEmail", "true");\n    bk_addPageCtx("__bk_l", window.location);\n    bk_addPageCtx("Cat_Gender", "");\n\n    bk_ignore_meta \x3d true;\n    bk_doJSTag(30341, 10);\n})\n\x3c/script\x3e';
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.bluekaiv2.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Error","disabled":false,"id":35686759,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.certonaerror.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\n  var resx \x3d {};\n\tresx.appid \x3d "Farfetch01";\n\tif (window.universal_variable.user.isLogged) {\n\t    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t} else {\n\t    resx.customerid \x3d "";\n\t}\n\tvar countryId \x3d window.universal_variable.user.country_id;\n\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\tresx.rrec \x3d true;\n\tresx.rrelem \x3d "error_rr;";\n\tresx.rrnum \x3d "10;";\n\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t    resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t}\n\tresx.rrqs \x3d $.param(resx.rrqs);\n\tvar url \x3d certonaResx.getURL();\n\t$.ajax({\n\t    url: url,\n\t    dataType: \'jsonp\',\n\t    jsonp: \'jsonp\',\n\t    timeout: 10000,\n\t    success: function (response) {\n\t        $(document).data("recommendations", response);\n\t    },\n\t    error: function () {\n\t        $(document).data("recommendations", false);\n\t    }\n\t});\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ErrorPage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.rulelandingpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Listing","disabled":true,"id":53044191,"locked":false,"locationObject":"BODY"});var pkg="live.tags.facebooklisting.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  if(window.universal_variable.page.category !\x3d\x3d undefined){\n    fbq('track', 'ViewContent', {\n      content_category: window.universal_variable.page.category\n    });\n  }else if(window.universal_variable.page.search_term !\x3d\x3d undefined){\n  \tfbq('track', 'Search', {\n      search_string: window.universal_variable.page.search_term\n    });\n  }\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag","live.tags.rulelistingpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Rule - Debug Mode","disabled":false,"id":35687349,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.ruledebugmode.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e;\x3c/script\x3e";tag.addClientFiltersList(["live.filters.IsDebugMode"]);tag.addClientVariablesMap({});
tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":true,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "Filipe Freitas",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: "Track orders from Linkshare"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Linkshare - Transaction","disabled":false,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.linksharetransaction.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript language\x3d"javascript"\x3e\n\n    Date.prototype.getMonthFormatted \x3d function() {\n        var month \x3d this.getUTCMonth() + 1;\n        return month \x3c 10 ? \'0\' + month : month;\n    }\n    Date.prototype.getDateFormatted \x3d function() {\n        var date \x3d this.getUTCDate();\n        return date \x3c 10 ? \'0\' + date : date;\n    }\n    Date.prototype.getHoursFormatted \x3d function() {\n        var hour \x3d this.getUTCHours();\n        return hour \x3c 10 ? \'0\' + hour : hour;\n    }\n    Date.prototype.getMinutesFormatted \x3d function() {\n        var minutes \x3d this.getUTCMinutes();\n        return minutes \x3c 10 ? \'0\' + minutes : minutes;\n    }\n\n    var initLinkShareLog \x3d (function(){\n      \n      initLinkShareLog.prototype.init \x3d function (jsonLog) {\n      \n         try{\n        \n            (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']\x3dr;i[r]\x3di[r]||function(){\n                (i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\n                m\x3ds.getElementsByTagName(o)\n                [0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n                })(window,document,\'script\',\'//www.google-analytics.com/analytics.js\',\'ga\');\n              \n            ga(\'create\', \'UA-91193943-1\', \'auto\', \'tntTracker\');\n            ga(\'tntTracker.send\', \'event\', \'Live\', \'Linkshare Transaction\', JSON.stringify(jsonLog));\n       \n         }\n         catch(e)\n         {\n           \n         \n         }\n\n      };\n    \n    \n    });\n\n\n    (function() {\n\n        var source \x3d \'\';\n        \n        var _getCookieValue \x3d function(cookieName)\n        {\n            var name \x3d cookieName + "\x3d";\n            var decodedCookie \x3d decodeURIComponent(document.cookie);\n            var ca \x3d decodedCookie.split(";");\n            for(var i \x3d 0; i \x3c ca.length; i++) {\n                var c \x3d ca[i];\n                while (c.charAt(0) \x3d\x3d " ") {\n                    c \x3d c.substring(1);\n                }\n                if (c.indexOf(name) \x3d\x3d\x3d 0) {\n                    var rawValue \x3d c.substring(name.length, c.length);\n                    return JSON.parse(rawValue);\n                }\n            }\n            return [];\n        };\n\n        var getLinkshareFormatedDate \x3d function(date)\n        {\n            var thisDate \x3d new Date(date);\n            if(!thisDate || isNaN(thisDate.getTime()))\n            {\n                source \x3d \'Portal\';\n                return date;\n            }\n\n            source \x3d \'PortalCheckout\'; \n            return thisDate.getUTCFullYear().toString() + thisDate.getMonthFormatted().toString() + thisDate.getDateFormatted().toString() + \'_\' + thisDate.getHoursFormatted().toString() + thisDate.getMinutesFormatted().toString();\n        }\n\n        var formatPrice \x3d function(value) {\n            return Math.round(value * 100);\n        };\n\n        var calcTotalDiscountValueFromBasePrice \x3d function(unitbasePrice, discountPercentagePromoCode) {\n            var totalPriceWithoutVat \x3d unitbasePrice;\n            discountPercentagePromoCode \x3d parseFloat(discountPercentagePromoCode);\n            //Calc the % of discount\n            if (!isNaN(discountPercentagePromoCode) \x26\x26 discountPercentagePromoCode \x3e 0 \x26\x26 discountPercentagePromoCode \x3c\x3d 100) {\n                //Removing the promo code value from the total\n                totalPriceWithoutVat \x3d (unitbasePrice - (unitbasePrice * (discountPercentagePromoCode / 100.0)));\n            }\n\n            return Math.round(totalPriceWithoutVat);\n        };\n\n        try {\n            var uv, order_line, order_line_IDS, order_line_Vals,\n                order_line_Qty, i, x, linkSharePixelUrl,\n                valueUrl, skuprefix,\n                linkshare_currency, linkshare_affiliate_mid,\n                linkshare_date, linkshare_site_id, order_total, line_total;\n\n            uv \x3d window.universal_variable;\n\t\n            linkshare_currency \x3d uv.transaction.linkshare_destination_currency ? uv.transaction.linkshare_destination_currency : \'\';\n            linkshare_affiliate_mid \x3d uv.transaction.linkshare_affiliate_mid ? uv.transaction.linkshare_affiliate_mid : \'\';\n            linkshare_date \x3d getLinkshareFormatedDate(uv.transaction.linkshare_date ? uv.transaction.linkshare_date : \'\');\n            linkshare_site_id \x3d uv.transaction.linkshare_site_id ? uv.transaction.linkshare_site_id : \'\'; \n\n            var logInfo \x3d {\n                uv_page_subfolder: uv.page.subfolder,\n                uv_transaction_linkshare_site_id: linkshare_site_id,\n                uv_transaction_linkshare_affiliate_mid: linkshare_affiliate_mid,\n                uv_transaction_linkshare_date: linkshare_date,\n                uv_transaction_orderCode: uv.transaction.order_id,\n                uv_user_geoCountryId: uv.user.geoCountryId,\n                uv_user_geoSubfolder: uv.user.geoSubfolder\n            };\n            ffLogger.tagLogger("Linkshare - Transaction", logInfo, ffLogger.LogLevelEnum.INFO);\n\n            valueUrl \x3d "ep";\n            order_line \x3d uv.transaction.line_items;\n            order_line_IDS \x3d [];\n            order_line_Vals \x3d [];\n            order_line_Qty \x3d [];\n\n            \n            //SKUPREFIX LOGIC\t\t\n      \t\t\t\n\t\t\t\n            if (universal_variable.user.returning) {\n                skuprefix \x3d "R_";\n            } else {\n                skuprefix \x3d "";\n            }\n            \n            var jsonLog \x3d [];\n          \n\n            order_total \x3d 0.0;\n            for (i \x3d 0; i \x3c order_line.length; i++) {\n                order_line_IDS.push(skuprefix + order_line[i].product.id);// + "_" + order_line[i].product.selectedRealSize);\n                order_line_Qty.push(order_line[i].quantity);\n                switch (linkshare_currency) {\n                    case "GBP":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_gbp * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        \n                        \n                        jsonLog.push(\n                          {\n                            lineTotal: line_total,\n                            expValue: order_line[i].product.unit_base_price_gbp,\n                            orderID : uv.transaction.int_order_id, \n                            orderLine:order_line[i],\n                            currency: linkshare_currency\n                          });\n                        \n                        \n                        break;\n                    case "AUD":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_aud * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        \n                          jsonLog.push(\n                          {\n                            lineTotal: line_total,\n                            expValue: order_line[i].product.unit_base_price_aud,\n                            orderID : uv.transaction.int_order_id, \n                            orderLine:order_line[i],\n                            currency: linkshare_currency\n                          });\n                        \n                        break;\n                    case "USD":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_usd * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        \n                          jsonLog.push(\n                          {\n                            lineTotal: line_total,\n                            expValue: order_line[i].product.unit_base_price_usd,\n                            orderID : uv.transaction.int_order_id, \n                            orderLine:order_line[i],\n                            currency: linkshare_currency\n                          });\n                        \n                        break;\n                    case "EUR":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(formatPrice(order_line[i].product.unit_base_price_eur * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        \n                          jsonLog.push(\n                          {\n                            lineTotal: line_total,\n                            expValue: order_line[i].product.unit_base_price_eur,\n                            orderID : uv.transaction.int_order_id, \n                            orderLine:order_line[i],\n                            currency: linkshare_currency\n                          });\n                        \n                        break;\n                    case "JPY":\n                        line_total \x3d calcTotalDiscountValueFromBasePrice(Math.round(order_line[i].product.unit_base_price_jpy * order_line[i].quantity), order_line[i].product.discount_percentage_promoCode);\n                        order_line_Vals.push(line_total);\n                        order_total +\x3d line_total;\n                        \n                          jsonLog.push(\n                          {\n                            lineTotal: line_total,\n                            expValue: order_line[i].product.unit_base_price_jpy,\n                            orderID : uv.transaction.int_order_id, \n                            orderLine:order_line[i],\n                            currency: linkshare_currency\n                          });\n                        \n                        break;\n                }\n            }\n\n            var s \x3d document.createElement("img");\n            s.style.width \x3d \'1px\';\n            s.style.height \x3d \'1px\';\n            s.style.display \x3d "none";\n\n            linkSharePixelUrl \x3d \n                "https://track.linksynergy.com/" +\n                valueUrl +\n                "?mid\x3d" + linkshare_affiliate_mid +\n                "\x26ord\x3d" + uv.transaction.order_id +\n                "\x26tr\x3d" + linkshare_site_id +\n                "\x26land\x3d" + linkshare_date +\n                "\x26skulist\x3d" + order_line_IDS.join("|") + // join array using "|"\n                "\x26qlist\x3d" + order_line_Qty.join("|") + // join array using "|"\n                "\x26amtlist\x3d" + order_line_Vals.join("|") + // join array using "|"\n                "\x26cur\x3d" + linkshare_currency +\n                "\x26img\x3d1";\n\n            //Save the pixel request into database\n            var linkshareRequestParams \x3d \'\';\n            try {\n                linkshareRequestParams \x3d\n                    "mid\x3d" + linkshare_affiliate_mid +\n                    ";ord\x3d" + uv.transaction.order_id +\n                    ";tr\x3d" + linkshare_site_id +\n                    ";land\x3d" + linkshare_date +\n                    ";skulist\x3d" + order_line_IDS.join("|") + // join array using "|"\n                    ";qlist\x3d" + order_line_Qty.join("|") + // join array using "|"\n                    ";amtlist\x3d" + order_line_Vals.join("|") + // join array using "|"\n                    ";cur\x3d" + linkshare_currency +\n                    ";source\x3d" + source +\n                    ";host\x3d" + document.location.host;\n\n                $.ajax({\n                    url: window.location.origin + uv.page.subfolder + "/Linkshare/RegisterPixelRequest",\n                    data: {\n                        orderId: "" + uv.transaction.int_order_id,\n                        request: linkshareRequestParams\n                    },\n                    dataType: "application/json",\n                    method: "POST"\n                });\n            } catch (e) {\n                var thisinitLinkShareLog \x3d new initLinkShareLog();\n                thisinitLinkShareLog.init(\'RegisterPixelRequest error. OrderId: \' + uv.transaction.order_id);    \n              \n                var logError \x3d {\n                    message: "Save the pixel request into database: " + e.message\n                };\n                ffLogger.tagLogger("Linkshare - Transaction", e, ffLogger.LogLevelEnum.ERROR);\n            }\n\n            s.src \x3d linkSharePixelUrl;\n            document.body.appendChild(s);\n            \n            var thisinitLinkShareLog \x3d new initLinkShareLog();\n            thisinitLinkShareLog.init(linkshareRequestParams);  \n        } catch (e) {\n           var thisinitLinkShareLog \x3d new initLinkShareLog();\n            thisinitLinkShareLog.init(\'error\');  \n            ffLogger.tagLogger("Linkshare - Transaction", e, ffLogger.LogLevelEnum.ERROR);\n        }\n    }());\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DedupeV2"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "MKT/TNT",\n ChangedBy: "Guilherme Quelhos",\n LastChangedDate: "21/02/2017",\n Description: "Tag disabled.  Tag irrelevant to the business."\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Twitter Transactions Conversion Tracking","disabled":true,"id":38668969,"locked":false,"locationObject":"HEAD"});
var pkg="live.tags.twittertransactionsconversiontracking.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://platform.twitter.com/oct.js" type\x3d"text/javascript"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e\nif(typeof twttr \x3d\x3d\x3d "undefined"){ throw new Error("There was an error with Twitter Transaction tag"); }\ntwttr.conversion.trackPid(\'l5lln\');\n\x3c/script\x3e';tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.NotFireInChina"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Rule - Landing Page","disabled":false,"id":45315880,"locked":false,"locationObject":"BODY"});var pkg="live.tags.rulelandingpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.LandingPage","live.filters.LandingHomepage"]);tag.addClientVariablesMap({});
tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"User Zoom - Intercept","disabled":true,"locked":false,"locationObject":"HEAD"});
var pkg="live.tags.userzoominterceptuk.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\" language\x3d\"javascript\"\x3e\n  (function() {\n    var uz \x3d document.createElement('script'), uz.type \x3d 'text/javascript', uz.async \x3d true, uz.charset \x3d 'utf-8';\n    uz.src \x3d 'https://cdn4.userzoom.com/files/js/Qzc5OFQ0.js?t\x3duz_til\x26cuid\x3dA4AFCB4774DAE311BEDA0022196C4538';\n    var s \x3d document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uz, s);\n  })();\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.ExcludeIfNotUserZoomCountry"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"Inside Chat","description":"Inside Chat","disabled":true,"locationObject":"BODY"});var pkg="live.tags.insidechat.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n\nfunction bindBtns(){\n\n$(document).on('click', 'input', function(e) {\n  \n  if(e.target.id \x3d\x3d\x3d 'inside_chatSendButton' || e.target.parentElement.id \x3d\x3d\x3d 'inside_chatSendButton') {\n    console.log('C479');\n    _fftrkobj.track({tid:479, val: \"ClickedOnSend\"})\n  }\n});\n\n$(document).on('keyup', 'textarea', function(e) {\n  \n  if(e.which \x3d\x3d 13 \x26\x26 (e.target.id \x3d\x3d\x3d 'inside_chatInput' || e.target.parentElement.id \x3d\x3d\x3d 'inside_chatInput')){\n    console.log('C479');\n    _fftrkobj.track({tid:479, val: \"ChatTextEnter\"})\n  }\n});\n\n};\n\n$(document).ready(new function(){\n    bindBtns();\n});\n\n(function(url, tagName, container) { \n   var element \x3d container.createElement(tagName);\n   element.type \x3d 'text/javascript';\n   element.async \x3d true;\n   element.src \x3d '//'+ url; \n   var child \x3d container.getElementsByTagName(tagName)[0]; \n   child.parentNode.insertBefore(element, child);\n   \n})('us-tracker.inside-graph.com/gtm/IN-1000490/include.js','script', document);\n\nconsole.log('ChatFF');\n\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.CSTermsAndConditions","live.filters.CSReturnsAndRefunds","live.filters.CSPrivacyAndCookiePolicy","live.filters.CSOrdersAndShipping","live.filters.CSHowToShop","live.filters.CSFAQs","live.filters.CSContactUS","live.filters.CSClickAndCollect","live.filters.CSHolidayNeedToKnow"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"https://dd6zx4ibq538k.cloudfront.net/smartserve-2034.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Qubit Deliver (2)","disabled":false,
"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubitdeliver1.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"DoubleClick Floodlight - ContactUs Confirm","disabled":true});var pkg="live.tags.doubleclickfloodlightcontactusconfirm.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\nvar axel \x3d Math.random() + "";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement("iframe");\nfl_if.src\x3d \'https://5472550.fls.doubleclick.net/activityi;src\x3d5472550;type\x3dmicro0;cat\x3dfarfe000;dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d\' + a + \'?\';\nfl_if.width\x3d"1";\nfl_if.height\x3d"1";\nfl_if.frameborder\x3d"0";\nfl_if.style.display \x3d "none";\ndocument.body.appendChild(fl_if);\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ContactUsConfirm"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"dtxtngytz5im1.cloudfront.net/qtracker-5.0.0.min.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"Qubit QTracker (New)",
"disabled":false,"id":35686881,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubitqtrackernew.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){window._qtd=[{options:{domain:".farfetch.com",serverUrl:"pong.qubitproducts.com/t2",clientId:"farfetch"}}];_qtd.push({custom:{_c_sc_sub:{type:"fn",key:function(){return $(".lbSubTotal").text().replace(/[^0-9\.]/g,
"")},pattern:"newcheckb4.aspx"}}});_qtd.push({custom:{_c_sc_dc:{type:"fn",key:function(){return $(".lbShippingTotal").text().replace(/[^0-9\.]/g,"")},pattern:"newcheckb4.aspx"}}});_qtd.push({custom:{_c_sc_val:{type:"fn",key:function(){return $(".lbShoppingTotal").text().replace(/[^0-9\.]/g,"")},pattern:"newcheckb4.aspx"}}});_qtd.push({custom:{_c_con_ct:{type:"fn",key:function(){if(window.$&&window.$(".lbShoppingTotal").length>0)return $(".lbShoppingTotal").text();else return null},pattern:"newcheckb5.aspx"}}});
_qtd.push({custom:{_c_con_msg:{type:"id",key:"ctl00_ctl00_dvMessages",pattern:"newcheckb1.aspx?rnd\x3d"}}});_qtd.push({custom:{_c_sc_cu:{type:"fn",key:function(){if(window.$){var value=$(".lbShoppingTotal").text();if(!value)return null;if(value.indexOf("\u00a3")>=0)return"GBP";if(value.indexOf("\u20ac")>=0)return"EUR";if(value.indexOf("$")>=0)return"USD";return"OTHER:"+value}},pattern:"newcheckb4.aspx"}}});_qtd.push({custom:{_c_con_cu:{type:"fn",key:function(){if(window.$){var value=$(".lbShoppingTotal").text();
if(!value)return null;if(value.indexOf("\u00a3")>=0)return"GBP";if(value.indexOf("\u20ac")>=0)return"EUR";if(value.indexOf("$")>=0)return"USD";return"OTHER:"+value}},pattern:"newcheckb5.aspx"}}});_qtd.push({custom:{_c_op_bu:{type:"fn",key:function(){if(document.cookie.indexOf("optimizelyBucket")>=0){var cookie=document.cookie.indexOf("optimizelyBucket");var ___dc=document.cookie.substring(cookie);return ___dc.substring(18,___dc.indexOf("; "))}},pattern:".*"}}});_qtd.push({custom:{_c_cookie:{type:"fn",
key:function(){var readCookie=function(name){var nameEQ=name+"\x3d";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){for(var c=ca[i];c.charAt(0)==" ";)c=c.substring(1,c.length);if(c.indexOf(nameEQ)===0)return c.substring(nameEQ.length,c.length)}return null};var cookieName="s_kenid";var value=readCookie(cookieName);if(value)return{name:cookieName,value:value};else return null},pattern:".*"}}})};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"Certona - My Account","disabled":false,"id":35686773,
"locked":false,"locationObject":"BODY"});var pkg="live.tags.certonamyaccount.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\nvar resx \x3d {};\n\tresx.appid \x3d "Farfetch01";\n\tif(window.universal_variable.user.isLogged){\n\t    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t} else {\n\t    resx.customerid \x3d "";\n\t}\n\tcertonaResx.run();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.MyAccount"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Home","disabled":false,"id":35686746,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.certonahome.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\n  var resx \x3d new Object();\n\tresx.appid \x3d "Farfetch01";\n\tif (window.universal_variable.user.isLogged) {\n\t    resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t} else {\n\t    resx.customerid \x3d "";\n\t}\n\tvar countryId \x3d window.universal_variable.user.country_id;\n\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\tresx.rrec \x3d true;\n\tresx.rrelem \x3d "home_rr;";\n\tresx.rrnum \x3d "6;";\n\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t    resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t}\n\tresx.rrqs \x3d $.param(resx.rrqs);\n\tvar url \x3d certonaResx.getURL();\n\t$.ajax({\n\t    url: url,\n\t    dataType: \'jsonp\',\n\t    jsonp: \'jsonp\',\n\t    success: function (response) { },\n\t    error: function () { }\n\t});\n\x3c/script\x3e';
tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.rulehomepage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"DoubleClick Floodlight - ContactUs","disabled":true});var pkg="live.tags.doubleclickfloodlightcontactus.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\nvar axel \x3d Math.random() + "";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement("iframe");\nfl_if.src\x3d \'https://ad.doubleclick.net/ddm/activity/src\x3d5472550;type\x3dmicro0;cat\x3dfarfe001;dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d\' + a + \'?\';\nfl_if.width\x3d"1";\nfl_if.height\x3d"1";\nfl_if.frameborder\x3d"0";\nfl_if.style.display \x3d "none";\ndocument.body.appendChild(fl_if);\n\x3c/script\x3e';tag.addClientFiltersList(["live.filters.ContactUsPage"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "MKT/TNT",\n ChangedBy: "Guilherme Quelhos",\n LastChangedDate: "21/02/2017",\n Description: "Tag disabled.  Tag irrelevant to the business."\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Twitter Audience Conversion Tracking","disabled":true,"id":38668958,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.twitteraudienceconversiontracking.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://platform.twitter.com/oct.js" type\x3d"text/javascript"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e\n  if(typeof twttr \x3d\x3d\x3d "undefined"){ throw new Error("There was an error with Twitter Audience tag"); }\n  twttr.conversion.trackPid(\'l5lll\');\n\x3c/script\x3e';tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.NotFireInChina"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_ProductDetailPageView","description":"Product Detail Page View","disabled":true});var pkg="live.tags.gaproductdetailpageview.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ProductPage2"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalyticsgenericpageview.Tag","live.tags.googleuniversalanalytics.Tag",
"live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){ga("ec:addProduct",{"id":universal_variable.product.id,"name":universal_variable.product.name,"price":universal_variable.product.unit_sale_price,"brand":universal_variable.product.manufacturer,"category":universal_variable.product.category,"variant":universal_variable.product.color});ga("ec:setAction","detail");ga("send","event","ecommerce","details view",universal_variable.product.name,0,{nonInteraction:true})};
tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"User Zoom - Tracking Code","disabled":true,"url":"https://cdn3.userzoom.com/uz.js?cuid\x3dA4AFCB4774DAE311BEDA0022196C4538"});var pkg="live.tags.userzoomtrackingcodeuk.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ExcludeIfNotUserZoomCountry"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=
function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Home, Landing","disabled":true,"id":53044179,"locked":false,"locationObject":"BODY"});var pkg="live.tags.facebookhomelanding.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  fbq('track', 'ViewContent');\n\x3c/script\x3e";tag.addClientFiltersList(["live.filters.HomeORLanding"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"[PDP] Bloomreach - Add to Basket","disabled":false,"locked":false,"locationObject":"BODY"});var pkg="live.tags.pdpbloomreachaddtobasket.Tag";
qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry {\n    if (window.universal_variable.page.pageId \x3d\x3d\x3d \"product\") {\n        $('button[data-trk\x3daddToBag]').on('click',function(){\n              bloomReachAddToBasket(window.universal_variable.product);\n        });\n    } else {\n        $(document).bind(\"BagUpdated\", function(evt, product) {\n            bloomReachAddToBasket(product);\n        });\n    }\n\n    function bloomReachAddToBasket(product) {\n        try {\n            if (product !\x3d\x3d undefined) {\n                var json \x3d {\n                    'prod_id': product.id,\n                    'sku': product.id\n                };\n                BrTrk.getTracker().logEvent('cart', 'click-add', json);\n                ffLogger.tagLogger(\"Bloomreach - Add to Basket\", json, ffLogger.LogLevelEnum.INFO);\n            }\n        } catch (a) {\n            ffLogger.tagLogger(\"Bloomreach - Add to Basket\", a, ffLogger.LogLevelEnum.ERROR);\n        }\n    }\n} catch (e) {\n    ffLogger.tagLogger(\"Bloomreach - Add to Basket\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.IncludeIfCountryBloomreach","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.bloomreach.Tag","live.tags.ruleproductorbasketpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"https://cdn-static.farfetch.com/certona/resxclsx.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"Certona - People",
"disabled":false,"id":35686782,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.certonapeople.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.People","live.filters.People1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){var resx=new Object;resx.appid="Farfetch01";if(window.universal_variable.user.isLogged)resx.customerid=
window.universal_variable.user.user_id;else resx.customerid="";resx.rrec=true;resx.rrelem="landing_rr;";resx.rrnum="6;";certonaResx.run()}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Criteo - Product (Criteo Countries Only)","disabled":true,"id":55652136,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.criteoproductcriteocountriesonly.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://static.criteo.net/js/ld/ld.js" async\x3d"true"\x3e\x3c/script\x3e \n\x3cscript type\x3d"text/javascript"\x3e \n\n  var email \x3d window.universal_variable.user.hashedEmail ? window.universal_variable.user.hashedEmail : "";\n  email \x3d email ? email : (window.universal_variable.user.email ? window.universal_variable.user.email : "");\n  \n  window.criteo_q \x3d window.criteo_q || []; \n  window.criteo_q.push(\n    { event: "setAccount", account: ${criteo_accountId} },\n    { event: "setSiteType", type: "${siteType}" },\n    { event: "setHashedEmail", email: email },\n    { event: "viewItem", item: window.universal_variable.product.id } \n  ); \n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfNotCriteoCountry","live.filters.CriteoIsQubitEnabled"]);tag.addClientVariablesMap({"criteo_accountId":"live.variables.CriteoAccountId","siteType":"live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop"});tag.addParameters([{"name":"Criteo Account Id","description":null,"token":"criteo_accountId"},{"name":"Returns if device is mobile, tablet or desktop","description":null,"token":"siteType"}]);tag.genericDependencies=
[];tag.addClientDependenciesList(["live.tags.ruleproductpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"Bluekai - Wishlist and Basket","description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: "Pixel triggered when adding a product to wishlist"\n}',"disabled":false});var pkg="live.tags.bluekaiwishlistandbasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\ntry {\n\tif (window.universal_variable.page.pageId \x3d\x3d\x3d "product") {\n\t\t$(document).on(\'click\', \'.Go_AddToBag\', function () {\n\t\t\tif ($(".addToBag_ModelError").attr("class").indexOf("hide") \x3e -1) {\n\t\t\t\tbluekaiAddTo(\'BagUpdated\', window.universal_variable.product);\n\t\t\t}\n\t\t});\n\t} else {\n\t\t$(document).bind("BagUpdated", function (evt, product) {\n\t\t\tbluekaiAddTo(\'BagUpdated\', product);\n\t\t});\n\t}\n\n\t$(document).bind("WishListUpdated", function (evt, product) {\n\t\tbluekaiAddTo(\'WishListUpdated\', product);\n\t});\n\n\tfunction bluekaiAddTo(eventType, product) {\n\t\ttry {\n\t\t\tvar uv \x3d window.universal_variable;\n\t\t\tfunction sendStock(productSelected) {\n\t\t\t\tif (productSelected !\x3d\x3d undefined \x26\x26 productSelected.hasStock) {\n\t\t\t\t\tvar stock \x3d productSelected.stock;\n\t\t\t\t\tif (stock \x3e 9) {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "10+");\n\t\t\t\t\t} else if (stock \x3e 4) {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "5-9");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "1-4");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbk_addPageCtx("Stock", "0");\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (product !\x3d\x3d undefined) {\n\n\t\t\t\tbk_addPageCtx("Event", eventType);\n\t\t\t\tbk_addPageCtx("PageType", uv.page.pageId);\n\t\t\t\tbk_addPageCtx("Subfolder", uv.page.subfolder);\n\t\t\t\tbk_addPageCtx("NewCustomer", uv.user.returning);\n\n\t\t\t\tsendStock(product);\n\n\t\t\t\tbk_addPageCtx("ProdId", product.id);\n\t\t\t\tbk_addPageCtx("ProdDescription", product.name);\n\t\t\t\tbk_addPageCtx("ProdPrice", product.unit_price);\n\t\t\t\tbk_addPageCtx("Currency", window.universal_variable.page.currency);\n\t\t\t\tbk_addPageCtx("__bk_l", window.location);\n\t\t\t\tbk_addPageCtx("Cat_Gender", "");\n\t\t\t\tbk_addPageCtx("DesignerName", product.designerName ? product.designerName : \'\');\n\n\t\t\t\tbk_ignore_meta \x3d true;\n\t\t\t\tbk_doJSTag(30341, 10);\n\n        if (eventType \x3d\x3d\x3d \'BagUpdated\') {\n  \t\t\t\tffLogger.tagLogger("Bluekai - Wishlist and Basket", {productId:product.id}, ffLogger.LogLevelEnum.INFO);\n        }\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tffLogger.tagLogger("Bluekai - Wishlist and Basket", e, ffLogger.LogLevelEnum.ERROR);\n\t\t}\n\t}\n} catch (e) {\n\tffLogger.tagLogger("Bluekai - Wishlist and Basket", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script \x3e';
tag.addClientFiltersList(["live.filters.AddToBasketAndWishlistPages","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.bluekaiv2.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Search Page","disabled":false,"locked":false,
"locationObject":"BODY","postToReview":true});var pkg="live.tags.certonasearchpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\nvar resx \x3d {}; \nvar multiSelectCallBackObject \x3d $("#MultiSelectCallbackCenter");\nif (multiSelectCallBackObject.length \x3e 0 \x26\x26 multiSelectCallBackObject.hasClass("qbit_ab_lnd") \x3d\x3d false) {\n\tmultiSelectCallBackObject.on("item-render.multiselect", function (e) {\n\t\tif (e.fireCertona) {\n            resx.appid \x3d "Farfetch01";\n            if(window.universal_variable.user.isLogged){\n                resx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n            } else {\n                resx.customerid \x3d "";\n            }\n            var countryId \x3d window.universal_variable.user.country_id;\n            var genderId \x3d universal_variable.page.contextGenderId;\n            resx.rrqs \x3d { countryid: countryId, genderid: genderId };\n            if (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n                resx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n            }\n            resx.rrqs \x3d $.param(resx.rrqs) + ";";\n            if(typeof (window.universal_variable.listing.hasOwnProperty("items")) ){\n                var productList \x3d window.universal_variable.listing.items;\n                resx.rrelem \x3d "search_rr;";\n                var productIds \x3d [];\n                for(i\x3d0; i\x3c productList.length-1; i++){\n                    productIds.push(productList[i].id, ";");\n                }\n                resx.links \x3d productIds.join("");\n                resx.rrec \x3d true;\n                resx.rrnum \x3d "10;";\n                var url \x3d certonaResx.getURL();\n                $.ajax({\n                    url: url,\n                    dataType: \'jsonp\',\n                    jsonp : \'jsonp\',\n                    timeout: 10000,\n                    success: function(response) {\n                        $(document).data("recommendations", response);\n                    },\n                    error: function() {\n                        $(document).data("recommendations", false);\n                    }\n                });            \n            }\n        }\n\t});\n\t$("#MultiSelectCallbackCenter").trigger({ type: "item-render.multiselect", fireCertona: true });\n}\nelse {\n\tvar resx \x3d {};\n\tvar divNoRecordMoreInfoObject \x3d $(".divNoRecordMoreInfo");\n\tdivNoRecordMoreInfoObject.on("no-results-event", function (e) {\n\t\t\n\t\tresx.appid \x3d "Farfetch01";\n\t\tif (window.universal_variable.user.isLogged) {\n\t\t\tresx.customerid \x3d window.universal_variable.user.hashedSHA256Email;\n\t\t} else {\n\t\t\tresx.customerid \x3d "";\n\t\t}\n\t\tresx.rrec \x3d true;\n\t\tresx.rrelem \x3d "nosearch_rr";\n\t\tresx.rrnum \x3d "10;";\n\t\tvar countryId \x3d window.universal_variable.user.country_id;\n\t\tvar genderId \x3d window.universal_variable.page.contextGenderId;\n\t\tresx.rrqs \x3d { countryid: countryId, genderid: genderId };\n\t\tif (["BR", "FR"].indexOf(window.universal_variable.user.country_code) \x3e -1) {\n\t\t\tresx.rrqs.language \x3d window.universal_variable.user.country_code.toLowerCase();\n\t\t}\n\t\tresx.rrqs \x3d $.param(resx.rrqs);\n\t\tvar url \x3d certonaResx.getURL();\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: \'jsonp\',\n\t\t\tjsonp: \'jsonp\',\n\t\t\ttimeout: 1000,\n\t\t\tsuccess: function (response) {\n\t\t\t\t$(document).data("recommendations", response);\n\t\t\t},\n\t\t\terror: function () {\n\t\t\t\t$(document).data("recommendations", false);\n\t\t\t}\n\t\t});\t\t\n\t});\n\t$(".divNoRecordMoreInfo").trigger("no-results-event");\n}\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.SearchPages"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"https://d1m54pdnjzjnhe.cloudfront.net/farfetch/exit-feedback/farfetch-custom-parent-selector-pfb.min.js","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":true,"name":"Qubit Proactive Exit Feedback","disabled":false,"id":36229978,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubitproactiveexitfeedback.Tag";
qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){window.q_pfb_opts={"triggerElement":window.jQuery("#qb-pfb-toggle"),"$":window.jQuery,"showProb":.6,"hideFilter":"farfetch.com/holiday/wonderfulstore/|/br","journeyDepth":1,"closeCountDays":30,"trackingId":"farfetch","domain":".farfetch.com","clientId":33446,
"profileId":2034,"configId":14}};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook","disabled":true,"id":35687189,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.facebook.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  !function(f,b,e,v,n,t,s){if(f.fbq)return;n\x3df.fbq\x3dfunction(){n.callMethod?\n  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq\x3dn;\n  n.push\x3dn;n.loaded\x3d!0;n.version\x3d'2.0';n.queue\x3d[];t\x3db.createElement(e);t.async\x3d!0;\n  t.src\x3dv;s\x3db.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,\n  document,'script','https://connect.facebook.net/en_US/fbevents.js');\n  \n  fbq('init', '${facebook_pixel_id}');\n  fbq('track', \"PageView\");\n\x3c/script\x3e\n\x3cnoscript\x3e\n  \x3cimg height\x3d\"1\" width\x3d\"1\" style\x3d\"display:none\" src\x3d\"https://www.facebook.com/tr?id\x3d${facebook_pixel_id}\x26ev\x3dPageView\x26noscript\x3d1\" /\x3e\n\x3c/noscript\x3e";
tag.addClientFiltersList(["live.filters.FacebookQUBITGTM","live.filters.DefaultFilterMatchAll","live.filters.NotFireInChina"]);tag.addClientVariablesMap({"facebook_pixel_id":"live.variables.FacebookPixelID"});tag.addParameters([{"name":"Facebook Pixel ID","description":null,"token":"facebook_pixel_id"}]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Responsys - Conversion"});var pkg="live.tags.responsysconversion.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag"]);tag.pre=function(){};tag.script=function(){var userLocation=window.location.href;
if(uv!==undefined&&uv.hasOwnProperty("page")&&uv.page.hasOwnProperty("pageStep")&&uv.page.pageStep.toLowerCase()==="confirmation"||userLocation.indexOf("confirmationpage.aspx")>-1){var imageSource=document.location.protocol+"//email.farfetch.com/pub/cct"+"?_ri_\x3dX0Gzc2X%3DYQpglLjHJlYQGhFszcHNngOYvza0azef9HpCvC"+"\x26_ei_\x3dEuFFS2QGgzLj4LLlTcDzJLM"+"\x26action\x3donce"+"\x26OrderID\x3d"+window.universal_variable.transaction.order_id+"\x26OrderTotal\x3d"+window.universal_variable.transaction.total_gbp+
"\x26numItems\x3d"+window.universal_variable.transaction.line_items.length+"\x26customerID\x3d"+window.universal_variable.user.user_id;var image=document.createElement("img");image.src=imageSource;image.width=1;image.height=1;image.style.display="none";document.body.appendChild(image);ga("create","UA-3819811-59","auto","responsysTracker");ga("responsysTracker.send","event","Live","Responsys - log",window.universal_variable.transaction.order_id+";"+window.universal_variable.transaction.total_gbp)}else return};
tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Google Universal Analytics - Ecommerce","disabled":true,"id":35687291,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.googleuniversalanalyticsecommerce.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n(function(){\n\n  var trans \x3d window.universal_variable.transaction;\n  var items \x3d window.universal_variable.transaction.line_items;\n\n  ga('create', 'UA-3819811-6', 'auto');\n  if(window.universal_variable.user.user_id){\n      ga('set','\x26uid',window.universal_variable.user.user_id);\n  }\n  ga('require', 'displayfeatures');\n  ga('require', 'ecommerce', 'ecommerce.js');\n  \n  ga('ecommerce:addTransaction', {\n    'id': String(trans.order_id), \n    'affiliation': String(trans.stores),\n    'revenue': String(trans.subtotal_gbp),\n    'shipping': String(trans.shipping_cost_gbp),\n    'tax': String(trans.tax_gbp)\n  });\n\n  for (var i \x3d 0; i \x3c items.length; i++) {\n    ga('ecommerce:addItem', {\n      'id': String(trans.order_id), \n      'name': String(items[i].product.name),\n      'sku': String(items[i].product.sku_code),\n      'category': String(items[i].product.category),\n      'price': String(items[i].product.unit_sale_price_gbp),\n      'quantity': String(items[i].quantity)\n    });\n  }\n \n  ga('set', 'currencyCode', 'GBP');\n  ga('ecommerce:send');\n\n})();\n\x3c/script\x3e";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.googleuniversalanalytics.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"FFStorage"});var pkg="live.tags.ffstorage1.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList([]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){FFStorage=function(){var _lsSupport=false;var _setStorageSupport=function(){try{var storage=window.localStorage;var x="storageToken";
storage.setItem(x,x);setTimeout(function(){storage.removeItem(x)},400);this._lsSupport=true}catch(e){this._lsSupport=false}};var _setValue=function(key,value,exp){if(typeof value==="object")value=JSON.stringify(value);if(this._lsSupport)localStorage.setItem(key,value);else _createCookie(key,value,exp)};var _getValue=function(key){var data;if(this._lsSupport)data=localStorage.getItem(key)||[];else data=_readCookie(key);try{data=JSON.parse(data)}catch(e){data=data}return data};var _createCookie=function(key,
value,exp){var date=new Date;date.setTime(date.getTime()+exp*60*60*1E3);var expires="expires\x3d"+date.toUTCString();document.cookie=key+"\x3d"+value+";"+expires+"; path\x3d/"};var _readCookie=function(key){var name=key+"\x3d";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(";");for(var i=0;i<ca.length;i++){for(var c=ca[i];c.charAt(0)==" ";)c=c.substring(1);if(c.indexOf(name)===0){var rawValue=c.substring(name.length,c.length);return rawValue}}return[]};return{getValue:function(key){return _getValue(key)},
setValue:function(key,value,exp){return _setValue(key,value,exp)},init:function(){_setStorageSupport()}}}();FFStorage.init()};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_AddToBasketSend","disabled":true});var pkg="live.tags.gaaddtobasketsend1.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ShoppingCart"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag","live.tags.ffstorage1.Tag"]);
tag.pre=function(){};tag.script=function(){if(!FFStorage.checkStorageSupport())return;var storageKey="Basket";var localStorage=window.localStorage;var fromStorage=JSON.parse(localStorage.getItem(storageKey));if(fromStorage!==undefined&&fromStorage!==null){ga("ec:addProduct",{"id":fromStorage.id,"name":fromStorage.name,"price":fromStorage.unit_sale_price,"brand":fromStorage.manufacturer,"category":fromStorage.category,"variant":fromStorage.color,"quantity":1});ga("ec:setAction","add");ga("set","dimension1",
fromStorage.id);ga("send","event","ecommerce","add to cart",fromStorage.name,0,{nonInteraction:false});localStorage.removeItem(storageKey)}};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Knowledge Graph","disabled":false,"id":55165586,"locked":false,"locationObject":"BODY"});var pkg="live.tags.knowledgegraph.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n    // using uv, instead of window.universal_variable\n    var uv \x3d window.universal_variable;\n    // the customer service number by default (used in the subfolders where there isn\'t a defined number\n    var csNumberFallback \x3d "+44 (0) 20 3510 0670"; // United Kingdom\n    // the fallback url for facebook\n    var fbUrlFallback \x3d "https://www.facebook.com/Farfetch/";\n\n    // the customer service numbers available and the list of the countries where each one is used\n    var csDictionary \x3d [{\n            "csNumber": "+11 3958-8695",\n            "countryList": ["28"]\n        }, //Brazil\n        {\n            "csNumber": "+86 (0) 10 8405 4779)",\n            "countryList": ["42"]\n        }, //China\n        {\n            "csNumber": "+33 1 84 88 30 75",\n            "countryList": ["70", "71", "83", "128", "168"]\n        }, //France\n        {\n            "csNumber": "(+49 (0) 30 3080 9637)",\n            "countryList": ["13", "77"]\n        }, //Germany\n        {\n            "csNumber": "+81 03-4578-9714",\n            "countryList": ["103"]\n        }, //Japan\n        {\n            "csNumber": "(+52 5541613469)",\n            "countryList": ["131"]\n        }, //Mexico\n        {\n            "csNumber": "+74999187294",\n            "countryList": ["19", "106", "170", "214"]\n        }, //Russia\n        {\n            "csNumber": "+34 911 98 32 18",\n            "countryList": ["187"]\n        }, //Spain\n        {\n            "csNumber": "(+1 (213) 550-3798)",\n            "countryList": ["216", "231", "2", "3", "4", "307", "5", "6", "7", "8", "9", "10", "11", "12", "14", "15", "16", "17", "18", "21",\n                "22", "23", "24", "25", "304", "26", "27", "29", "30", "32", "33", "34", "35", "36", "37", "38", "39", "40",\n                "306", "41", "43", "44", "45", "46", "47", "48", "49", "50", "308", "55", "56", "57", "58", "59", "60", "61",\n                "62", "64", "65", "67", "68", "72", "73", "74", "75", "76", "78", "79", "81"\n            ]\n        } //United States\n    ];\n    // gets the customer service number for the country/subfolder\n    var csNumber \x3d function() {\n        for (var obj in csDictionary) {\n            var entry \x3d csDictionary[obj];\n            if (entry.countryList.indexOf(uv.user.country_id.toString()) \x3e -1) {\n                return entry.csNumber;\n            }\n        }\n    }();\n\n    // if the result of the previous calculation is undefined, then use the custumer service number by default\n    csNumber \x3d csNumber \x3d\x3d\x3d undefined ? csNumberFallback : csNumber;\n\n    // the facebooks available for Farfetch\n    var fbDictionary \x3d {\n        "/ru": "https://www.facebook.com/farfetch.russian/",\n        "/de": "https://www.facebook.com/farfetch.german/",\n        "/kr": "https://www.facebook.com/farfetch.korean/",\n        "/fr": "https://www.facebook.com/farfetch.french/",\n        "/es": "https://www.facebook.com/farfetch.spanish/",\n        "/jp": "https://www.facebook.com/farfetch.japan/"\n    };\n\n    // builds the json object with the oompany parameters\n    var jsonObject \x3d {\n        "@context": "http://schema.org",\n        "@type": "Organization",\n        "url": "https://www.farfetch.com",\n        "logo": "https://www.farfetch.com/static/images/logo.png",\n        "contactPoint": [{\n            "@type": "ContactPoint",\n            "telephone": csNumber,\n            "contactType": "Customer Service"\n        }],\n        "sameAs": ["https://twitter.com/farfetch", // twitter\n            "https://www.pinterest.com/farfetch/", // pinterest\n            "https://www.instagram.com/farfetch/", // instagram\n            "https://plus.google.com/+farfetch", // google plus\n            "http://weibo.com/farfetch?topnav\x3d1\x26wvr\x3d6", // weibo\n            "https://www.youtube.com/user/farfetchdotcom", // youtube\n            "https://vine.co/u/910946478355263488", // vine\n            "http://www.farfetchtumblr.com/" // tumblr\n        ],\n        "name": "Farfetch"\n    };\n\n    // selects the Facebook url for the given subfolder\n    var fbUrl \x3d fbDictionary[uv.page.subfolder];\n\n    // if the subfolder is the chinese one, don\'t show any Facebook urls\n    if (uv.page.subfolder !\x3d\x3d "/cn") {\n        // if the subfolder doesn\'t have a custom Facebook, then show the fallback one: in this case the US one\n        fbUrl \x3d fbUrl \x3d\x3d\x3d undefined ? fbUrlFallback : fbUrl;\n        // adds the calculated Facebook url to the json object\n        jsonObject["sameAs"].push(fbUrl);\n    }\n\n    // append the json at the end of the page body\n    (function() {\n        var script \x3d document.createElement("script");\n        script.type \x3d "application/ld+json";\n        script.async \x3d true;\n        script.text \x3d JSON.stringify(jsonObject);\n        document.body.appendChild(script);\n    })();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.rulehomepage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":true,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Zanox - Confirmation (FR) (Global)","disabled":false,"locked":false,"locationObject":"HEAD"});var pkg=
"live.tags.zanoxconfirmationfrglobal.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n  window.universal_variable \x3d window.universal_variable || {};\n  window.universal_variable.events \x3d window.universal_variable.events || [];\n  window.universal_variable.events.push({\n    category: "opentag-debug",\n    action: "zanox-script-start"\n  });\n\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \nsrc\x3d"https://ad.zanox.com/pps/?14883C131422400\x26mode\x3d[[1]]\x26Customer\nID\x3d[[${user_id}]]\x26OrderID\x3d[[${order_id}]]\x26CurrencySymbol\x3d[[${currency}]]\x26TotalPrice\x3d[[${total_price}\n]]\x26PartnerID\x3d[[${partner_id}]]"\x3e\n\x3c/script\x3e \n\x3cscript\x3e\n  window.universal_variable \x3d window.universal_variable || {};\n  window.universal_variable.events \x3d window.universal_variable.events || [];\n  window.universal_variable.events.push({\n    category: "opentag-debug",\n    action: "zanox-script-end"\n  });\n  \ntry {\n  var loggedData \x3d {\n    userId : "${user_id}",\n    orderId : "${order_id}",\n    currency : "${currency}",\n    totalPrice : "${total_price}",\n    partnerId : "${partner_id}"\n  };\n\tffLogger.tagLogger("Zanox - Confirmation (FR) (Global)", loggedData, ffLogger.LogLevelEnum.INFO);\n} catch (e) {\n\tffLogger.tagLogger("Zanox - Confirmation (FR) (Global)", e, ffLogger.LogLevelEnum.ERROR);\n}  \n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DedupeZanoxV2"]);tag.addClientVariablesMap({"partner_id":"live.variables.ZanoxPartnerID","total_price":"live.variables.TransactionOrderSubTotal","user_id":"live.variables.UserID","currency":"live.variables.TransactionOrderCurrency","order_id":"live.variables.TransactionOrderId"});tag.addParameters([{"name":"Zanox Partner ID","description":null,"token":"partner_id"},{"name":"Order Id","description":null,"token":"order_id"},{"name":"User Id","description":null,
"token":"user_id"},{"name":"Order Total","description":null,"token":"total_price"},{"name":"Currency","description":null,"token":"currency"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Criteo - Listing (Criteo countries only)","disabled":true,"id":35686970,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.criteolistingcriteocountriesonly.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://static.criteo.net/js/ld/ld.js" async\x3d"true"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e  \n  \n  var email \x3d window.universal_variable.user.hashedEmail ? window.universal_variable.user.hashedEmail : "";\n  email \x3d email ? email : (window.universal_variable.user.email ? window.universal_variable.user.email : "");\n  \n  var productList \x3d window.universal_variable.listing.items;\n  var productIds \x3d [];\n  for (i \x3d 0; i \x3c productList.length \x26\x26 i \x3c 3; i++) {\n    productIds.push(productList[i].id);\n  }\n    \n  window.criteo_q \x3d window.criteo_q || [];\n  window.criteo_q.push(\n    { event: "setAccount", account: ${criteo_accountId} },\n    { event: "setSiteType", type: "${siteType}" },\n    { event: "setHashedEmail", email: email },\n    { event: "viewList", item: productIds }\n  );\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfNotCriteoCountry","live.filters.CriteoIsQubitEnabled"]);tag.addClientVariablesMap({"criteo_accountId":"live.variables.CriteoAccountId","siteType":"live.variables.ReturnsIfDeviceIsMobileTabletOrDesktop"});tag.addParameters([{"name":"Criteo Account Id","description":null,"token":"criteo_accountId"},{"name":"Returns if device is mobile, tablet or desktop","description":null,"token":"siteType"}]);tag.genericDependencies=
[];tag.addClientDependenciesList(["live.tags.rulelistingpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"[PDP] Google Universal Analytics - Add To WishList","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var pkg="live.tags.pdpgoogleuniversalanalyticsaddtowishlist.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n\n  $(\"button[data-trk\x3d'addToWishlist']\").on('click', function()\n  { \n    var attr \x3d $(this).attr('aria-pressed');\n    if (attr !\x3d\x3d false \x26\x26 attr !\x3d\x3d \"true\") {\n      ga('send', 'event', 'product actions', 'add to wishlist', window.universal_variable.product.name, window.universal_variable.product.id);\n    }\n  });\n  \n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.OnlyProductAndBasketPages1","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":-1,"async":true,"usesDocumentWrite":false,"name":"Safari Cookie Notice","disabled":false,"id":35687012,"locked":false,"locationObject":"BODY"});var pkg="live.tags.safaricookienotice.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n(function() {\n  $("#dvtButtonAddToBag").click(function() {\n    var $ \x3d window.jQuery;\n    var position \x3d $("#productItemDesc").offset();\n    var notice \x3d $("\x3cdiv /\x3e").css({\n      position: \'absolute\',\n      top: $("#dvtButtonAddToBag").offset().top - 268,\n      right: 0,\n      width: 435,\n      height: 268,\n      zIndex: 8,\n      background: \'url(https://s3-eu-west-1.amazonaws.com/qubit-etc/farfetch/t047/safaricookies.png) no-repeat\'\n    }).appendTo("body");\n    var $exit \x3d $("\x3cdiv /\x3e").css({\n      position: \'absolute\',\n      top: 0,\n      right: 0,\n      width: 60,\n      height: 60,\n      cursor: \'pointer\'\n    }).click(function() {\n      notice.fadeOut(function() {\n         notice.remove(); \n      });\n    }).appendTo(notice);\n    notice.animate({\n      right: $(window).width() - position.left - 430\n    }, 500);    \n  });\n\n\n})();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.Detect"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Rule - Product Page","disabled":false,"id":53044219,"locked":false,"locationObject":"BODY"});var pkg="live.tags.ruleproductpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\x3c/script\x3e";tag.addClientFiltersList(["live.filters.ProductPage2"]);tag.addClientVariablesMap({});
tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Initiate Checkout","disabled":true,"id":53044188,"locked":false,"locationObject":"BODY"});var pkg="live.tags.facebookinitiatecheckout.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  fbq('track', 'InitiateCheckout', {\n    currency: window.universal_variable.basket.currency, \n    value: window.universal_variable.basket.total,\n    num_items: window.universal_variable.basket.line_items.length\n  });\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.FirstCheckoutPages"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_AddToBasketStore","disabled":true});var pkg="live.tags.gaaddtobasketsend.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ProductPage2","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag",
"live.tags.ffstorage1.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){if(!FFStorage.checkStorageSupport())return;var storageKey="Basket";var localStorage=window.localStorage;var addBag=document.querySelectorAll(".Go_AddToBag");var pageType=universal_variable.page.breadcrumb[1]+"-"+universal_variable.page.breadcrumb[2];var i=0;for(var len=addBag.length;i<len;i++)addBag[i].addEventListener("mousedown",function(ev){var thisItem=universal_variable.product;
thisItem["pageType"]=pageType;localStorage.setItem(storageKey,JSON.stringify(thisItem))}.bind(i))};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"DoubleClick Floodlight - Basket","disabled":true});var pkg="live.tags.doubleclickfloodlightbasket1.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nvar uv \x3d window.universal_variable;\n// This IF prevents the pixel to try and access the items on an empty bag, where the object doesn't exist\nif (uv.basket!\x3d\x3dundefined) {\nvar axel \x3d Math.random() + \"\";\nvar a \x3d axel * 10000000000000;\nvar fl_if \x3d document.createElement(\"iframe\");\n\nvar basketItems \x3d uv.basket.line_items;\nvar designerNames \x3d [];\nvar categories \x3d [];\nvar productIds \x3d [];\nvar productNames \x3d [];\nvar departments \x3d [];\nvar units_price \x3d [];\nvar units_sale_price \x3d [];\nvar storeIds \x3d [];\n\nfor(var i \x3d 0; i \x3c basketItems.length; i++){\n  designerNames.push(basketItems[i].product.designerName);\n  categories.push(basketItems[i].product.category);\n  productIds.push(basketItems[i].product.sku_code);\n  productNames.push(basketItems[i].product.name);\n  departments.push(basketItems[i].product.department);\n  units_price.push(basketItems[i].product.unit_price);\n  units_sale_price.push(basketItems[i].product.unit_sale_price);\n  storeIds.push(basketItems[i].product.storeId);\n}\n\nfl_if.src\x3d'https://5490350.fls.doubleclick.net/activityi;src\x3d5490350;type\x3dpagev0;cat\x3dfarfe00'+\n\t\t';u1\x3d'+ '[' + designerNames.join('|') + ']' + //[designer_name]\n\t\t';u2\x3d'+ '[' + categories.join('|') + ']' + //[category]\n\t\t';u3\x3d'+ //[sub_category]\n\t\t';u4\x3d'+ '[' + productIds.join('|') + ']' + //[product_id]\n\t\t';u5\x3d'+ '[' + productNames.join('|') + ']' + //[product_name]\n\t\t';u6\x3d'+ (uv.page.currency) + //[currency]\n\t\t';u7\x3d'+ //[color]\n\t\t';u8\x3d'+ '[' + departments.join('|') + ']' + //[department]\n\t\t';u9\x3d'+ //[total_stock]\n\t\t';u10\x3d'+ '[' + units_price.join('|') + ']' + //[unit_price]\n\t\t';u11\x3d'+ '[' + units_sale_price.join('|') + ']' + //[unit_sale_price]\n\t\t';u12\x3d'+ (uv.page.contextGenderId) + //[contextGenderId]\n\t\t';u13\x3d'+ (uv.user.basketId) + //[basketId]\n\t\t';u14\x3d'+ '[' + storeIds.join('|') + ']' + //[storeId]\n\t\t';u15\x3d'+ (uv.basket \x26\x26 uv.basket.total ? uv.basket.total : \"\") + //[basket_total]\n\t\t';u16\x3d'+ (uv.user.user_id ? uv.user.user_id : \"\") + //[userid]\n\t\t';u17\x3d'+ (uv.user.language) + //[language]\n\t\t';u18\x3d'+ (uv.user.country_code) + //[country]\n\t\t';u19\x3d'+ (uv.user.just_registered) + //[just_registered]\n\t\t';u20\x3d'+ (uv.page.subfolder) + //[subfolder]\n\t\t';dc_lat\x3d;dc_rdid\x3d;tag_for_child_directed_treatment\x3d;ord\x3d' + a + '?';\n\t\t\nfl_if.width\x3d\"1\";\nfl_if.height\x3d\"1\";\nfl_if.frameborder\x3d\"0\";\nfl_if.style.display \x3d \"none\";\ndocument.body.appendChild(fl_if);\n}\n\x3c/script\x3e";tag.addClientFiltersList([]);
tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.rulebasket.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "16/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"prePostWindowScope":false,"name":"Certona - Confirmation","disabled":false,"id":35686753,
"locked":false,"locationObject":"BODY"});var pkg="live.tags.certonaconfirmation.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript src\x3d"https://cdn-static.farfetch-contents.com/certona/resxclsx.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" \x3e\ntry {\n\t\tvar uv \x3d window.universal_variable;\n\t\tvar resx \x3d {};\n\t\tresx.appid \x3d "Farfetch01";\n\t\tresx.event \x3d "confirmation";\n\t\tif (uv.user.isLogged) {\n\t\t\tresx.customerid \x3d uv.user.hashedSHA256Email; // ADD WHENEVER AVAILABLE, LEAVE BLANK OTHERWISE\n\t\t}\n\t\tvar countryId \x3d uv.user.country_id;\n\t\tvar genderId \x3d uv.page.contextGenderId;\n\t\tvar tmp \x3d uv.transaction.line_items;\n\t\tvar tmpIDS \x3d [];\n\t\tvar tmpVals \x3d [];\n\t\tvar tmpQty \x3d [];\n\t\tfor (var i \x3d 0; i \x3c tmp.length; i++) {\n\t\t\ttmpIDS.push(tmp[i].product.id);\n\t\t\ttmpVals.push(tmp[i].product.unit_price_gbp);\n\t\t\ttmpQty.push(tmp[i].quantity);\n\t\t}\n\t\tresx.itemid \x3d tmpIDS.join(";") + ";";\n\t\tresx.qty \x3d tmpQty.join(";") + ";";\n\t\tresx.price \x3d tmpVals.join(";") + ";";\n\t\tresx.total \x3d uv.transaction.total_gbp;\n\t\tresx.transactionid \x3d uv.transaction.order_id;\n\t\tresx.rrec \x3d true;\n\t\tresx.rrelem \x3d "purchase_rr;";\n\t\tresx.rrnum \x3d "10;";\n\t\tresx.rrqs \x3d {\n\t\t\tcountryid : countryId,\n\t\t\tgenderid : genderId\n\t\t};\n\t\tif (["BR", "FR"].indexOf(uv.user.country_code) \x3e -1) {\n\t\t\tresx.rrqs.language \x3d uv.user.country_code.toLowerCase();\n\t\t}\n\t\tresx.rrqs \x3d $.param(resx.rrqs);\n\n\t\tvar tryToGetRecommendations \x3d function (tryCount) {\n\t\t\tvar uv \x3d window.universal_variable;\n\t\t\tvar url \x3d certonaResx.getURL();\n\t\t\t$.ajax({\n\t\t\t\turl : url,\n\t\t\t\tdataType : \'jsonp\',\n\t\t\t\tjsonp : \'jsonp\',\n\t\t\t\ttimeout : 10000,\n\t\t\t\tsuccess : function (response) {\n\t\t\t\t\t$(document).data("recommendations", (uv.user.country_code \x3d\x3d "BR" ? false : response));\n\t\t\t\t},\n\t\t\t\terror : function () {\n\t\t\t\t\tif (tryCount \x3c\x3d 2) {\n\t\t\t\t\t\tconsole.log(\'Failed Recommendations TRY \' + tryCount);\n\t\t\t\t\t\ttryToGetRecommendations(tryCount + 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(\'Failed Recommendations TRY \' + tryCount);\n\t\t\t\t\t\t$(document).data("recommendations", false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\ttryToGetRecommendations(1);\n\n\t\tffLogger.tagLogger("Certona - Confirmation", resx, ffLogger.LogLevelEnum.INFO);\n\t} catch (e) {\n\t\tffLogger.tagLogger("Certona - Confirmation", e, ffLogger.LogLevelEnum.ERROR);\n\t}\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.ConfirmationPage1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":' {\n\tVerticalTeam : "PRIME/MKT",\n\tAuthor : "",\n\tChangedBy : "Filipe Freitas",\n\tReviewer : "",\n\tLastChangedDate : "15/12/2016",\n\tVersion : "1.12",\n\tDescription : "FASV-4395 - vIQ LinkShare Paid Search tag misfiring"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"vIQ","disabled":true,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.hammerediq.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n\nvar initLinkShareLog \x3d (function(){\n    initLinkShareLog.prototype.init \x3d function (category, action, label) {\n    \n       try{\n      \n          (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']\x3dr;i[r]\x3di[r]||function(){\n              (i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\n              m\x3ds.getElementsByTagName(o)\n              [0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n              })(window,document,\'script\',\'//www.google-analytics.com/analytics.js\',\'ga\');\n            \n          ga(\'create\', \'UA-91193943-1\', \'auto\', \'tntTracker\');\n          ga(\'tntTracker.send\', \'event\', category, action, label);\n     \n       }\n       catch(e)\n       {\n       }\n    };\n});\n\nvar viqTag \x3d {\n  // Pixel identifier\n  pixelType: "",\n  cookieName: "viq_cookie_v2",\n  // Generates a number for this.cacheBuster as asked on the sepcs\n  cacheBuster: Date.now(),\n  // The host domain (to create the image source as asked on the specs)\n  hostDomain: "",\n  // The page parameters (to create the image source as asked on the specs)\n  currentPageParameters: "\x3cnull\x3e",\n  // The url of the page\n  fullUrl: function() {\n    return window.location;\n  }(),\n  // Array with all of the supported search engines (query string parameter)\n  searchEnginesQueryStrings: ["q", "searchfor", "qkw", "wd", "query", "text", "MT", "p", "kw"],\n  // Url prefixes\n  impressionPixelUrl: "https://t.myvisualiq.net/impression_pixel?r\x3d",\n  clickPixelUrl: "https://t.myvisualiq.net/click_pixel?et\x3dc\x26ago\x3d212\x26ao\x3d682",\n  activityPixelUrl: "https://t.myvisualiq.net/activity_pixel?pt\x3di\x26et\x3da\x26r\x3d",\n  // referrer url object\n  referrer: "",\n  // Check referrer query string\n  referrerHasQueryString: false,\n  // referrer query string\n  referrerQueryString: "",\n  // referrer without www\n  cleanReferrerUrl: "",\n  // Array with the current page query string parameters\n  currentWindowQueryStringArray: [],\n\n  self: this,\n\n  buildImgSrcUrl: function() {\n      var imageSourceParameters \x3d [];\n      for (var i \x3d 0; i \x3c arguments.length; i++) {\n          imageSourceParameters.push(arguments[i]);\n      }\n      return imageSourceParameters.join(\'|\').toLocaleLowerCase();\n  },\n\n  // Calculates the query phrase that a user inserted in one of the supported search engines\n  getSearchEngineValue: function(query) {\n      var result \x3d "";\n      var array \x3d this.getQueryStringArray(query);\n      var intersectResult \x3d this.searchEnginesQueryStrings.filter(function(n) {\n          return (array[n] !\x3d\x3d undefined \x26\x26 array[n] !\x3d\x3d "");\n      });\n      if (intersectResult.length \x3d\x3d\x3d 0) {\n          result \x3d "\x3cnull\x3e";\n      } else if (intersectResult.length \x3e\x3d 1) {\n          result \x3d array[intersectResult[0]];\n      }\n\n      return result;\n  },\n\n  createCookie: function(avgTimeOfUserInTheSite) {\n      var value \x3d "";\n      var date \x3d new Date(new Date().getTime() + avgTimeOfUserInTheSite * 60000);\n      var month \x3d date.getMonth() + 1;\n      var day \x3d date.getUTCDate();\n      value \x3d date.getFullYear().toString() + (month \x3c 10 ? "0" + month.toString() : month.toString()) + (day \x3c 10 ? "0" + day.toString() : day.toString()) + date.getHours().toString() + date.getMinutes().toString();\n      var expires \x3d "; expires\x3d" + date.toGMTString();\n      document.cookie \x3d this.cookieName + "\x3d" + value + expires + ";domain\x3d." + this.getCurrentDomain() + "; path\x3d/";\n  },\n\n  // Function (also) used for automation tests\n  getDocumentReferrer: function() {\n      return document.referrer;\n  },\n\n  getCurrentDomain: function() {\n      return \'${CURRENTDOMAIN}\';\n  },\n\n  getQueryValue: function(key,defValue) {\n      defValue \x3d (typeof defValue \x3d\x3d\x3d \'undefined\') ? "" : defValue;\n      return this.getArrayValue(this.currentWindowQueryStringArray,key,"");\n  },\n\n  getArrayValue: function(arr,key,defValue) {\n      return arr[key] !\x3d\x3d undefined ? arr[key].toLocaleLowerCase() : defValue;\n  },\n\n  // Returns query string array\n  getQueryStringArray: function(query) {\n      if (query \x3d\x3d "") {\n          return {};\n      }\n\n      queryArray \x3d query.substr(1).split(\'\x26\');\n\n      var value \x3d {};\n      for (var i \x3d 0, len \x3d queryArray.length; i \x3c len; ++i) {\n\n          var array \x3d queryArray[i].split(\'\x3d\', 2);\n          if (array.length \x3d\x3d 1) {\n              value[array[0]] \x3d "";\n          } else {\n              value[array[0]] \x3d decodeURIComponent(array[1].replace(/\\+/g, " "));\n          }\n      }\n      return value;\n  },\n\n  // Sorts an array by the lenght of the content\n  sortArrayByLength: function(arr) {\n      var sortedArray \x3d arr.sort(function(a, b) {return b.length - a.length;});\n      return sortedArray;\n  },\n\n  // The this.market in wich the conversion event ocurred\n  market: function() {\n    return universal_variable.user.userSubfolder \x3d\x3d\x3d "" ? "US" : universal_variable.user.userSubfolder.substring(1);\n  }(),\n\n  // Checks if persistent cookie exists\n  hasValidPersistentCookie: function() {\n      var result \x3d false;\n      var cookieValue \x3d "";\n      var name \x3d this.cookieName + "\x3d";\n      var ca \x3d document.cookie.split(";");\n      for (var i \x3d 0, len \x3d ca.length; i \x3c len; i++) {\n          var c \x3d ca[i];\n          while (c.charAt(0) \x3d\x3d \' \') {\n              c \x3d c.substring(1);\n          }\n          if (c.indexOf(name) \x3d\x3d 0) {\n              cookieValue \x3d c.substring(name.length, c.length);\n          }\n      }\n\n      var currentDate \x3d new Date();\n      var month \x3d currentDate.getMonth() + 1;\n      var day \x3d currentDate.getUTCDate();\n      var value \x3d currentDate.getFullYear().toString() + (month \x3c 10 ? "0" + month.toString() : month.toString()) + (day \x3c 10 ? "0" + day.toString() : day.toString()) + currentDate.getHours().toString() + currentDate.getMinutes().toString();\n\n      if (cookieValue \x3c value) {\n          result \x3d false;\n          this.createCookie(30);\n      } else {\n          result \x3d true;\n      }\n\n      return result;\n  },\n\n  init: function() {\n      var cacheBuster \x3d Date.now();\n      // The source of the pixel\n      var imgSrc \x3d "";\n\n      // Supported Search Engines: Google (returns \x3cnull\x3e), bing, aol.com, yahoo jp, ask.com, wow.com, webcrawler, mywebsearch, infospace, info, duckduckgo (returns \x3cnull\x3e), contenko, dogpile, alhea, baidu, so (360 search),\n      // sogou, yandex, go.mail.ru, ramble, goo, sagool, jword, fresheye, naver, excite, lycos\n      // var supportedSearchEngines \x3d ["mywebsearch.com", "duckduckgo.com", "webcrawler.com", "infospace.com", "search.yahoo", "contenko.com", "fresheye.com", "dogpile.com", "rambler.ru", "go.mail.ru", "excite.com", "yandex.com", "www.so.com", "goo.ne.jp", "sagool.jp", "sogou.com", "lycos.com", "alhea.com", "baidu.com", "naver.com", "bing.com", "info.com", "jword.jp", "google", "aol.com", "ask.com", "wow.com"];\n      // *** DISCLAIMER *** The specs have changed now the we only provide support for Google, Yahoo, Bing and Ask.\n      var supportedSearchEngines \x3d ["search.yahoo", "bing.com", "google", "ask.com"];\n      supportedSearchEngines \x3d this.sortArrayByLength(supportedSearchEngines);\n\n      // Array with all the supported social newtorks\n      var supportedSocialNetworks \x3d ["facebook", "twitter", "plus.google.com", "weibo", "snapchat", "tumblr", "pinterest", "vine", "wechat", "instagram", "/t.co"];\n      supportedSocialNetworks \x3d this.sortArrayByLength(supportedSocialNetworks);\n\n      this.referrer \x3d this.getDocumentReferrer();\n      this.referrerHasQueryString \x3d this.referrer.indexOf("?") \x3e -1;\n      this.referrerQueryString \x3d this.referrerHasQueryString ? this.referrer.substring(this.referrer.indexOf("?"), this.referrer.length) : "";\n      this.cleanReferrerUrl \x3d  this.referrer.replace(this.referrerQueryString, "").replace("www.", "").replace("http://", "").replace("https://", "");\n      this.cleanReferrerUrl \x3d this.cleanReferrerUrl.indexOf("/") \x3e -1 ? this.cleanReferrerUrl.substring(0, this.cleanReferrerUrl.indexOf("/")) : this.cleanReferrerUrl;\n\n      // referrer url\n      var referrerUrl \x3d this.referrerHasQueryString ? this.referrer.substring(0, this.referrer.indexOf("?")) : this.referrer;\n\n      // Is a Farfetch internal redirect?\n      var isFarfetchRedirect \x3d this.cleanReferrerUrl.toLocaleLowerCase().indexOf(this.getCurrentDomain().toLocaleLowerCase()) \x3e -1;\n\n      // Calcs the host domain and the current page query string parameters\n      if (this.fullUrl.search \x3d\x3d "") {\n          // Removes the non needed stuff from the url\n          this.hostDomain \x3d this.fullUrl.href.toLocaleLowerCase().replace(this.fullUrl.protocol + "//", "").replace("www.", "");\n      } else {\n          // Removes the non needed stuff from the url\n          this.hostDomain \x3d this.fullUrl.href.substring(0, this.fullUrl.href.indexOf(\'?\')).replace(this.fullUrl.protocol + "//", "").replace("www.", "");\n          // Calculates the full query string\n          this.currentPageParameters \x3d encodeURIComponent(this.fullUrl.search.substr(1));\n      }\n\n      this.currentWindowQueryStringArray \x3d this.getQueryStringArray(this.fullUrl.search);\n\n      var utm_medium \x3d this.getQueryValue("utm_medium");\n      var utm_source \x3d this.getQueryValue("utm_source");\n      var ff_medium \x3d this.getQueryValue("ff_medium");\n      var ff_source \x3d this.getQueryValue("ff_source");\n      var hasGclid \x3d this.getQueryValue("gclid") !\x3d\x3d "" ? true : false;\n      var origin \x3d this.getQueryValue("origin");\n      var utm_campaign \x3d this.getQueryValue("utm_campaign");\n\n      // List of keywords that defines a paid search\n      var paidSearchKeyords \x3d ["social", "cpc", "ppc", "paidsearch", "product-search"];\n      var isPaidSearchFromGoogle \x3d referrerUrl.toLocaleLowerCase().indexOf("google") \x3e -1 \x26\x26 paidSearchKeyords.indexOf(origin) \x3e -1;\n\n      // Calculates if it\'s a paid search this.referrer\n      var isPaidSearch \x3d function() {\n          if (paidSearchKeyords.indexOf(utm_medium) \x3e -1 ||\n              paidSearchKeyords.indexOf(utm_source) \x3e -1 ||\n              paidSearchKeyords.indexOf(ff_medium) \x3e -1 ||\n              paidSearchKeyords.indexOf(ff_source) \x3e -1 ||\n              hasGclid ||\n              isPaidSearchFromGoogle) {\n              return true;\n          }\n          return false;\n      }();\n\n      var isPaidSocial \x3d function() {\n          return utm_medium \x3d\x3d\x3d "display";\n      }();\n\n      // Calculates if it\'s "Paraiso Feminino" this.referrer\n      var isParaisoFeminino \x3d function() {\n          return (utm_source \x3d\x3d\x3d "paraisofeminino" \x26\x26 utm_medium \x3d\x3d\x3d "referral" \x26\x26 referrerUrl.toLocaleLowerCase().indexOf(\'paraisofeminino.com.br\') \x3e -1);\n      }();\n\n      // Linkshare specific paid search\n      var isLinksharePaidSearch \x3d utm_campaign.indexOf("linkshare") \x3e -1;\n\n      isPaidSearch \x3d isPaidSearch || isLinksharePaidSearch;\n\n      // Calculates if it\'s a social network this.referrer\n      var isSocialNetwork \x3d function() {\n          var result \x3d false;\n          if (!isPaidSearch \x26\x26 !isLinksharePaidSearch) {\n              for (var i \x3d 0, len \x3d supportedSocialNetworks.length; i \x3c len \x26\x26 !result; i++) {\n                  if (referrerUrl.indexOf(supportedSocialNetworks[i]) \x3e -1) {\n                      result \x3d true;\n                  }\n              }\n          }\n          return result;\n      }();\n\n      // Calcs if it\'s a supported search engine\n      var isSearchEngine \x3d function() {\n          var result \x3d false;\n          if (!isSocialNetwork \x26\x26 !isPaidSearch \x26\x26 !isPaidSocial) {\n              for (var i \x3d 0, len \x3d supportedSearchEngines.length; i \x3c len \x26\x26 !result; i++) {\n                  if (referrerUrl.indexOf(supportedSearchEngines[i]) \x3e -1) {\n                      result \x3d true;\n                  }\n              }\n          }\n          return result;\n      }();\n\n      // Calculates if it\'s an email this.referrer\n      var isEmail \x3d function() {\n          if (utm_medium !\x3d\x3d "" \x26\x26 utm_source !\x3d\x3d "" \x26\x26 !isPaidSearch \x26\x26 !isPaidSocial \x26\x26 (utm_source \x3d\x3d\x3d "email" || utm_medium \x3d\x3d\x3d "email")) {\n              return true;\n          }\n          return false;\n      }();\n\n      // The source of the pixel\n      imgSrc \x3d function(that) {\n          var result \x3d "";\n          var imageSourceParameters \x3d [];\n          self.pixelType \x3d "";\n\n          /****************** Impression tracker ******************/\n          /*********** Should fire in all landing pages ***********/\n          /********************************************************/\n          if (universal_variable.transaction) {\n              result \x3d that.getCheckoutTagUrl();\n              self.pixelType \x3d "checkout";\n          }\n          else {\n              // Organic search tagging\n              if (isSearchEngine) {\n                  result \x3d that.getSearchEngineTagUrl();\n                  self.pixelType \x3d "searchEngine";\n              }\n              // Identify the social network by the this.referrer\n              else if (isSocialNetwork) {\n                  if (isPaidSocial) {\n                      result \x3d that.getPaidSocialTagUrl();\n                      self.pixelType \x3d "paidSocial";\n                  } else {\n                      result \x3d that.getNotPaidSocialTagUrl();\n                      self.pixelType \x3d "notPaidSocial";\n                  }\n              }\n              // Email Tagging\n              else if (isEmail) {\n                  result \x3d that.getEmailTagUrl();\n                  self.pixelType \x3d "email";\n              }\n              // Paraiso Feminino tagging\n              else if (isParaisoFeminino) {\n                  result \x3d that.getParaisoFemininoTagUrl();\n                  self.pixelType \x3d "paraisoFeminino";\n                  //ffLogger.tagLogger("vIQ ParFem",{ "ImgSrc": result }, ffLogger.LogLevelEnum.INFO);\n              }\n              // Linkshare tagging\n              else if (isLinksharePaidSearch) {\n                  result \x3d that.getLinksharePaidSearchTagUrl();\n                  self.pixelType \x3d "linkshare";\n              }\n              // Organic Referral Tagging (non paid traffic, non seo related traffic and non social network traffic, i.e. a visit from a blog. Redirects inside Farfetch website should not fire the tag)\n              else if (!isPaidSearch \x26\x26 !isEmail \x26\x26 !isSearchEngine \x26\x26 !isSocialNetwork \x26\x26 !isFarfetchRedirect \x26\x26 !isPaidSocial \x26\x26 referrerUrl !\x3d\x3d "") {\n                  result \x3d that.getOrganicReferralTagUrl();\n                  self.pixelType \x3d "organicReferral";\n              }\n              // User made an entry directly on farfetch website\n              else if (!that.hasValidPersistentCookie() \x26\x26 referrerUrl \x3d\x3d\x3d "") {\n                  result \x3d that.getDirectEntryTagUrl();\n                  self.pixelType \x3d "directEntry";\n              }\n              else if (isPaidSearch \x26\x26\n                  (that.market.toLocaleLowerCase() \x3d\x3d\x3d "cn") \x26\x26 // This line should be removed for tracking other markets\n                  !hasGclid \x26\x26\n                  !isPaidSearchFromGoogle) {\n                  /********************** Click Pixel **********************/\n                  /*********** Should fire when is a paid search ***********/\n                  /*********************************************************/\n                  var cleanReferrerUrlLowered \x3d that.cleanReferrerUrl.toLocaleLowerCase();\n\n                  if (cleanReferrerUrlLowered.indexOf("baidu") \x3e -1) { // BAIDU\n                      result \x3d that.getBaiduTagUrl();\n                      self.pixelType \x3d "baidu";\n                  } else if (cleanReferrerUrlLowered.indexOf("so.com") \x3e -1) { // 360\n                      result \x3d that.get360TagUrl();\n                      self.pixelType \x3d "so.com";\n                  } else if (cleanReferrerUrlLowered.indexOf("sogou") \x3e -1) { // SOGOU\n                      self.pixelType \x3d "sogou";\n                      result \x3d that.getSogouTagUrl();\n                  }\n              }\n          }\n\n          return result.toLocaleLowerCase();\n      }(this);\n\n      /****************** Conversion Tracker ******************/\n      /*********** Should fire in transaction pages ***********/\n      /********************************************************/\n      try {\n        if (universal_variable.transaction) {\n            try {\n                this.createViqImage(imgSrc);\n                //this.logPixel(imgSrc);\n\n                ffLogger.tagLogger("vIQ (Confirmation)", {\n                    "ImgSrc": imgSrc\n                }, ffLogger.LogLevelEnum.INFO);\n            } catch (e) {\n                ffLogger.tagLogger("vIQ (Confirmation)", e, ffLogger.LogLevelEnum.ERROR);\n                //gaLogger.init("Live", "Viq Error Checkout", \'Error: \' + e);\n            }\n        } else {\n            // without logging\n            this.createViqImage(imgSrc);\n            //this.logPixel(imgSrc);\n        }\n      } catch (e) {\n        //var gaLogger \x3d new initLinkShareLog();\n        //gaLogger.init("Live", "Viq Error", \'Error: \' + e);\n      }\n    },\n\n    logPixel: function(imgSrc) {\n      var gaLogger \x3d new initLinkShareLog(); \n      switch(self.pixelType) {\n        case "linkshare":\n          gaLogger.init("Live", "Viq - Linkshare", imgSrc);\n          break;\n        case "checkout":\n          gaLogger.init("Live", "Viq - Checkout", imgSrc);\n          break;\n        case "searchEngine":\n          gaLogger.init("Live", "Viq - Search Engine", imgSrc);\n          break;\n        case "paidSocial":\n          gaLogger.init("Live", "Viq - Paid Social", imgSrc);\n          break;\n        case "notPaidSocial":\n          gaLogger.init("Live", "Viq - Not Paid Social", imgSrc);\n          break;\n        case "email":\n          gaLogger.init("Live", "Viq - Email", imgSrc);\n          break;\n        case "paraisoFeminino":\n          gaLogger.init("Live", "Viq - Paraiso Feminino", imgSrc);\n          break;\n        case "organicReferral":\n          gaLogger.init("Live", "Viq - Organic Referral", imgSrc);\n          break;\n        case "directEntry":\n          gaLogger.init("Live", "Viq - Direct Entry", imgSrc);\n          break;\n        case "baidu":\n          gaLogger.init("Live", "Viq - Baidu", imgSrc);\n          break;\n        case "so.com":\n          gaLogger.init("Live", "Viq - 360", imgSrc);\n          break;\n        case "sogou":\n          gaLogger.init("Live", "Viq - Sogou", imgSrc);\n          break;\n        default:\n          gaLogger.init("Live", "Viq - No pixel match", imgSrc);\n        }\n    },\n\n    createViqImage: function(imageSrc) {\n        // Creates the image only if exists source\n        if (imageSrc.length \x3e 0) {\n            var image \x3d document.createElement("img");\n            image.style.width \x3d "1";\n            image.style.height \x3d "1";\n            image.src \x3d imageSrc;\n            image.style.display \x3d "none";\n\n            // Appends the image to the body\n            document.body.appendChild(image);\n        }\n    },\n\n    // Functions (also) used for automation tests (BEGIN)\n    getSearchEngineTagUrl: function() {\n        var searchQueryPhrase \x3d this.getSearchEngineValue(this.referrerQueryString);\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-13\x26si\x3d-13\x26ci\x3d-13\x26pi\x3d-351\x26ad\x3d-351\x26sv1\x3d-13\x26advt\x3d-13\x26chnl\x3d-13\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, searchQueryPhrase, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getPaidSocialTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-6\x26si\x3d-6\x26ci\x3d-6\x26pi\x3d-651\x26ad\x3d-651\x26advt\x3d-6\x26chnl\x3d-6\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getNotPaidSocialTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-12\x26si\x3d-12\x26ci\x3d-12\x26pi\x3d-352\x26ad\x3d-352\x26sv1\x3d-12\x26advt\x3d-12\x26chnl\x3d-12\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getEmailTagUrl: function() {\n        var utm_medium \x3d this.getQueryValue("utm_medium");\n        var utm_source \x3d this.getQueryValue("utm_source");\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-9\x26si\x3d-9\x26ci\x3d-9\x26pi\x3d-350\x26ad\x3d-350\x26sv1\x3d-9\x26advt\x3d-9\x26chnl\x3d-9\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, utm_source + utm_medium, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getDirectEntryTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-12\x26si\x3d-12\x26ci\x3d-12\x26pi\x3d-353\x26ad\x3d-353\x26sv1\x3d-12\x26advt\x3d-12\x26chnl\x3d-12\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, "\x3cNULL\x3e", this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getParaisoFemininoTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-1013\x26si\x3d-1013\x26ci\x3d-1013\x26pi\x3d1013\x26ad\x3d-1013\x26sv1\x3d-4\x26advt\x3d-4\x26chnl\x3d-4\x26vndr\x3d1215\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters, "|Affiliate\x26pt\x3di");\n    },\n\n    getLinksharePaidSearchTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-4\x26si\x3d-4\x26ci\x3d-4\x26pi\x3d-372\x26ad\x3d-372\x26advt\x3d-4\x26chnl\x3d-4\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getOrganicReferralTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.impressionPixelUrl + this.cacheBuster + "\x26et\x3di\x26ago\x3d212\x26ao\x3d682\x26aca\x3d-15\x26si\x3d-15\x26ci\x3d-15\x26pi\x3d-374\x26ad\x3d-374\x26advt\x3d-15\x26chnl\x3d-15\x26vndr\x3d1157\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters + "\x26pt\x3di");\n    },\n\n    getBaiduTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.clickPixelUrl + "\x26aca\x3d-1018\x26si\x3d-1018\x26ci\x3d-1018\x26pi\x3d-1018\x26ad\x3d-1018\x26sv1\x3d-2\x26advt\x3d-2\x26chnl\x3d-2\x26vndr\x3d1206\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, "BaiduBrandZ", this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters, "\x26red\x3d" + encodeURIComponent(this.referrer));\n    },\n\n    get360TagUrl: function() {\n        var imgSrcFirstPiece \x3d this.clickPixelUrl + "\x26aca\x3d-1019\x26si\x3d-1019\x26ci\x3d-1019\x26pi\x3d-1019\x26ad\x3d-1019\x26sv1\x3d-2\x26advt\x3d-2\x26chnl\x3d-2\x26vndr\x3d1221\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, "360BrandZ", this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters, "\x26red\x3d" + encodeURIComponent(this.referrer));\n    },\n\n    getSogouTagUrl: function() {\n        var imgSrcFirstPiece \x3d this.clickPixelUrl + "\x26aca\x3d-1020\x26si\x3d-1020\x26ci\x3d-1020\x26pi\x3d-1020\x26ad\x3d-1020\x26sv1\x3d-2\x26advt\x3d-2\x26chnl\x3d-2\x26vndr\x3d1222\x26u\x3d" + this.market;\n        return this.buildImgSrcUrl(imgSrcFirstPiece, "SogouBrandZ", this.hostDomain, this.cleanReferrerUrl, this.currentPageParameters, "\x26red\x3d" + encodeURIComponent(this.referrer));\n    },\n\n    getCheckoutTagUrl: function() {\n        // Calcs if it\'s a new user or not (1: not a new user, 0: new user)\n        var returningUser \x3d universal_variable.user.returning ? "1" : "0";\n        // Final source\n        var imgSrcCheckout \x3d this.activityPixelUrl + this.cacheBuster + "\x26ago\x3d212\x26ao\x3d682\x26px\x3d253\x26ord\x3d" + universal_variable.transaction.order_id + "\x26revenue\x3d" + universal_variable.transaction.total_gbp + "\x26u1\x3d" + returningUser + "\x26u2\x3d" + this.market;\n        imgSrcCheckout \x3d imgSrcCheckout.toLocaleLowerCase();\n        return imgSrcCheckout;\n    }\n    // Functions (also) used for automation tests (END)\n}\n\nviqTag.init();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.UserInfoAvailable"]);tag.addClientVariablesMap({"CURRENTDOMAIN":"live.variables.CurrentDomain1"});tag.addParameters([{"name":"Current Domain","token":"CURRENTDOMAIN"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"async":true,"locationPlaceHolder":"END","name":"Bluekai","description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Carolina Cardoso",\n Reviewer: "",\n LastChangedDate: "28/09/2016",\n Version: "1.4",\n Description: "BlueKai  Pixel amendments - Current Taxonomy "\n}',"disabled":false});var pkg="live.tags.bluekaiv2.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3ciframe name\x3d"__bkframe" height\x3d"0" width\x3d"0" frameborder\x3d"0" style\x3d"display:none;position:absolute;clip:rect(0px 0px 0px 0px)" src\x3d"about:blank"\x3e\x3c/iframe\x3e\n\x3cscript type\x3d"text/javascript" src\x3d"https://tags.bkrtx.com/js/bk-coretag.js"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e\n\nvar windowInnerWidth \x3d window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\nif (windowInnerWidth \x3c 767) {\n    bk_addPageCtx("Device", \'Mobile\');\n    bk_use_multiple_iframes \x3d true;\n    bk_send_statid_payload \x3d true;\n}else if (1024\x3ewindowInnerWidth \x3e 767){\n    bk_addPageCtx("Device", \'Tablet\');\n}else{\n    bk_addPageCtx("Device", \'Desktop\');\n}\n\nbk_allow_multiple_calls \x3d true;\n\n(function(uv) {\n\n bk_addPageCtx("PageType", uv.page.pageId);\n bk_addPageCtx("Subfolder", uv.page.subfolder);\n bk_addPageCtx("NewCustomer", uv.user.returning);\n bk_addPageCtx("UserCookieId", uv.user.cookieId);\n bk_addPageCtx("UserSessionId", uv.user.sessionId);\n bk_addPageCtx("__bk_l", window.location);\n\n var userId\x3duv.user.user_id;\n if(userId!\x3d\x3dnull|| userId!\x3d\x3d\'\'){\n  bk_addPageCtx("UserId", userId);\n }\n\n\nvar gender \x3d {\n    0: "",\n    248: "men",\n    249: "women",\n    19018: "kids"\n};\n\nvar pageId\x3duv.page.pageId;\nvar  totalCostGBP \x3d 0.0;\nvar totalOfItems \x3d0.0;\n\nswitch(pageId){\n    case "transaction":\n        //Variable added on the transaction/confirmation\n        var transactionProductsList \x3d uv.transaction.line_items;\n     \n        for (var i \x3d 0; i \x3c transactionProductsList.length; ++i) {\n            var resTran \x3d (transactionProductsList[i].product.url).split("/");\n            if (uv.page.subfolder\x3d\x3d\x3d\'\') {\n                bk_addPageCtx("Cat_Gender", transactionProductsList[i].product.category+"_"+resTran[2]);\n            } else {\n                bk_addPageCtx("Cat_Gender", transactionProductsList[i].product.category+"_"+resTran[3]);\n            }\n            bk_addPageCtx("DesignerName", transactionProductsList[i].product.designerName ? transactionProductsList[i].product.designerName : \'\');\n            totalOfItems +\x3d transactionProductsList[i].quantity;\n        }\n        bk_addPageCtx("Total_Cost", uv.transaction.subtotal_gbp);\n        bk_addPageCtx("Number_of_Items", totalOfItems);\n        break;\n    case "product":\n        //Send cat and gender\n        bk_addPageCtx("Cat_Gender", uv.product.category + "_" + gender[uv.page.contextGenderId]);\n        bk_addPageCtx("DesignerName", universal_variable.product.designerName ? universal_variable.product.designerName : \'\');\n        \n        //Variable added on the product\n        var stock\x3duv.product.stock;\n        if (stock \x3e 9) {\n            bk_addPageCtx("Stock", "10+");\n        } else if (stock \x3e 4) {\n            bk_addPageCtx("Stock", "5-9");\n        } else {\n            bk_addPageCtx("Stock", "1-4");\n        }\n        break;\n    case "basket":\n    case "checkout":\n        //Send cat and gender\n        var basketProductsList \x3d uv.basket.line_items;\n        \n        for (var j \x3d 0; j \x3c basketProductsList.length; ++j) {\n            var resBprod \x3d (basketProductsList[j].product.url).split("/");\n          \n            if (uv.page.subfolder\x3d\x3d\x3d\'\') {\n                bk_addPageCtx("Cat_Gender", basketProductsList[j].product.category+"_"+resBprod[2]);\n            } else {\n                bk_addPageCtx("Cat_Gender", basketProductsList[j].product.category+"_"+resBprod[3]);\n            }\n            \n            bk_addPageCtx("DesignerName", basketProductsList[j].product.designerName ? basketProductsList[j].product.designerName : \'\');\n            \n            totalCostGBP +\x3d parseFloat(basketProductsList[j].product.unit_sale_price_gbp) *  parseFloat(basketProductsList[j].quantity);\n            totalOfItems +\x3d basketProductsList[j].quantity;\n        }\n        \n        bk_addPageCtx("Total_Cost", totalCostGBP.toFixed(2));\n        bk_addPageCtx("Number_of_Items", totalOfItems);\n        break;\n    case "listing":\n        if (typeof uv.page.contextGenderId !\x3d\x3d "undefined" \x26\x26 typeof uv.page.category !\x3d\x3d "undefined") {\n            bk_addPageCtx("Cat_Gender", uv.page.category + "_" + gender[uv.page.contextGenderId]);\n            break;\n        } else if (universal_variable.listing.Designername) {\n          bk_addPageCtx("DesignerName", universal_variable.listing.Designername);\n        }\n    default:\n        bk_addPageCtx("Cat_Gender", "");\n        break;\n}\n\n\n bk_ignore_meta \x3d true;\n bk_doJSTag(30341, 10);\n\n}(window.universal_variable));\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Facebook - Product","disabled":true,"id":53044213,"locked":false,"locationObject":"BODY"});var pkg="live.tags.facebookproduct.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\n  var product \x3d window.universal_variable.product;\n  \n  fbq('track', 'ViewContent', {\n    content_name: product.name,\n    content_category: product.category,\n    content_ids: [''+product.id],\n    content_type: \"product\",\n    value: product.unit_sale_price,\n    currency: product.currency\n  });\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.facebook.Tag","live.tags.ruleproductpage.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Qubit EU Cookie Consent","disabled":false,"id":35686858,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubiteucookieconsent.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n  (function() {\n    function addStyleSheet(css) {\n      var head, styleElement;\n      head \x3d document.getElementsByTagName(\'head\')[0];\n      styleElement \x3d document.createElement(\'style\');\n      styleElement.setAttribute(\'type\', \'text/css\');\n      if (css instanceof Array) {\n        css \x3d css.join("");\n      }\n      if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText \x3d css;\n      } else {\n        styleElement.appendChild(document.createTextNode(css));\n      }\n      head.appendChild(styleElement);\n      return styleElement;\n    }\n    var css \x3d [\n      "@media screen and (min-width: 768px){",\n      "#qubit-eu-cookie-text{ line-height:20px !important; font-size:10pt !important; }",\n      "}",\n      "@media screen and (max-width: 767px){",\n      "#qubit-eu-cookie-text{ line-height:14px !important; font-size:8pt !important; }",\n      "}",\n      "#qubit-eu-cookie{ width: 100%; position: fixed; display:block; bottom: 0px; height: auto; min-height: 70px; z-index: 99999; background-color: #555555; }",\n      "#qubit-eu-cookie-main-container{ width: 99%; height: auto; position: relative; bottom: 0px; left: 50%; margin-left: -49%; color:#FFFFFF}",\n      "#qubit-eu-cookie-text{ position: relative; top: 0px; width: 94%; text-align:left; line-height:100%; border-bottom:none !important; padding: 7px 10px;}",\n      "#qubit-eu-cookie-close{ background-image: url(\'https://d1m54pdnjzjnhe.cloudfront.net/farfetch/eu-cookie-consent/cookie_consent_close_v2.png\'); position: absolute; top: 15px; right: 15px; height: 22px; width: 20px; cursor: pointer;}",\n      "#qubit-eu-cookie-link{ color: #FFFFFF; border-bottom: 1px solid #aaaaaa; }"\n    ];\n    addStyleSheet(css.join(""));\n    \n    var createCookie \x3d function(name, value, days, domain) {\n      var expires \x3d "";\n      if (days) {\n        var date \x3d new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires \x3d "; expires\x3d" + date.toGMTString() + ";";\n      } else {\n        expires \x3d "";\n      }\n      if (domain) {\n        document.cookie \x3d name + "\x3d" + value + expires + ";domain\x3d" + domain + ";path\x3d/;secure";\n      } else {\n        document.cookie \x3d name + "\x3d" + value + expires + "; path\x3d/;secure";\n      }\n    };\n    \n    var notMobile \x3d function() {\n      var ua \x3d navigator.userAgent;\n      if (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(ua)) {\n        return false;\n      }\n      if (ua.indexOf("MSIE 7") \x3e -1 || ua.indexOf("MSIE 6") \x3e -1) {\n        return false;\n      }\n      return true;\n    };\n    \n    var waitForjQuery \x3d function() {\n      var $ \x3d window.jQuery;\n      var uv \x3d window.universal_variable || {};\n      \n      if( $ \x26\x26 uv \x26\x26 uv.page \x26\x26 uv.page.subfolder \x26\x26 uv.page.subfolder !\x3d\x3d \'\') {\n        $(document).ready(function() {\n          var disclaimerConfig \x3d {\n            en : "We use cookies to provide and improve our service to you and store information including your preferences and the pages you look at. By using our site you agree to this.\x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3ePlease click here\x3c/a\x3e for further information.",\n            br : "Usamos Cookies para melhorar os nossos servi\u00e7os e guardar suas informa\u00e7\u00f5es de preferencia e p\u00e1ginas visitadas. Ao navegar no nosso site voc\u00ea concordar\u00e1 com esses termos. \x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3ePor favor, clique aqui para mais informa\u00e7\u00f5es.\x3c/a\x3e",\n            ru : "\u041c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0444\u0430\u0439\u043b\u044b cookie, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e \u0441\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441, \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0430\u0448\u0438\u0445 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f\u0445 \u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b \u043f\u043e\u0441\u0435\u0449\u0430\u0435\u0442\u0435, \u0434\u043b\u044f \u0432\u0430\u0448\u0435\u0433\u043e \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043d\u0430\u0448 \u0441\u0430\u0439\u0442, \u0432\u044b \u0434\u0430\u0435\u0442\u0435 \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u0435 \u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 cookies\x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3e\u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435\x3c/a\x3e, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438",\n            jp : "\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u304a\u5ba2\u69d8\u3078\u306e\u30b5\u30fc\u30d3\u30b9\u5411\u4e0a\u306b\u52aa\u3081\u308b\u305f\u3081\u3001Cookie\uff08\u30af\u30c3\u30ad\u30fc\uff09\u3092\u5229\u7528\u3057\u3066\u304a\u5ba2\u69d8\u8a2d\u5b9a\u304a\u3088\u3073\u95b2\u89a7\u5c65\u6b74\u3092\u8a18\u9332\u3057\u3066\u3044\u307e\u3059\u3002\u5f53\u30b5\u30a4\u30c8\u306e\u95b2\u89a7\u3092\u7d99\u7d9a\u3059\u308b\u3053\u3068\u3067Cookie\u306e\u5229\u7528\u306b\u540c\u610f\u3055\u308c\u305f\u3082\u306e\u3068\u307f\u306a\u3055\u308c\u307e\u3059\u3002\x3cbr/\x3e\u8a73\u7d30\u306f\x3ca id\x3d\'qubit-eu-cookie-link\'\x3e\u3053\u3061\u3089\u3092\u30af\u30ea\u30c3\u30af\x3c/a\x3e\u3057\u3066\u304f\u3060\u3055\u3044\u3002",\n            fr : "Notre site utilise des cookies afin de retenir vos pr\u00e9f\u00e9rences et vos pages consult\u00e9es, vous offrant une meilleure exp\u00e9rience. En navigant sur Farfetch, vous acceptez ceci. \x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3eCliquez ici\x3c/a\x3e pour plus d\'informations.",\n            de : "Farfetch verwendet Cookies, um die Webseite bestm\u00f6glich an die Bed\u00fcrfnisse unserer Besucher anpassen zu k\u00f6nnen. Bei Verwendung unserer Webseite stimmen Sie zu, dass Cookies auf Ihrem Computer gespeichert werden.\x3cbr/\x3eF\u00fcr weitere Informationen bitte \x3ca id\x3d\'qubit-eu-cookie-link\'\x3ehier\x3c/a\x3e klicken.",\n            at : "Farfetch verwendet Cookies, um die Webseite bestm\u00f6glich an die Bed\u00fcrfnisse unserer Besucher anpassen zu k\u00f6nnen. Bei Verwendung unserer Webseite stimmen Sie zu, dass Cookies auf Ihrem Computer gespeichert werden.\x3cbr/\x3eF\u00fcr weitere Informationen bitte \x3ca id\x3d\'qubit-eu-cookie-link\'\x3ehier\x3c/a\x3e klicken.",\n            es : "Farfetch hace uso de cookies para personalizar el sitio web y adaptarse a las necesidades de sus usuarios. Al hacer uso de nuestro sitio web, aceptas que las cookies se almacenen en tu ordenador.\x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3eHaz clic aqu\u00ed\x3c/a\x3e para m\u00e1s informaci\u00f3n.",\n            mx : "Farfetch hace uso de cookies para personalizar el sitio web y adaptarse a las necesidades de sus usuarios. Al hacer uso de nuestro sitio web, aceptas que las cookies se almacenen en tu computadora.\x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3e[Haz clic aqu\u00ed\x3c/a\x3e para m\u00e1s informaci\u00f3n.",\n            kr : "\ud30c\ud398\uce58\ub294 \uace0\uac1d\ub2d8\uaed8 \uc81c\uacf5\ud558\ub294 \uc11c\ube44\uc2a4\uc758 \uc9c8\uc744 \ud5a5\uc0c1\ud558\uace0, \uace0\uac1d\ub2d8\uc758 \uc628\ub77c\uc778 \uc120\ud638\ub3c4\uc640 \uac80\uc0c9\ud558\uc2e0 \ud398\uc774\uc9c0 \ub4f1\uc758 \uc815\ubcf4\ub97c \uc800\uc7a5\ud558\uae30 \uc704\ud574 \ucfe0\ud0a4\ub97c \uc0ac\uc6a9\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4. \uc6f9\uc0ac\uc774\ud2b8\ub97c \uc774\uc6a9\ud558\uc2dc\uba74 \uc800\ud76c\uc758 \ucfe0\ud0a4 \uc815\ucc45\uc5d0 \ub3d9\uc758\ud558\uac8c \ub429\ub2c8\ub2e4. \x3ca id\x3d\'qubit-eu-cookie-link\'\x3e\uc5ec\uae30\ub97c \ud074\ub9ad\x3c/a\x3e \ud558\uace0 \uc790\uc138\ud55c \uc815\ubcf4\ub97c \ud655\uc778\ud558\uc138\uc694. ",\n            cn : "\u6211\u4eec\u5229\u7528\u6280\u672f,\u4f8b\u5982\u201ccookies\u201d,\u6765\u6536\u96c6\u8d44\u6599\u548c\u50a8\u5b58\u60a8\u5728\u4f7f\u7528\u7f51\u7ad9\u7684\u504f\u597d\u548c\u4e60\u60ef\uff0c\u4ee5\u4e3a\u60a8\u63d0\u4f9b\u66f4\u5b8c\u5584\u7684\u670d\u52a1\u3002\u4f7f\u7528\u672c\u7f51\u7ad9\u5373\u8868\u793a\u60a8\u63a5\u53d7\u4ee5\u4e0a\u6240\u8ff0\u7684\u505a\u6cd5\u3002\u3002\x3cbr/\x3e\x3ca id\x3d\'qubit-eu-cookie-link\'\x3e\u70b9\u51fb\u6b64\u5904\x3c/a\x3e\uff0c\u4e86\u89e3\u8be6\u60c5"\n          };\n          \n          var disclaimer \x3d disclaimerConfig.en;\n          var language \x3d "en";\n          var detectedLanguage \x3d window.navigator.userLanguage || window.navigator.language;\n          var url \x3d window.location.href.toLowerCase();\n          var subfolder \x3d uv.page.subfolder.substring(1);\n          \n          if( disclaimerConfig \x26\x26 disclaimerConfig[subfolder] \x26\x26 typeof disclaimerConfig[subfolder] !\x3d\x3d \'undefined\' ){\n            disclaimer \x3d disclaimerConfig[subfolder];\n          }\n          \n          $("#qubit-eu-cookie").remove();\n          $("\x3cdiv id\x3d\'qubit-eu-cookie\' /\x3e").appendTo("body");\n          $("\x3cdiv id\x3d\'qubit-eu-cookie-main-container\'/\x3e")\n          .appendTo("#qubit-eu-cookie")\n          .append("\x3cdiv id\x3d\'qubit-eu-cookie-text\'\x3e"+disclaimer+"\x3c/div\x3e\x3cdiv id\x3d\'qubit-eu-cookie-close\'/\x3e")\n          .click(function() {\n            $("#qubit-eu-cookie").fadeOut();\n          });\n          \n          $("#qubit-eu-cookie-close").click(function() {\n            $("#qubit-eu-cookie").fadeOut();\n          });\n          \n          $("#qubit-eu-cookie-link")\n          .attr(\'href\', "https://www.farfetch.com/privacy-policy")\n          .attr(\'target\', \'_blank\')\n          .click(function() {\n            $("#qubit-eu-cookie").fadeOut();\n          });\n          \n          $("#qubit-eu-cookie").fadeIn();\n\n          createCookie("dontshowqubiteucookie", 0, 365, ".${CURRENTDOMAIN}");\n        });\n      } \n      else {\n        setTimeout(function(){\n          waitForjQuery();\n        }, 100);\n      }\n    };\n    \n    if( notMobile() \x3d\x3d\x3d true \x26\x26 !(/dontshowqubiteucookie/).test(document.cookie) ){\n      waitForjQuery();\n    }\n  })();\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.OnlyIfDontshowqubiteucookieCookieIsNotPresentAndNotOnHttps"]);tag.addClientVariablesMap({"CURRENTDOMAIN":"live.variables.CurrentDomain1"});tag.addParameters([{"name":"CURRENTDOMAIN","token":"CURRENTDOMAIN"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.userineu.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_Checkout_Steps","description":"Identify Checkout Steps","disabled":true});var pkg="live.tags.gacheckoutsteps.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag"]);
tag.pre=function(){};tag.script=function(){function items(){var i=0;for(var len=universal_variable.basket.line_items.length;i<len;i++)ga("ec:addProduct",{"id":universal_variable.basket.line_items[i].product.id,"name":universal_variable.basket.line_items[i].product.name,"price":universal_variable.basket.line_items[i].product.unit_sale_price,"brand":universal_variable.basket.line_items[i].product.designerName,"category":universal_variable.basket.line_items[i].product.category,"quantity":universal_variable.basket.line_items[i].quantity})}
var userLocation=window.location.href;var step="";if(userLocation.indexOf("shippingaddress.aspx")>-1||uv!==undefined&&uv.hasOwnProperty("page")&&uv.page.hasOwnProperty("pageStep")&&uv.page.pageStep.toLowerCase()==="shippingaddress")step=1;else if(userLocation.indexOf("payment.aspx")>-1||uv!==undefined&&uv.hasOwnProperty("page")&&uv.page.hasOwnProperty("pageStep")&&uv.page.pageStep.toLowerCase()==="payment")step=2;else if(userLocation.indexOf("revieworder.aspx")>-1||uv!==undefined&&uv.hasOwnProperty("page")&&
uv.page.hasOwnProperty("pageStep")&&uv.page.pageStep.toLowerCase()==="review")step=3;else if(userLocation.indexOf("GuestUser/Guest")>-1)step=1;else return;items();ga("ec:setAction","checkout",{"step":step});ga("send","event","checkout",step,location.href,0,{nonInteraction:true})};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"Rule - UV pageId available"});var pkg="live.tags.ruleuvpageidavailable.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.UVPageIdAvailable"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Adobe Lens - Confirmation","disabled":true,"id":35687112,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.adobelensconfirmation.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript language\x3d"javascript"\x3e\n(function() {\n    try {\n        var uv \x3d window.universal_variable;\n        var adobe_code \x3d \'3517\';\n        switch (uv.page.subfolder) {\n            case \'/br\':\n                adobe_code \x3d \'3670\';\n                break;\n        }\n\n        var typeOfUser \x3d uv.transaction.is_first_order ? "new" : "existing";\n        var host \x3d "https://pixel.everesttech.net/px2/" + adobe_code + "/?" +\n            "px_evt\x3dt\x26ev_" + typeOfUser + "_customer\x3d1" +\n            "\x26ev_Revenue_" + uv.transaction.currency + "\x3d" + uv.transaction.subtotal +\n            "\x26ev_shipping_cost_" + uv.transaction.currency + "\x3d" + uv.transaction.shipping_cost +\n            "\x26ev_no_item_bought\x3d" + uv.transaction.line_items.length +\n            "\x26ev_order\x3d1" +\n            "\x26ev_transid\x3d" + uv.transaction.order_id;\n\n        var img \x3d document.createElement("img");\n        img.style.display \x3d "none";\n        img.width \x3d "1";\n        img.height \x3d "1";\n        img.src \x3d host;\n        document.body.appendChild(img);\n\n        ffLogger.tagLogger("Adobe Lens - Confirmation", {\'Host\': host}, ffLogger.LogLevelEnum.INFO);\n    } catch (e) {\n        ffLogger.tagLogger("Adobe Lens - Confirmation", e, ffLogger.LogLevelEnum.ERROR);\n    }\n})();\n\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.DefaultFilterMatchAll","live.filters.ExcludeIfRU"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleconfirmationpage.Tag","live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Qubit UV Mapper (qprotocol)","disabled":false,"id":40383657,"locked":false,"locationObject":"HEAD"});var pkg="live.tags.qubituvmapperqprotocol.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\n/*\n  Git commit sha: b8df2116d35bd6707d789b6ff73fb77ab299e9b1\n  Map name: universal-variable-ec\n*/\n(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a\x3dtypeof require\x3d\x3d"function"\x26\x26require;if(!u\x26\x26a)return a(o,!0);if(i)return i(o,!0);var f\x3dnew Error("Cannot find module \'"+o+"\'");throw f.code\x3d"MODULE_NOT_FOUND",f}var l\x3dn[o]\x3d{exports:{}};t[o][0].call(l.exports,function(e){var n\x3dt[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i\x3dtypeof require\x3d\x3d"function"\x26\x26require;for(var o\x3d0;o\x3cr.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar isoCountries\x3d{AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D\'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island \x26 Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People\'s Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};module.exports\x3dfunction(a){return a\x26\x26isoCountries[a.toUpperCase()]||a};\n\n\n},{}],2:[function(require,module,exports){\nvar each\x3drequire("amp-each"),isNumber\x3drequire("amp-is-number"),isEmpty\x3drequire("amp-is-empty");module.exports\x3dfunction(e){var r\x3d{};return each(e,function(e,i){(!isEmpty(e)||isNumber(e))\x26\x26(r[i]\x3de)}),r};\n\n\n},{"amp-each":36,"amp-is-empty":60,"amp-is-number":68}],3:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number"),isString\x3drequire("amp-is-string");module.exports\x3dfunction(r){return isNumber(r)?r:isString(r)\x26\x26r.length\x3e0\x26\x26!isNaN(Number(r))?Number(r):void 0};\n\n\n},{"amp-is-number":68,"amp-is-string":70}],4:[function(require,module,exports){\nfunction pollFor(o,l){return o()?void l():void setTimeout(function(){poll(o,l,50)},0)}function poll(o,l,t){return o()?void l():void setTimeout(function(){poll(o,l,2*t)},t)}module.exports\x3dpollFor;\n\n\n},{}],5:[function(require,module,exports){\nvar values\x3drequire("amp-values"),mapper\x3drequire("./mapper"),mapFiles\x3d{"..":{maps:{"universal-variable-ec":{"ec-basket-item-transaction":require("../maps/universal-variable-ec/ec-basket-item-transaction.js"),"ec-basket-item":require("../maps/universal-variable-ec/ec-basket-item.js"),"ec-product-interaction":require("../maps/universal-variable-ec/ec-product-interaction.js"),"ec-product-recommendation":require("../maps/universal-variable-ec/ec-product-recommendation.js"),"ec-product":require("../maps/universal-variable-ec/ec-product.js"),search:require("../maps/universal-variable-ec/search.js"),user:require("../maps/universal-variable-ec/user.js"),view:require("../maps/universal-variable-ec/view.js")}}}},maps\x3dvalues(mapFiles[".."].maps["universal-variable-ec"]),uv\x3dwindow.uv;uv\x26\x26uv.events\x26\x26mapper(maps,uv);\n},{"../maps/universal-variable-ec/ec-basket-item-transaction.js":7,"../maps/universal-variable-ec/ec-basket-item.js":8,"../maps/universal-variable-ec/ec-product-interaction.js":9,"../maps/universal-variable-ec/ec-product-recommendation.js":10,"../maps/universal-variable-ec/ec-product.js":11,"../maps/universal-variable-ec/search.js":27,"../maps/universal-variable-ec/user.js":28,"../maps/universal-variable-ec/view.js":29,"./mapper":6,"amp-values":103}],6:[function(require,module,exports){\nfunction viewEvents(e){return filter(e,function(e){return"View"\x3d\x3d\x3de.eventType})}function notViewEvents(e){return filter(e,function(e){return"View"!\x3d\x3de.eventType})}var each\x3drequire("amp-each"),filter\x3drequire("amp-filter");module.exports\x3dfunction(e,n){function t(e){function t(){var t\x3de.mapFn.apply(this,arguments);t?n.emit(e.eventType,t):n.emit(e.eventType)}e.activation?e.activation(t):t()}n.once("View",function(){each(notViewEvents(e),t)}),each(viewEvents(e),t)};\n\n\n},{"amp-each":36,"amp-filter":51}],7:[function(require,module,exports){\nvar each\x3drequire("amp-each"),extend\x3drequire("amp-extend"),pollFor\x3drequire("../../helpers/poll-for"),convertBasket\x3drequire("./helpers/convert-basket"),convertProduct\x3drequire("./helpers/convert-product"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),convertTransaction\x3drequire("./helpers/convert-transaction"),customItem\x3drequire("./helpers/custom-item"),customProduct\x3drequire("./helpers/custom-product"),customTransaction\x3drequire("./helpers/custom-transaction"),getPrice\x3drequire("./helpers/get-price"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"ec.BasketItemTransaction",activation:function(e){function t(){return window.universal_variable\x26\x26window.universal_variable.transaction}function r(){each(window.universal_variable.transaction.line_items,e)}pollFor(t,r)},mapFn:function(e){var t\x3dwindow.universal_variable.transaction;return excludeEmpty({product:convertProduct(e.product),basket:convertBasket(t,t.order_id),stock:ifNumberThenCast(e.product.stock),color:e.product.color,size:e.product.size,quantity:ifNumberThenCast(e.quantity),subtotal:getPrice(e.product,e.subtotal),shippingMethod:e.shipping_method,shippingCost:getPrice(e.product,e.shipping_cost),transaction:convertTransaction(t),custom:extend(customTransaction(t),customProduct(e.product),customItem(e))})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/convert-basket":13,"./helpers/convert-product":14,"./helpers/convert-transaction":15,"./helpers/custom-item":18,"./helpers/custom-product":21,"./helpers/custom-transaction":22,"./helpers/get-price":26,"amp-each":36,"amp-extend":49}],8:[function(require,module,exports){\nvar each\x3drequire("amp-each"),extend\x3drequire("amp-extend"),pollFor\x3drequire("../../helpers/poll-for"),convertBasket\x3drequire("./helpers/convert-basket"),convertProduct\x3drequire("./helpers/convert-product"),customItem\x3drequire("./helpers/custom-item"),customBasket\x3drequire("./helpers/custom-basket"),customProduct\x3drequire("./helpers/custom-product"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),getPrice\x3drequire("./helpers/get-price"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"ec.BasketItem",activation:function(e){function t(){var e\x3dwindow.universal_variable\x26\x26window.universal_variable.transaction;return window.universal_variable\x26\x26window.universal_variable.basket\x26\x26!e}function r(){each(window.universal_variable.basket.line_items,e)}pollFor(t,r)},mapFn:function(e){var t\x3dwindow.universal_variable.basket;return excludeEmpty({product:convertProduct(e.product),basket:convertBasket(t,t.id),stock:ifNumberThenCast(e.product.stock),color:e.product.color,size:e.product.size,quantity:ifNumberThenCast(e.quantity),subtotal:getPrice(e.product,e.subtotal),shippingMethod:e.shipping_method,shippingCost:getPrice(e.product,e.shipping_cost),custom:extend(customBasket(t),customProduct(e.product),customItem(e))})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/convert-basket":13,"./helpers/convert-product":14,"./helpers/custom-basket":17,"./helpers/custom-item":18,"./helpers/custom-product":21,"./helpers/get-price":26,"amp-each":36,"amp-extend":49}],9:[function(require,module,exports){\nvar pollFor\x3drequire("../../helpers/poll-for"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),convertProduct\x3drequire("./helpers/convert-product"),customProduct\x3drequire("./helpers/custom-product"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"ec.ProductInteraction",activation:function(e){function r(){return window.universal_variable\x26\x26window.universal_variable.product}function o(){e(window.universal_variable.product)}pollFor(r,o)},mapFn:function(e){return excludeEmpty({product:convertProduct(e),stock:ifNumberThenCast(e.stock),color:e.color,size:e.size,action:"detail",custom:customProduct(e)})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/convert-product":14,"./helpers/custom-product":21}],10:[function(require,module,exports){\nvar each\x3drequire("amp-each"),pollFor\x3drequire("../../helpers/poll-for"),convertProduct\x3drequire("./helpers/convert-product"),customProduct\x3drequire("./helpers/custom-product"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"ec.ProductRecommendation",activation:function(e){function r(){var e\x3dwindow.universal_variable\x26\x26window.universal_variable.recommendation;return e\x26\x26e.items\x26\x26e.items.length\x3e0}function o(){each(window.universal_variable.recommendation.items,e)}pollFor(r,o)},mapFn:function(e,r,o){return excludeEmpty({product:convertProduct(e),stock:ifNumberThenCast(e.stock),color:e.color,size:e.size,rank:1\x3d\x3d\x3do.length?0:r/(o.length-1),custom:customProduct(e)})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/convert-product":14,"./helpers/custom-product":21,"amp-each":36}],11:[function(require,module,exports){\nvar each\x3drequire("amp-each"),uuid\x3drequire("really-unique-id"),pollFor\x3drequire("../../helpers/poll-for"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),convertProduct\x3drequire("./helpers/convert-product"),customProduct\x3drequire("./helpers/custom-product"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"ec.Product",activation:function(e){function r(){var e\x3dwindow.universal_variable\x26\x26window.universal_variable.listing;return window.universal_variable\x26\x26window.universal_variable.product||e\x26\x26e.items\x26\x26e.items.length\x3e0}function i(){if(window.universal_variable.product){var r\x3d{};window.universal_variable.product.linked_products\x26\x26window.universal_variable.product.linked_products.length\x3e0\x26\x26(r.uuid\x3duuid(),each(window.universal_variable.product.linked_products,e,r)),e.call(r,window.universal_variable.product)}else{var i\x3dwindow.universal_variable.listing.items.slice(0,4);each(i,e)}}pollFor(r,i)},mapFn:function(e){return excludeEmpty({product:convertProduct(e,this.uuid),stock:ifNumberThenCast(e.stock),color:e.color,size:e.size,custom:customProduct(e)})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/convert-product":14,"./helpers/custom-product":21,"amp-each":36,"really-unique-id":106}],12:[function(require,module,exports){\nvar excludeEmpty\x3drequire("../../../helpers/exclude-empty"),convertCountryCode\x3drequire("../../../helpers/convert-country-code");module.exports\x3dfunction(e){if(e){var r\x3dexcludeEmpty({recipient:e.name,locality:e.city,region:e.state,postalCode:e.postcode,country:convertCountryCode(e.country),countryCode:e.country});return e.address\x26\x26e.address.length\x26\x26(r.lines\x3d[e.address]),excludeEmpty(r)}};\n\n\n},{"../../../helpers/convert-country-code":1,"../../../helpers/exclude-empty":2}],13:[function(require,module,exports){\nvar reduce\x3drequire("amp-reduce"),isBoolean\x3drequire("amp-is-boolean"),excludeEmpty\x3drequire("../../../helpers/exclude-empty"),ifNumberThenCast\x3drequire("../../../helpers/if-number-then-cast"),getPrice\x3drequire("./get-price");module.exports\x3dfunction(e,t){function i(e,t){return ifNumberThenCast(t.quantity)?ifNumberThenCast(t.quantity)+e:e}if(e){var r\x3dexcludeEmpty({id:t,subtotal:getPrice(e,e.subtotal),total:getPrice(e,e.total),vouchers:e.vouchers,voucherDiscount:getPrice(e,e.voucher_discount),promotions:e.promotions,promotionDiscount:getPrice(e,e.promotion_discount),tax:getPrice(e,e.tax),shippingPrice:getPrice(e,e.shipping_cost),shippingMethod:e.shipping_method});if(e.line_items\x26\x26e.line_items.length){var o\x3d0;r.quantity\x3dreduce(e.line_items,i,o)}return e.tax\x26\x26isBoolean(e.subtotal_include_tax)\x26\x26!e.subtotal_include_tax\x26\x26(r.subtotal.value+\x3de.tax),r}};\n\n\n},{"../../../helpers/exclude-empty":2,"../../../helpers/if-number-then-cast":3,"./get-price":26,"amp-is-boolean":59,"amp-reduce":98}],14:[function(require,module,exports){\nvar getPrice\x3drequire("./get-price"),getCategory\x3drequire("./get-category"),excludeEmpty\x3drequire("../../../helpers/exclude-empty");module.exports\x3dfunction(e,r){if(e){var i\x3dexcludeEmpty({name:e.name,id:e.id,sku:e.sku_code,url:e.url,description:e.description,manufacturer:e.manufacturer,stock:e.stock,groupId:r});return i.price\x3dgetPrice(e,e.unit_sale_price||e.unit_price),i.originalPrice\x3dgetPrice(e,e.unit_price||e.unit_sale_price),i.category\x3dgetCategory(e),e.color\x26\x26(i.colors\x3d[e.color]),e.image\x26\x26(i.images\x3d[e.image]),e.size\x26\x26(i.sizes\x3d[e.size]),excludeEmpty(i)}};\n\n\n},{"../../../helpers/exclude-empty":2,"./get-category":25,"./get-price":26}],15:[function(require,module,exports){\nvar isBoolean\x3drequire("amp-is-boolean"),excludeEmpty\x3drequire("../../../helpers/exclude-empty"),convertAddress\x3drequire("./convert-address");module.exports\x3dfunction(e){if(e){var r\x3dexcludeEmpty({id:e.order_id,paymentType:e.payment_type,billingAddress:convertAddress(e.billing),deliveryAddress:convertAddress(e.delivery)});return isBoolean(e.returning)\x26\x26(r.firstTransaction\x3d!e.returning),r}};\n\n\n},{"../../../helpers/exclude-empty":2,"./convert-address":12,"amp-is-boolean":59}],16:[function(require,module,exports){\nfunction parseName(e){var a\x3d{};return a.title\x3dgetMatch(e,/(mr|mrs|miss|dr)?\\.?\\s+/i,0),a.title?a.firstName\x3dgetMatch(e,/(mr|mrs|miss|dr)?\\.?\\s+([a-z-\']+)/i,1):a.firstName\x3dgetMatch(e,/([a-z-\\\']+)/i,0),a.lastName\x3dgetMatch(e,/\\b([a-z-\\\']+)$/i,0),capitalizeValues(a)}function capitalizeValues(e){var a\x3d{};return each(excludeEmpty(e),function(e,t){a[t]\x3dcapitalize(e)}),a}function getMatch(e,a,t){return e.match(a)\x26\x26e.match(a)[t+1]}var isBoolean\x3drequire("amp-is-boolean"),each\x3drequire("amp-each"),capitalize\x3drequire("capitalize"),excludeEmpty\x3drequire("../../../helpers/exclude-empty");module.exports\x3dfunction(e){if(e){var a\x3d{};e.name\x26\x26e.name.length\x26\x26(a\x3dparseName(e.name));var t\x3dexcludeEmpty({id:e.user_id,title:a.title,firstName:a.firstName,lastName:a.lastName,gender:e.gender,username:e.username,email:e.email,language:e.language,hasTransacted:e.has_transacted,facebookId:e.facebook_id,twitterId:e.twitter_id,currency:e.currency});return isBoolean(e.returning)\x26\x26(t.firstSession\x3d!e.returning),t}};\n\n\n},{"../../../helpers/exclude-empty":2,"amp-each":36,"amp-is-boolean":59,"capitalize":104}],17:[function(require,module,exports){\nfunction customBasket(t){return findCustom(t,["id","currency","subtotal","subtotal_include_tax","vouchers","voucher_discount","promotions","promotion_discount","tax","shipping_cost","shipping_method","total","line_items"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomBasket;\n\n\n},{"./find-custom":24}],18:[function(require,module,exports){\nfunction customItem(t){return findCustom(t,["product","quantity","subtotal","shipping_method","shipping_cost"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomItem;\n\n\n},{"./find-custom":24}],19:[function(require,module,exports){\nfunction customListing(t){return findCustom(t,["query","items","result_count","sort_by","layout"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomListing;\n\n\n},{"./find-custom":24}],20:[function(require,module,exports){\nfunction customPage(e){return findCustom(e,["type","breadcrumb","environment","category","subcategory"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomPage;\n\n\n},{"./find-custom":24}],21:[function(require,module,exports){\nfunction customProduct(r){return findCustom(r,["id","url","name","description","manufacturer","category","subcategory","linked_products","currency","unit_sale_price","unit_price","sku_code","stock","color","size"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomProduct;\n\n\n},{"./find-custom":24}],22:[function(require,module,exports){\nfunction customTransaction(t){return findCustom(t,["order_id","returning","currency","payment_type","subtotal","subtotal_include_tax","vouchers","voucher_discount","promotions","promotion_discount","tax","shipping_cost","shipping_method","total","delivery","billing","line_items"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomTransaction;\n\n\n},{"./find-custom":24}],23:[function(require,module,exports){\nfunction customUser(e){return findCustom(e,["name","username","user_id","email","language","returning","has_transacted","facebook_id","twitter_id"])}var findCustom\x3drequire("./find-custom");module.exports\x3dcustomUser;\n\n\n},{"./find-custom":24}],24:[function(require,module,exports){\nfunction findCustom(e,r){if(!e)return{};var i\x3dkeys(e),t\x3dfilter(i,function(r){return!isObject(e[r])||isSimpleArray(e[r])}),u\x3ddifference(t,r);return pick(e,u)}function isSimpleArray(e){return isArray(e)\x26\x26every(e,function(e){return!isObject(e)})}var keys\x3drequire("amp-keys"),pick\x3drequire("amp-pick"),filter\x3drequire("amp-filter"),every\x3drequire("amp-every"),isObject\x3drequire("amp-is-object"),isArray\x3drequire("amp-is-array"),difference\x3drequire("amp-difference");module.exports\x3dfindCustom;\n\n\n},{"amp-difference":30,"amp-every":42,"amp-filter":51,"amp-is-array":58,"amp-is-object":69,"amp-keys":71,"amp-pick":92}],25:[function(require,module,exports){\nmodule.exports\x3dfunction(r){var e\x3dr.breadcrumb||[];return e.length\x3e0?e:(r.category\x26\x26e.push(r.category),r.subcategory\x26\x26e.push(r.subcategory),e)};\n\n\n},{}],26:[function(require,module,exports){\nvar ifNumberThenCast\x3drequire("../../../helpers/if-number-then-cast");module.exports\x3dfunction(r,e){var n\x3difNumberThenCast(e);if(void 0\x3d\x3d\x3dn)return{};var a\x3d{value:n},t\x3dr.currency,u\x3dwindow.universal_variable;return!t\x26\x26u\x26\x26(t\x3du.basket\x26\x26u.basket.currency||u.transaction\x26\x26u.transaction.currency),t\x26\x26(a.currency\x3dt),a};\n\n\n},{"../../../helpers/if-number-then-cast":3}],27:[function(require,module,exports){\nvar pollFor\x3drequire("../../helpers/poll-for"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),customListing\x3drequire("./helpers/custom-listing"),ifNumberThenCast\x3drequire("../../helpers/if-number-then-cast");module.exports\x3d{eventType:"Search",activation:function(e){function i(){return window.universal_variable\x26\x26window.universal_variable.listing\x26\x26window.universal_variable.listing.query\x26\x26window.universal_variable.listing.query.length}function r(){e(window.universal_variable.listing)}pollFor(i,r)},mapFn:function(e){return excludeEmpty({query:e.query,pagination:e.items.length,count:ifNumberThenCast(e.result_count),sortBy:e.sort_by,layout:e.layout,custom:customListing(e)})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/if-number-then-cast":3,"../../helpers/poll-for":4,"./helpers/custom-listing":19}],28:[function(require,module,exports){\nvar pollFor\x3drequire("../../helpers/poll-for"),excludeEmpty\x3drequire("../../helpers/exclude-empty"),convertUser\x3drequire("./helpers/convert-user"),customUser\x3drequire("./helpers/custom-user");module.exports\x3d{eventType:"User",activation:function(e){function r(){return window.universal_variable\x26\x26window.universal_variable.user}function u(){e(window.universal_variable.user)}pollFor(r,u)},mapFn:function(e){return excludeEmpty({user:convertUser(e),custom:customUser(e)})}};\n\n\n},{"../../helpers/exclude-empty":2,"../../helpers/poll-for":4,"./helpers/convert-user":16,"./helpers/custom-user":23}],29:[function(require,module,exports){\nvar getCategory\x3drequire("./helpers/get-category"),customPage\x3drequire("./helpers/custom-page"),excludeEmpty\x3drequire("../../helpers/exclude-empty");module.exports\x3d{eventType:"View",activation:function(e){window.universal_variable\x26\x26window.universal_variable.page?e(window.universal_variable.page):e()},mapFn:function(e){return e?excludeEmpty({type:e.type||e.category,category:getCategory(window.universal_variable.page),environment:e.environment,custom:customPage(e)}):{}}};\n\n\n},{"../../helpers/exclude-empty":2,"./helpers/custom-page":20,"./helpers/get-category":25}],30:[function(require,module,exports){\nvar filter\x3drequire("amp-filter"),flatten\x3drequire("amp-internal-flatten"),contains\x3drequire("amp-contains");module.exports\x3dfunction(t){var e\x3dflatten(arguments,!0,!0,1);return filter(t,function(t){return!contains(e,t)})};\n\n\n},{"amp-contains":31,"amp-filter":51,"amp-internal-flatten":33}],31:[function(require,module,exports){\nvar values\x3drequire("amp-values"),indexOf\x3drequire("amp-index-of");module.exports\x3dfunction(e,n){return null\x3d\x3de?!1:(e.length!\x3d\x3d+e.length\x26\x26(e\x3dvalues(e)),indexOf(e,n)\x3e\x3d0)};\n\n\n},{"amp-index-of":32,"amp-values":103}],32:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],33:[function(require,module,exports){\nvar isArray\x3drequire("amp-is-array"),isArguments\x3drequire("amp-is-arguments"),flatten\x3dfunction r(e,t,a,n){for(var s,i\x3d[],l\x3d0,u\x3dn||0,g\x3de\x26\x26e.length;g\x3eu;u++)if(s\x3de[u],s\x26\x26s.length\x3e\x3d0\x26\x26(isArray(s)||isArguments(s))){t||(s\x3dr(s,t,a));var f\x3d0,m\x3ds.length;for(i.length+\x3dm;m\x3ef;)i[l++]\x3ds[f++]}else a||(i[l++]\x3ds);return i};module.exports\x3dflatten;\n\n\n},{"amp-is-arguments":34,"amp-is-array":35}],34:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,hasOwn\x3dObject.prototype.hasOwnProperty,isArgs\x3dfunction(t){return"[object Arguments]"\x3d\x3d\x3dtoString.call(t)};isArgs(arguments)||(isArgs\x3dfunction(t){return t\x26\x26hasOwn.call(t,"callee")}),module.exports\x3disArgs;\n\n\n},{}],35:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,nativeIsArray\x3dArray.isArray;module.exports\x3dnativeIsArray||function(r){return"[object Array]"\x3d\x3d\x3dtoString.call(r)};\n\n\n},{}],36:[function(require,module,exports){\nvar objKeys\x3drequire("amp-keys"),createCallback\x3drequire("amp-create-callback");module.exports\x3dfunction(e,r,a){if(null\x3d\x3de)return e;r\x3dcreateCallback(r,a);var l,t\x3de.length;if(t\x3d\x3d\x3d+t)for(l\x3d0;t\x3el;l++)r(e[l],l,e);else{var c\x3dobjKeys(e);for(l\x3d0,t\x3dc.length;t\x3el;l++)r(e[c[l]],c[l],e)}return e};\n\n\n},{"amp-create-callback":37,"amp-keys":38}],37:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],38:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":39,"amp-index-of":40,"amp-is-object":41}],39:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],40:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],41:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],42:[function(require,module,exports){\nvar objKeys\x3drequire("amp-keys"),iteratee\x3drequire("amp-iteratee");module.exports\x3dfunction(e,r,t){if(null\x3d\x3de)return!0;var n,i,u\x3de.length!\x3d\x3d+e.length\x26\x26objKeys(e),a\x3d(u||e).length;for(r\x3diteratee(r,t),n\x3d0;a\x3en;n++)if(i\x3du?u[n]:n,!r(e[i],i,e))return!1;return!0};\n\n\n},{"amp-iteratee":43,"amp-keys":71}],43:[function(require,module,exports){\nvar isFunction\x3drequire("amp-is-function"),isObject\x3drequire("amp-is-object"),createCallback\x3drequire("amp-create-callback"),matches\x3drequire("amp-matches"),property\x3drequire("amp-property"),identity\x3dfunction(e){return e};module.exports\x3dfunction(e,r,t){return null\x3d\x3de?identity:isFunction(e)?createCallback(e,r,t):isObject(e)?matches(e):property(e)};\n\n\n},{"amp-create-callback":44,"amp-is-function":45,"amp-is-object":69,"amp-matches":46,"amp-property":48}],44:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],45:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,func\x3dfunction(t){return"[object Function]"\x3d\x3d\x3dtoString.call(t)};"function"!\x3dtypeof/./\x26\x26(func\x3dfunction(t){return"function"\x3d\x3dtypeof t||!1}),module.exports\x3dfunc;\n\n\n},{}],46:[function(require,module,exports){\nvar getPairs\x3drequire("amp-pairs");module.exports\x3dfunction(r){var e\x3dgetPairs(r),n\x3de.length;return function(r){if(null\x3d\x3dr)return!n;r\x3dnew Object(r);for(var t\x3d0;n\x3et;t++){var i\x3de[t],u\x3di[0];if(i[1]!\x3d\x3dr[u]||!(u in r))return!1}return!0}};\n\n\n},{"amp-pairs":47}],47:[function(require,module,exports){\nvar objKeys\x3drequire("amp-keys");module.exports\x3dfunction(r){for(var e\x3dobjKeys(r),o\x3de.length,a\x3dArray(o),n\x3d0;o\x3en;n++)a[n]\x3d[e[n],r[e[n]]];return a};\n\n\n},{"amp-keys":71}],48:[function(require,module,exports){\nmodule.exports\x3dfunction(n){return function(u){return null\x3d\x3du?void 0:u[n]}};\n\n\n},{}],49:[function(require,module,exports){\nvar isObject\x3drequire("amp-is-object");module.exports\x3dfunction(r){if(!isObject(r))return r;for(var e,t,n\x3d1,i\x3darguments.length;i\x3en;n++){e\x3darguments[n];for(t in e)r[t]\x3de[t]}return r};\n\n\n},{"amp-is-object":50}],50:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],51:[function(require,module,exports){\nvar iteratee\x3drequire("amp-iteratee"),each\x3drequire("amp-each");module.exports\x3dfunction(e,r,a){var t\x3d[];return null\x3d\x3de?t:(r\x3diteratee(r,a),each(e,function(e,a,u){r(e,a,u)\x26\x26t.push(e)}),t)};\n\n\n},{"amp-each":36,"amp-iteratee":52}],52:[function(require,module,exports){\nvar isFunction\x3drequire("amp-is-function"),isObject\x3drequire("amp-is-object"),createCallback\x3drequire("amp-create-callback"),matches\x3drequire("amp-matches"),property\x3drequire("amp-property"),identity\x3dfunction(e){return e};module.exports\x3dfunction(e,r,t){return null\x3d\x3de?identity:isFunction(e)?createCallback(e,r,t):isObject(e)?matches(e):property(e)};\n\n\n},{"amp-create-callback":53,"amp-is-function":54,"amp-is-object":69,"amp-matches":55,"amp-property":57}],53:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],54:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,func\x3dfunction(t){return"[object Function]"\x3d\x3d\x3dtoString.call(t)};"function"!\x3dtypeof/./\x26\x26(func\x3dfunction(t){return"function"\x3d\x3dtypeof t||!1}),module.exports\x3dfunc;\n\n\n},{}],55:[function(require,module,exports){\nvar getPairs\x3drequire("amp-pairs");module.exports\x3dfunction(r){var e\x3dgetPairs(r),n\x3de.length;return function(r){if(null\x3d\x3dr)return!n;r\x3dnew Object(r);for(var t\x3d0;n\x3et;t++){var i\x3de[t],u\x3di[0];if(i[1]!\x3d\x3dr[u]||!(u in r))return!1}return!0}};\n\n\n},{"amp-pairs":56}],56:[function(require,module,exports){\nvar objKeys\x3drequire("amp-keys");module.exports\x3dfunction(r){for(var e\x3dobjKeys(r),o\x3de.length,a\x3dArray(o),n\x3d0;o\x3en;n++)a[n]\x3d[e[n],r[e[n]]];return a};\n\n\n},{"amp-keys":71}],57:[function(require,module,exports){\nmodule.exports\x3dfunction(n){return function(u){return null\x3d\x3du?void 0:u[n]}};\n\n\n},{}],58:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,nativeIsArray\x3dArray.isArray;module.exports\x3dnativeIsArray||function(r){return"[object Array]"\x3d\x3d\x3dtoString.call(r)};\n\n\n},{}],59:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString;module.exports\x3dfunction(t){return t\x3d\x3d\x3d!0||t\x3d\x3d\x3d!1||"[object Boolean]"\x3d\x3d\x3dtoString.call(t)};\n\n\n},{}],60:[function(require,module,exports){\nvar isArray\x3drequire("amp-is-array"),isString\x3drequire("amp-is-string"),isArguments\x3drequire("amp-is-arguments"),isNumber\x3drequire("amp-is-number"),isNan\x3drequire("amp-is-nan"),keys\x3drequire("amp-keys");module.exports\x3dfunction(r){return null\x3d\x3dr?!0:isArray(r)||isString(r)||isArguments(r)?0\x3d\x3d\x3dr.length:isNumber(r)?0\x3d\x3d\x3dr||isNan(r):0!\x3d\x3dkeys(r).length?!1:!0};\n\n\n},{"amp-is-arguments":61,"amp-is-array":62,"amp-is-nan":63,"amp-is-number":68,"amp-is-string":70,"amp-keys":64}],61:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,hasOwn\x3dObject.prototype.hasOwnProperty,isArgs\x3dfunction(t){return"[object Arguments]"\x3d\x3d\x3dtoString.call(t)};isArgs(arguments)||(isArgs\x3dfunction(t){return t\x26\x26hasOwn.call(t,"callee")}),module.exports\x3disArgs;\n\n\n},{}],62:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,nativeIsArray\x3dArray.isArray;module.exports\x3dnativeIsArray||function(r){return"[object Array]"\x3d\x3d\x3dtoString.call(r)};\n\n\n},{}],63:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r){return isNumber(r)\x26\x26r!\x3d\x3d+r};\n\n\n},{"amp-is-number":68}],64:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":65,"amp-index-of":66,"amp-is-object":67}],65:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],66:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],67:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],68:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString;module.exports\x3dfunction(t){return"[object Number]"\x3d\x3d\x3dtoString.call(t)};\n\n\n},{}],69:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],70:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString;module.exports\x3dfunction(t){return"[object String]"\x3d\x3d\x3dtoString.call(t)};\n\n\n},{}],71:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":72,"amp-index-of":73,"amp-is-object":74}],72:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],73:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],74:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],75:[function(require,module,exports){\nvar createIteratee\x3drequire("amp-iteratee"),objKeys\x3drequire("amp-keys");module.exports\x3dfunction(e,r,t){if(null\x3d\x3de)return[];r\x3dcreateIteratee(r,t,3);for(var a,n\x3de.length!\x3d\x3d+e.length\x26\x26objKeys(e),u\x3d(n||e).length,l\x3dArray(u),o\x3d0;u\x3eo;o++)a\x3dn?n[o]:o,l[o]\x3dr(e[a],a,e);return l};\n\n\n},{"amp-iteratee":76,"amp-keys":83}],76:[function(require,module,exports){\nvar isFunction\x3drequire("amp-is-function"),isObject\x3drequire("amp-is-object"),createCallback\x3drequire("amp-create-callback"),matches\x3drequire("amp-matches"),property\x3drequire("amp-property"),identity\x3dfunction(e){return e};module.exports\x3dfunction(e,r,t){return null\x3d\x3de?identity:isFunction(e)?createCallback(e,r,t):isObject(e)?matches(e):property(e)};\n\n\n},{"amp-create-callback":77,"amp-is-function":78,"amp-is-object":79,"amp-matches":80,"amp-property":82}],77:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],78:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,func\x3dfunction(t){return"[object Function]"\x3d\x3d\x3dtoString.call(t)};"function"!\x3dtypeof/./\x26\x26(func\x3dfunction(t){return"function"\x3d\x3dtypeof t||!1}),module.exports\x3dfunc;\n\n\n},{}],79:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],80:[function(require,module,exports){\nvar getPairs\x3drequire("amp-pairs");module.exports\x3dfunction(r){var e\x3dgetPairs(r),n\x3de.length;return function(r){if(null\x3d\x3dr)return!n;r\x3dnew Object(r);for(var t\x3d0;n\x3et;t++){var i\x3de[t],u\x3di[0];if(i[1]!\x3d\x3dr[u]||!(u in r))return!1}return!0}};\n\n\n},{"amp-pairs":81}],81:[function(require,module,exports){\nvar objKeys\x3drequire("amp-keys");module.exports\x3dfunction(r){for(var e\x3dobjKeys(r),o\x3de.length,a\x3dArray(o),n\x3d0;o\x3en;n++)a[n]\x3d[e[n],r[e[n]]];return a};\n\n\n},{"amp-keys":83}],82:[function(require,module,exports){\nmodule.exports\x3dfunction(n){return function(u){return null\x3d\x3du?void 0:u[n]}};\n\n\n},{}],83:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":84,"amp-index-of":85,"amp-is-object":86}],84:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],85:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],86:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],87:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],88:[function(require,module,exports){\nvar isArray\x3drequire("amp-is-array"),isArguments\x3drequire("amp-is-arguments"),flatten\x3dfunction r(e,t,a,n){for(var s,i\x3d[],l\x3d0,u\x3dn||0,g\x3de\x26\x26e.length;g\x3eu;u++)if(s\x3de[u],s\x26\x26s.length\x3e\x3d0\x26\x26(isArray(s)||isArguments(s))){t||(s\x3dr(s,t,a));var f\x3d0,m\x3ds.length;for(i.length+\x3dm;m\x3ef;)i[l++]\x3ds[f++]}else a||(i[l++]\x3ds);return i};module.exports\x3dflatten;\n\n\n},{"amp-is-arguments":89,"amp-is-array":90}],89:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,hasOwn\x3dObject.prototype.hasOwnProperty,isArgs\x3dfunction(t){return"[object Arguments]"\x3d\x3d\x3dtoString.call(t)};isArgs(arguments)||(isArgs\x3dfunction(t){return t\x26\x26hasOwn.call(t,"callee")}),module.exports\x3disArgs;\n\n\n},{}],90:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,nativeIsArray\x3dArray.isArray;module.exports\x3dnativeIsArray||function(r){return"[object Array]"\x3d\x3d\x3dtoString.call(r)};\n\n\n},{}],91:[function(require,module,exports){\nvar toString\x3dObject.prototype.toString,func\x3dfunction(t){return"[object Function]"\x3d\x3d\x3dtoString.call(t)};"function"!\x3dtypeof/./\x26\x26(func\x3dfunction(t){return"function"\x3d\x3dtypeof t||!1}),module.exports\x3dfunc;\n\n\n},{}],92:[function(require,module,exports){\nvar createCallback\x3drequire("amp-create-callback"),isFunction\x3drequire("amp-is-function"),flatten\x3drequire("amp-internal-flatten");module.exports\x3dfunction(e,r,a){var n,t\x3d{};if(null\x3d\x3de)return t;if(isFunction(r)){r\x3dcreateCallback(r,a);for(n in e){var i\x3de[n];r(i,n,e)\x26\x26(t[n]\x3di)}}else{var l\x3dflatten(arguments,!1,!1,1);e\x3dnew Object(e);for(var c\x3d0,u\x3dl.length;u\x3ec;c++)n\x3dl[c],n in e\x26\x26(t[n]\x3de[n])}return t};\n\n\n},{"amp-create-callback":87,"amp-internal-flatten":88,"amp-is-function":91}],93:[function(require,module,exports){\nmodule.exports\x3dfunction(n,r,t){if(void 0\x3d\x3d\x3dr)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)};case 4:return function(t,u,e,c){return n.call(r,t,u,e,c)}}return function(){return n.apply(r,arguments)}};\n\n\n},{}],94:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":95,"amp-index-of":96,"amp-is-object":97}],95:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],96:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],97:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],98:[function(require,module,exports){\nvar createCallback\x3drequire("amp-create-callback"),objKeys\x3drequire("amp-keys");module.exports\x3dfunction(e,r,a,l){null\x3d\x3de\x26\x26(e\x3d[]),r\x3dcreateCallback(r,l,4);var t,n\x3de.length!\x3d\x3d+e.length\x26\x26objKeys(e),o\x3d(n||e).length,c\x3d0;if(arguments.length\x3c3){if(!o)throw new TypeError("Reduce of empty array with no initial value");a\x3de[n?n[c++]:c++]}for(;o\x3ec;c++)t\x3dn?n[c]:c,a\x3dr(a,e[t],t,e);return a};\n\n\n},{"amp-create-callback":93,"amp-keys":94}],99:[function(require,module,exports){\nvar has\x3drequire("amp-has"),indexOf\x3drequire("amp-index-of"),isObject\x3drequire("amp-is-object"),nativeKeys\x3dObject.keys,hasEnumBug\x3d!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps\x3d["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];module.exports\x3dfunction(e){if(!isObject(e))return[];if(nativeKeys)return nativeKeys(e);var r\x3d[];for(var n in e)has(e,n)\x26\x26r.push(n);if(hasEnumBug)for(var t\x3dnonEnumerableProps.length;t--;){var a\x3dnonEnumerableProps[t];has(e,a)\x26\x26-1\x3d\x3d\x3dindexOf(r,a)\x26\x26r.push(a)}return r};\n\n\n},{"amp-has":100,"amp-index-of":101,"amp-is-object":102}],100:[function(require,module,exports){\nvar hasOwn\x3dObject.prototype.hasOwnProperty;module.exports\x3dfunction(n,r){return null!\x3dn\x26\x26hasOwn.call(n,r)};\n\n\n},{}],101:[function(require,module,exports){\nvar isNumber\x3drequire("amp-is-number");module.exports\x3dfunction(r,e,u){var i\x3d0,m\x3dr\x26\x26r.length;for(isNumber(u)\x26\x26(i\x3d0\x3eu?Math.max(0,m+u):u);m\x3ei;i++)if(r[i]\x3d\x3d\x3de)return i;return-1};\n\n\n},{"amp-is-number":68}],102:[function(require,module,exports){\nmodule.exports\x3dfunction(o){var t\x3dtypeof o;return!!o\x26\x26("function"\x3d\x3d\x3dt||"object"\x3d\x3d\x3dt)};\n\n\n},{}],103:[function(require,module,exports){\nvar oKeys\x3drequire("amp-keys");module.exports\x3dfunction(r){for(var e\x3doKeys(r),o\x3de.length,a\x3dArray(o),n\x3d0;o\x3en;n++)a[n]\x3dr[e[n]];return a};\n\n\n},{"amp-keys":99}],104:[function(require,module,exports){\nmodule.exports\x3dfunction(r){return r.charAt(0).toUpperCase()+r.substring(1)},module.exports.words\x3dfunction(r){return r.replace(/(^|\\W)(\\w)/g,function(r){return r.toUpperCase()})};\n\n\n},{}],105:[function(require,module,exports){\nmodule.exports\x3dfunction(r){for(var e\x3d5381,o\x3dr.length;o;)e\x3d33*e^r.charCodeAt(--o);return e\x3e\x3d0?e:(2147483647\x26e)+2147483648};\n\n\n},{}],106:[function(require,module,exports){\nfunction uniqueId(){return[randomInt(),hammerTime(),fingerPrintId()].join("-")}function randomInt(){var n\x3dMath.round(1e17);return format(Math.round(1e17*Math.random()),n)}function hammerTime(){var n\x3dnew Date;return n.setFullYear("2239"),format((new Date).getTime(),n.getTime())}function fingerPrintId(){var n\x3dMath.pow(2,32)-1,r\x3dmap(navigator.plugins,function(n){return n.description}).join(""),t\x3dnavigator.userAgent+document.cookie+r;return format(hash(t),n)}function format(n,r){return pad(n.toString(36),r.toString(36).length)}function pad(n,r){function t(n){var r\x3dMath.max(n+1,1),t\x3dnew Array(r);return t.join("0")}return t(r-String(n).length)+n}var hash\x3drequire("string-hash"),map\x3drequire("amp-map");module.exports\x3duniqueId;\n\n\n},{"amp-map":75,"string-hash":105}]},{},[5]);\n\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.Uv_mapper_qprotocol"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":true,"locationPlaceHolder":"NOT_END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "",\n LastChangedDate: "17/06/2016",\n Version: "1.0",\n Description: "Change Pixels to HTTPS"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Polyvore - ConfirmationPage","disabled":true,"id":35687061,"locked":false,"locationObject":"HEAD"});
var pkg="live.tags.polyvoreconfirmationpage.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cimg width\x3d'1' height\x3d'1' \nsrc\x3d'https://www.polyvore.com/conversion/beacon.gif?adv\x3dfarfetch.com\x26amt\x3d${subtotal}\x26oid\x3d${order_id}\x26skus\x3d${product_skus}\x26cur\x3d${currency}'\x3e";tag.addClientFiltersList(["live.filters.ConfirmationPage1","live.filters.Dedupe2"]);tag.addClientVariablesMap({"subtotal":"live.variables.TransactionOrderSubTotal","currency":"live.variables.TransactionOrderCurrency",
"order_id":"live.variables.TransactionOrderId","product_skus":"live.variables.PructSkuListString"});tag.addParameters([{"name":"PructSkuListString","description":null,"token":"product_skus"},{"name":"Order ID","description":null,"token":"order_id"},{"name":"Order Currency","description":null,"token":"currency"},{"name":"Order SubTotal","description":null,"token":"subtotal"}]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"[PDP] GA_AddToBasketStore","disabled":true});var pkg="live.tags.pdpgaaddtobasketstore.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ProductPage2","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalytics.Tag","live.tags.googleuniversalanalyticsgenericpageview.Tag",
"live.tags.ffstorage1.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){if(!FFStorage.checkStorageSupport())return;var storageKey="Basket";var localStorage=window.localStorage;var addBag=document.querySelectorAll("button[data-trk\x3daddToBag]");var pageType=universal_variable.page.breadcrumb[1]+"-"+universal_variable.page.breadcrumb[2];var i=0;for(var len=addBag.length;i<len;i++)addBag[i].addEventListener("mousedown",function(ev){var thisItem=universal_variable.product;
thisItem["pageType"]=pageType;localStorage.setItem(storageKey,JSON.stringify(thisItem))}.bind(i))};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n\tVerticalTeam : "PRIME/MKT",\n\tAuthor : "",\n\tChangedBy : "Filipe Freitas",\n\tReviewer : "",\n\tLastChangedDate : "02/12/2016",\n\tVersion : "1.10",\n\tDescription : "FASV-4320 - vIQ and Google Remarketing tags do not fire in slow connections"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Google Remarketing",
"disabled":true,"id":53039017,"locked":false,"locationObject":"BODY"});var pkg="live.tags.googleremarketing.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nvar googleRemarketingTag \x3d {\n    userLocation: window.location.href,\n    pageId: universal_variable.page.pageId,\n    private: undefined,\n\n    init: function() {\n        this.private \x3d new this.googleRemarketingTag();\n        var google_tag_params \x3d this.getParams()\n        if (google_tag_params !\x3d null) {\n            window.google_tag_params \x3d google_tag_params;\n        }\n    },\n    isLoginPage: function() {\n        return (universal_variable.page.type \x3d\x3d 'login') || (this.userLocation.indexOf('login.aspx') \x3e -1);\n    },\n    getCheckouPageStep: function() {\n        var retVal \x3d '';\n        var uv \x3d universal_variable;\n\n        if ((this.userLocation.indexOf('shippingaddress.aspx') \x3e -1) || (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty(\"page\") \x26\x26 uv.page.hasOwnProperty(\"pageStep\") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d \"shippingaddress\")) {\n            retVal \x3d 'shippingaddress';\n        } else if ((this.userLocation.indexOf('payment.aspx') \x3e -1) || (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty(\"page\") \x26\x26 uv.page.hasOwnProperty(\"pageStep\") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d \"payment\")) {\n            retVal \x3d 'payment';\n        } else if ((this.userLocation.indexOf('revieworder.aspx') \x3e -1) || (uv !\x3d\x3d undefined \x26\x26 uv.hasOwnProperty(\"page\") \x26\x26 uv.page.hasOwnProperty(\"pageStep\") \x26\x26 uv.page.pageStep.toLowerCase() \x3d\x3d\x3d \"review\")) {\n            retVal \x3d 'review';\n        } else if (this.userLocation.indexOf('GuestUser/Guest') \x3e -1) {\n            retVal \x3d 'guest';\n        }\n        return retVal;\n    },\n    getParams: function() {\n        var google_tag_params \x3d null;\n        if (this.isLoginPage() \x3d\x3d true) {\n            google_tag_params \x3d this.getLoginParams();\n        } else {\n            switch (this.pageId) {\n                case 'homepage':\n                    google_tag_params \x3d this.getHomepageParams();\n                    break;\n                case 'geral':\n                    google_tag_params \x3d this.getGeralParams();\n                    break;\n                case 'product':\n                    google_tag_params \x3d this.getProductParams();\n                    break;\n                case 'basket':\n                    google_tag_params \x3d this.getBasketParams();\n                    break;\n                case 'checkout':\n                    switch (this.getCheckouPageStep()) {\n                        case 'shippingaddress':\n                            google_tag_params \x3d this.getCheckoutShippingAddressParams();\n                            break;\n                        case 'payment':\n                            google_tag_params \x3d this.getCheckoutPaymentParams();\n                            break;\n                        case 'review':\n                            google_tag_params \x3d this.getCheckoutReviewParams();\n                            break;\n                        case 'guest':\n                            google_tag_params \x3d this.getCheckoutGuestParams();\n                            break;\n                    }\n                    break;\n                case 'transaction':\n                    google_tag_params \x3d this.getCheckoutConfirmationParams();\n                    break;\n            }\n        }\n        return google_tag_params;\n    },\n    getGeralParams: function() {\n        var google_tag_params \x3d {\n            ecomm_pagetype: 'home',\n            ecomm_prodid: '',\n            ecomm_totalvalue: ''\n        };\n        return google_tag_params;\n    },\n    getHomepageParams: function() {\n        return this.getGeralParams();\n    },\n    getLoginParams: function() {\n        var google_tag_params \x3d {\n            ecomm_pagetype: 'other',\n            ecomm_prodid: '',\n            ecomm_totalvalue: '',\n            pageSubType: 'login' //custom parameter\n        };\n        return google_tag_params;\n    },\n    getProductParams: function() {\n        var product \x3d universal_variable.product;\n        var google_tag_params \x3d {\n            ecomm_pagetype: 'product',\n            dynx_pagetype: 'product',\n            ecomm_prodid: product.id,\n            dynx_itemid: product.id,\n            pcat: product.category,\n            pcatgender: '', //Product Gender\n            pbrand: product.designerName,\n            pname: product.name,\n            pvalue: product.unit_sale_price,\n            pcolor: '', // Product color\n            ecomm_totalvalue: '', // The sum of cart\n            dynx_totalvalue: '', // The sum of cart\n            nbcartitem: '' // Quantity of products in cart\n        };\n        return google_tag_params;\n    },\n    getBasketParams: function() {\n        return this.private._buildWithBasketParams('cart','cart');\n    },\n    getCheckoutConfirmationParams: function() {\n        var uv \x3d universal_variable;\n        var items \x3d uv.transaction.line_items;\n        var prodIds \x3d [],\n            productNames \x3d [];\n\n        for (var i \x3d 0, len \x3d items.length; i \x3c len; i++) {\n            prodIds[i] \x3d items[i].product.id;\n            productNames[i] \x3d items[i].product.name;\n        }\n        var google_tag_params \x3d {\n            ecomm_pagetype: 'purchase',\n            ecomm_totalvalue: uv.transaction.total,\n            dynx_pagetype: 'purchase',\n            dynx_totalvalue: uv.transaction.total,\n            nborderitem: items.length,\n            ecomm_prodid: prodIds,\n            dynx_itemid: prodIds,\n            pordername: productNames,\n        };\n\n        return google_tag_params;\n    },\n    getCheckoutShippingAddressParams: function() {\n        return this.private._buildCheckoutOtherParams('shippingaddress');\n    },\n    getCheckoutPaymentParams: function() {\n        return this.private._buildCheckoutOtherParams('payment');\n    },\n    getCheckoutReviewParams: function() {\n        return this.private._buildCheckoutOtherParams('review');\n    },\n    getCheckoutGuestParams: function() {\n        return this.private._buildCheckoutOtherParams('guest');\n    },\n\n    googleRemarketingTag: (function(that) {\n        function googleRemarketingTag() {\n            return this;\n        };\n        googleRemarketingTag.prototype \x3d {\n            _buildCheckoutOtherParams: function(checkoutStep) {\n                return this._buildWithBasketParams('other','other',checkoutStep);\n            },\n            _buildWithBasketParams: function(eCommPageType,dynxPageType,pageSubType) {\n                var uv \x3d universal_variable;\n                var items \x3d uv.basket.line_items;\n                var prodIds \x3d [],\n                    brandNames \x3d [],\n                    productNames \x3d [];\n\n                for (var i \x3d 0, len \x3d items.length; i \x3c len; i++) {\n                    prodIds[i] \x3d items[i].product.id;\n                    brandNames[i] \x3d items[i].product.designerName;\n                    productNames[i] \x3d items[i].product.name;\n                }\n                var google_tag_params \x3d {\n                    ecomm_pagetype: eCommPageType,\n                    dynx_pagetype: dynxPageType,\n                    ecomm_prodid: prodIds,\n                    dynx_itemid: prodIds,\n                    pcartname: productNames,\n                    pcartbrand: brandNames,\n                    ecomm_totalvalue: uv.basket.total,\n                    dynx_totalvalue: uv.basket.total,\n                    nbcartitem: items.length\n                };\n                if (pageSubType !\x3d\x3d undefined) { // IS OPTIONAL..\n                    google_tag_params.pageSubType \x3d pageSubType; // ..ADD custom parameter\n                }\n\n                return google_tag_params;\n            }\n        };\n\n        return googleRemarketingTag;\n\n    })(this)\n};\n\ngoogleRemarketingTag.init();\n\x3c/script\x3e\n\n\x3cscript type\x3d\"text/javascript\" src\x3d\"https://www.googleadservices.com/pagead/conversion_async.js\" charset\x3d\"utf-8\"\x3e\x3c/script\x3e\n\n\x3cscript type\x3d\"text/javascript\"\x3e\n    if (qubit_migration_remarkable \x3d\x3d undefined) \n    {\n        var qubit_migration_remarkable \x3d \"me_first_qubit\";\n        window.google_trackConversion({\n            google_conversion_id : '${ConversionID}',\n            google_conversion_label: '',\n            google_custom_params: window.google_tag_params||{},\n            google_remarketing_only : true\n        });\n    }\n\x3c/script\x3e\n\x3cnoscript\x3e\n\x3cdiv style\x3d\"display:inline;\"\x3e\n\x3cimg height\x3d\"1\" width\x3d\"1\" style\x3d\"border-style:none;\" alt\x3d\"\" src\x3d\"https://googleads.g.doubleclick.net/pagead/viewthroughconversion/${ConversionID}/?value\x3d0\x26amp;guid\x3dON\x26amp;script\x3d0\"/\x3e\n\x3c/div\x3e\n\x3c/noscript\x3e";
tag.addClientFiltersList(["live.filters.HomepageListingProductConfirmationBasket"]);tag.addClientVariablesMap({"ConversionID":"live.variables.ConversionID1"});tag.addParameters([{"name":"ConversionID","description":null,"token":"ConversionID"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.ruleuvpageidavailable.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"GA_ClickTrackStore","disabled":true});var pkg="live.tags.gaclicktrackstore.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="";tag.addClientFiltersList(["live.filters.ListingPage2"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.googleuniversalanalyticsgenericpageview.Tag","live.tags.googleuniversalanalytics.Tag","live.tags.ffstorage1.Tag"]);
tag.pre=function(){};tag.script=function(){if(!FFStorage.checkStorageSupport())return;var localStorage=window.localStorage;var allProducts=document.querySelectorAll(".listing-item");var pageType=universal_variable.page.breadcrumb[1]+"-"+universal_variable.page.breadcrumb[2];var i=0;for(var len=allProducts.length;i<len;i++)allProducts[i].addEventListener("mousedown",function(ev){var thisItem=universal_variable.listing.items[this];thisItem["pageType"]=pageType;localStorage.setItem("track_"+thisItem.id,
JSON.stringify(thisItem))}.bind(i))};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "MKT/TNT",\n ChangedBy: "Guilherme Quelhos",\n LastChangedDate: "27/02/2017",\n Description: "Tag disabled.  Tag irrelevant to the business."\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Yahoo (JP) - Conversion","disabled":true,"id":35687270,"locked":false,"locationObject":"BODY"});var pkg=
"live.tags.yahoojpconversion.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript" language\x3d"javascript"\x3e\ntry {\n/* \x3c![CDATA[ */\n\tvar yahoo_ydn_conv_io \x3d "gjB6DbMOLDXS_SByOhKZ";\n\tvar yahoo_ydn_conv_label \x3d "U08IH1Y7NYLWPKMTXY0PE1412";\n\tvar yahoo_ydn_conv_transaction_id \x3d universal_variable.transaction.order_id;\n\tvar yahoo_ydn_conv_amount \x3d universal_variable.transaction.total_jpy;\t\n/* ]]\x3e */\n\n\tvar loggedData \x3d {\n\t\tio : yahoo_ydn_conv_io,\n\t\tlabel : yahoo_ydn_conv_label,\n\t\ttransationId : yahoo_ydn_conv_transaction_id,\n\t\tamount : yahoo_ydn_conv_amount\n\t};\n\tffLogger.tagLogger("Yahoo (JP) - Conversion",  loggedData, ffLogger.LogLevelEnum.INFO);\n} catch (e) {\n\tffLogger.tagLogger("Yahoo (JP) - Conversion", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e\n\x3cscript type\x3d"text/javascript" language\x3d"javascript" charset\x3d"UTF-8" src\x3d"https://b90.yahoo.co.jp/conv.js"\x3e\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.YahooJPQUBITGTM","live.filters.NotInJapan","live.filters.ConfirmationPage1"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "SEO/MKT",\n Author: "",\n ChangedBy: "Ricardo Marques",\n Reviewer: "",\n LastChangedDate: "21/12/2016",\n Version: "1.0",\n Description: "Add Type Thematic when open a Bloomreach thematic Page"\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Bloomreach","disabled":false,"id":55028211,"locked":false,
"locationObject":"BODY"});var pkg="live.tags.bloomreach.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript type\x3d"text/javascript"\x3e\n\n  var br_data \x3d {};\n  \n  br_data.acct_id \x3d "${bloomreach_AccountId}"; // create custom variable\n   \n  switch(window.universal_variable.page.pageId){\n    case "listing": \n      // br_data.ptype \x3d typeof window.universal_variable.page.search_term !\x3d\x3d "undefined" ? "search" : "category";\n      \tif (typeof window.universal_variable.page.search_term !\x3d\x3d "undefined")\n          br_data.ptype \x3d "search";\n      \telse\n          if (typeof window.universal_variable.listing.categoryId !\x3d\x3d "undefined" || (typeof window.universal_variable.listing.Designername !\x3d\x3d "undefined" \x26\x26 typeof window.universal_variable.listing.storeId \x3d\x3d\x3d "undefined"))\n              br_data.ptype \x3d "category";\n          else\n            if (window.location.pathname.includes("/buy/"))\n              br_data.ptype \x3d "thematic";\n            else\n              br_data.ptype \x3d "other";\n      break;\n    case "homepage":\n      br_data.ptype \x3d "homepage";\n      break;\n    case "product":\n      br_data.ptype \x3d "product";\n      break;\n    default:\n      br_data.ptype \x3d "other";\n      break;\n  }\n\n  if (window.universal_variable.page.pageId \x3d\x3d "listing" \x26\x26  typeof window.universal_variable.listing.categoryId !\x3d\x3d "undefined")\n\tbr_data.cat_id \x3d window.universal_variable.listing.categoryId;\n  else\n\t  if (window.universal_variable.page.pageId \x3d\x3d "listing" \x26\x26  typeof window.universal_variable.listing.Designername !\x3d\x3d "undefined")\n\t\t  br_data.cat_id \x3d window.universal_variable.listing.Designername;\n\t  else\n\t\t  br_data.cat_id \x3d "";\n\t  \n  br_data.cat \x3d window.universal_variable.page.pageId \x3d\x3d "listing" \x26\x26 (typeof window.universal_variable.listing.categoryId !\x3d\x3d "undefined" || typeof window.universal_variable.listing.Designername !\x3d\x3d "undefined") \x26\x26 typeof window.universal_variable.page.breadcrumb !\x3d\x3d "undefined" ? window.universal_variable.page.breadcrumb.join(\'|\') : "";\n  br_data.prod_id \x3d window.universal_variable.page.pageId \x3d\x3d "product" ? window.universal_variable.product.id : "";\n  br_data.prod_name \x3d window.universal_variable.page.pageId \x3d\x3d "product" ? window.universal_variable.product.name : "";\n  br_data.sku \x3d window.universal_variable.page.pageId \x3d\x3d "product" ? window.universal_variable.product.id : "";\n  br_data.search_term \x3d window.universal_variable.page.pageId \x3d\x3d "listing" \x26\x26 typeof window.universal_variable.page.search_term !\x3d\x3d "undefined" ? window.universal_variable.page.search_term : "";\n  br_data.is_conversion \x3d window.universal_variable.page.pageId \x3d\x3d "transaction" ? 1 : 0;\n  br_data.basket_value \x3d window.universal_variable.page.pageId \x3d\x3d "transaction" ?  window.universal_variable.transaction.total : "";\n  br_data.order_id \x3d window.universal_variable.page.pageId \x3d\x3d "transaction" ? window.universal_variable.transaction.order_id : "";\n  \n  var items \x3d new Array();\n  if (window.universal_variable.page.pageId \x3d\x3d "transaction") \n  {\n\t  var products \x3d window.universal_variable.transaction.line_items;\n\t  for (var i \x3d 0; i \x3c products.length; i++) {\n\t\t  items.push({\n\t\t  \'prod_id\': products[i].product.id, \n\t\t  \'sku\': products[i].product.id,\n\t\t  \'name\': products[i].product.name,\n\t\t  \'quantity\': products[i].quantity,\n\t\t  \'price\': products[i].product.unit_sale_price\n\t\t});\n\t  }\n  }\n  br_data.basket \x3d {"items" : items};\n  \n  /* --- End parameter section --- */\n  (function() {\n\n  var brtrk \x3d document.createElement(\'script\');\n  brtrk.type \x3d \'text/javascript\';\n  brtrk.async \x3d true;\n  brtrk.src \x3d "https://cdns.brsrvr.com/v1/br-trk-${bloomreach_AccountId}.js"; // page variable\n  var s \x3d document.getElementsByTagName(\'script\')[0];\n  s.parentNode.insertBefore(brtrk, s);\n\n  })();\n\n\x3c/script\x3e';
tag.addClientFiltersList(["live.filters.IncludeIfCountryBloomreach"]);tag.addClientVariablesMap({"bloomreach_AccountId":"live.variables.BloomreachAccountId"});tag.addParameters([{"name":"Bloomreach AccountId","description":null,"token":"bloomreach_AccountId"}]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"name":"UV UniversalVariableLoaded"});var pkg="live.tags.uvuniversalvariableloadedevent.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e//only pdp propose;\x3c/script\x3e";tag.addClientFiltersList(["live.filters.UVUniversalVariableLoadedEvent"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList([]);tag.pre=function(){};tag.script=function(){};
tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"locationPlaceHolder":"END","name":"[PDP] Bluekai - Wishlist and Basket","description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Filipe Freitas",\n Reviewer: "",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: "Pixel triggered when adding a product to wishlist"\n}',"disabled":false});var pkg="live.tags.pdpbluekaiwishlistandbasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent='\x3cscript\x3e\ntry {\n\tif (window.universal_variable.page.pageId \x3d\x3d\x3d "product") {\n\t\t$(\'button[data-trk\x3daddToBag]\').on(\'click\',function(){\n\t\t\t\tbluekaiAddTo(\'BagUpdated\', window.universal_variable.product);\n\t\t});\n\t} else {\n\t\t$(document).bind("BagUpdated", function (evt, product) {\n\t\t\tbluekaiAddTo(\'BagUpdated\', product);\n\t\t});\n\t}\n\n\t $("button[data-trk\x3d\'addToWishlist\']").on(\'click\', function(){\n\t   var attr \x3d $(this).attr(\'aria-pressed\');\n\t   if (attr !\x3d\x3d false \x26\x26 attr !\x3d\x3d "true") \n\t   {\n\t     bluekaiAddTo(\'WishListUpdated\', window.universal_variable.product);\n\t   }\n\t});\n\n\tfunction bluekaiAddTo(eventType, product) {\n\t\ttry {\n\t\t\tvar uv \x3d window.universal_variable;\n\t\t\tfunction sendStock(productSelected) {\n\t\t\t\tif (productSelected !\x3d\x3d undefined \x26\x26 productSelected.hasStock) {\n\t\t\t\t\tvar stock \x3d productSelected.stock;\n\t\t\t\t\tif (stock \x3e 9) {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "10+");\n\t\t\t\t\t} else if (stock \x3e 4) {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "5-9");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbk_addPageCtx("Stock", "1-4");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbk_addPageCtx("Stock", "0");\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (product !\x3d\x3d undefined) {\n\n\t\t\t\tbk_addPageCtx("Event", eventType);\n\t\t\t\tbk_addPageCtx("PageType", uv.page.pageId);\n\t\t\t\tbk_addPageCtx("Subfolder", uv.page.subfolder);\n\t\t\t\tbk_addPageCtx("NewCustomer", uv.user.returning);\n\n\t\t\t\tsendStock(product);\n\n\t\t\t\tbk_addPageCtx("ProdId", product.id);\n\t\t\t\tbk_addPageCtx("ProdDescription", product.name);\n\t\t\t\tbk_addPageCtx("ProdPrice", product.unit_price);\n\t\t\t\tbk_addPageCtx("Currency", window.universal_variable.page.currency);\n\t\t\t\tbk_addPageCtx("__bk_l", window.location);\n\t\t\t\tbk_addPageCtx("Cat_Gender", "");\n\n\t\t\t\tbk_ignore_meta \x3d true;\n\t\t\t\tbk_doJSTag(30341, 10);\n\n        if (eventType \x3d\x3d\x3d \'BagUpdated\') {\n  \t\t\t\tffLogger.tagLogger("Bluekai - Wishlist and Basket", {productId:product.id}, ffLogger.LogLevelEnum.INFO);\n        }\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tffLogger.tagLogger("Bluekai - Wishlist and Basket", e, ffLogger.LogLevelEnum.ERROR);\n\t\t}\n\t}\n} catch (e) {\n\tffLogger.tagLogger("Bluekai - Wishlist and Basket", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script \x3e';
tag.addClientFiltersList(["live.filters.AddToBasketAndWishlistPages","live.filters.IsNotPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.bluekaiv2.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.CustomTag;var tag=new instance({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"description":'{\n VerticalTeam: "PRIME/MKT",\n Author: "",\n ChangedBy: "Armando Moreira",\n Reviewer: "Filipe Freitas",\n LastChangedDate: "27/05/2016",\n Version: "1.0",\n Description: ""\n}',"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"Adobe - Basket","disabled":true,"id":35687222,"locked":false,"locationObject":"BODY"});
var pkg="live.tags.adobebasket.Tag";qubit.Define.clientNamespace(pkg,tag);tag.htmlContent="\x3cscript\x3e\ntry {\n    var page \x3d window.universal_variable.page;\n\n    if (page.pageId \x3d\x3d\x3d \"product\") {\n        $(document).on('click', '.Go_AddToBag', function() {\n            if ($(\".addToBag_ModelError\").attr(\"class\").indexOf(\"hide\") \x3e -1) {\n                adobeAddToBasket('BagUpdated', window.universal_variable.product);\n            }\n        });\n    } else {\n        $(document).bind(\"BagUpdated\", function(evt, product) {\n            adobeAddToBasket('BagUpdated', product);\n        });\n    }\n\n    function adobeAddToBasket(eventType, product) {\n      try {\n        if (product !\x3d\x3d undefined) {\n          var s \x3d document.createElement(\"img\"),\n              adobe_code \x3d '3517';\n  \n          switch (page.subfolder) {\n              case '/br':\n                  adobe_code \x3d '3670';\n                  break;\n          }\n  \n          s.src \x3d 'https://pixel.everesttech.net/' + adobe_code + '/t?ev_add_to_basket\x3d1';\n          s.style.width \x3d '1px';\n          s.style.height \x3d '1px';\n          s.style.display \x3d 'none'\n          $(\"body\").append(s);\n  \n          ffLogger.tagLogger('Adobe - Basket', {adobe_code:adobe_code}, ffLogger.LogLevelEnum.INFO);\n        }\n      }\n      catch (e) {\n        ffLogger.tagLogger(\"Adobe - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n      }\n    }  \n}\ncatch (e)\n{\n   ffLogger.tagLogger(\"Adobe - Basket\", e, ffLogger.LogLevelEnum.ERROR);\n}\n\x3c/script\x3e";
tag.addClientFiltersList(["live.filters.ProductAndBasket","live.filters.ExcludeIfRU","live.filters.IsPDPSlicePage"]);tag.addClientVariablesMap({});tag.addParameters([]);tag.genericDependencies=[];tag.addClientDependenciesList(["live.tags.fflogger.Tag","live.tags.uvuniversalvariableloadedevent.Tag"]);tag.pre=function(){};tag.script=function(){};tag.post=function(){}})();
(function(){var instance=qubit.opentag.Container;var container=new instance({"maxCookieLength":0,"cookieDomain":".farfetch.com","pingServerUrl":"","delayDocWrite":false,"name":"LIVE","gzip":true,"disabled":false,"tellLoadTimesProbability":1,"containerId":1640858});var pkg="live.Container";qubit.Define.clientNamespace(pkg,container)})();(function(){try{qubit.opentag.Main.run()}catch(ex$$0){try{console.error("Errors during opentag main runtime.",ex$$0)}catch(ex){}}})();
