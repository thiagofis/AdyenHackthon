!function(a,b){a.log=b()}(this,function(){function a(a){return typeof console!==i&&(void 0!==console[a]?b(console,a):void 0!==console.log?b(console,"log"):h)}function b(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(d){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function c(a,b){return function(){typeof console!==i&&(d(b),g[a].apply(g,arguments))}}function d(a){for(var b=0;b<j.length;b++){var c=j[b];g[c]=a>b?h:g.methodFactory(c,a)}}function e(a){var b=(j[a]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=b)}catch(c){}try{window.document.cookie="loglevel="+b+";"}catch(c){}}var g={},h=function(){},i="undefined",j=["trace","debug","info","warn","error"];g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=function(b,d){return a(b)||c(b,d)},g.setLevel=function(a){if("string"==typeof a&&void 0!==g.levels[a.toUpperCase()]&&(a=g.levels[a.toUpperCase()]),!("number"==typeof a&&a>=0&&a<=g.levels.SILENT))throw"log.setLevel() called with invalid level: "+a;return e(a),d(a),typeof console===i&&a<g.levels.SILENT?"No console available for logging":void 0},g.enableAll=function(){g.setLevel(g.levels.TRACE)},g.disableAll=function(){g.setLevel(g.levels.SILENT)};var k=typeof window!==i?window.log:void 0;return g.noConflict=function(){return typeof window!==i&&window.log===g&&(window.log=k),g},function(){var a;try{a=window.localStorage.loglevel}catch(b){}if(typeof a===i)try{a=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(b){}void 0===g.levels[a]&&(a="WARN"),g.setLevel(g.levels[a])}(),g});
var MentionMe=function(log){"use strict";var MentionMe=function(payload){this.payload=payload,this.payload.uniqueIdentifier="mm"+(new Date).getTime(),this.mmWindow=new MentionMe.Window(payload),this.logLevel=payload.logLevel||MentionMe.logLevel,log.setLevel(this.logLevel),this.merchantRequiresDomReady=function(){return this.payload.requiresDomReady||!1},this.tagHasAlreadyFired=function(tagIdentifier){return window.MentionMeFiredTags&&window.MentionMeFiredTags[tagIdentifier]},this.markTagAsFired=function(tagIdentifier){window.MentionMeFiredTags||(window.MentionMeFiredTags={}),window.MentionMeFiredTags[tagIdentifier]=!0},this.whenReady=function(){this.mmWindow.updatePayloadForDevice();var implementationFunction=this.payload.implementation;if(void 0!==implementationFunction){if("string"!=typeof implementationFunction||implementationFunction.length<2)log.error("Unexpected implementation method:",implementationFunction);else if(implementationFunction=implementationFunction[0].toUpperCase()+implementationFunction.toLowerCase().substr(1),MentionMe[implementationFunction]){var tagIdentifier=(implementationFunction+this.payload.wrapperSituation).toLowerCase();this.tagHasAlreadyFired(tagIdentifier)?log.info("A tag has already fired with with identifier ["+tagIdentifier+"] on this page. Suppressing tag"):(this.markTagAsFired(tagIdentifier),"object"!=typeof this.payload.overlay||"Overlay"!==implementationFunction&&"Embed"!==implementationFunction&&"Popup"!==implementationFunction||new MentionMe.Overlay(this.payload).createExtraOverlay(),log.info("Beginning display of:",implementationFunction),new MentionMe[implementationFunction](this.payload).create(this.payload.methodType))}else log.warn("No implementation found for:",implementationFunction)}}};return MentionMe.log=log,MentionMe.logLevel="warn",MentionMe.log.setLevel(MentionMe.logLevel),MentionMe.fireEvents=!0,MentionMe.watermarkShown=!1,MentionMe.prototype.init=function(){var self=this;self.merchantRequiresDomReady()?MentionMe.Ready(function(){self.whenReady(self)}):self.whenReady(self)},MentionMe}(log.noConflict());
MentionMe.CookieManager=function(partnerCode){"use strict";var TUPLE_MAP={key:0,value:1},generateCookieKey=function(functionalIdentifier){return"mm_"+functionalIdentifier+"_suppressed_"+partnerCode},getCookie=function(key){for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var tuple=cookies[i].split("=");if(tuple[TUPLE_MAP.key].trim()===key.trim())return tuple}return null},createCookie=function(functionalIdentifier,validityInSeconds){var expiryDate=new Date;expiryDate.setSeconds(expiryDate.getSeconds()+validityInSeconds);var cookie=generateCookieKey(functionalIdentifier)+"=true; path=/; max-age="+validityInSeconds+"; expires="+expiryDate.toUTCString();MentionMe.log.info("Setting cookie",cookie),document.cookie=cookie};return{suppressForTenMins:function(functionalIdentifier){createCookie(functionalIdentifier,600)},suppressForOneHour:function(functionalIdentifier){createCookie(functionalIdentifier,3600)},isSuppressionCookieSet:function(functionalIdentifier){var cookie=getCookie(generateCookieKey(functionalIdentifier));return null!==cookie&&"true"===cookie[TUPLE_MAP.value]}}};
MentionMe.ScrollManager=function(){"use strict";var priorScrollPosition=[0,0];return{getScrollPosition:function(){return priorScrollPosition},setScrollPosition:function(scrollPosition){scrollPosition.constructor===Array&&(priorScrollPosition=scrollPosition)},updateScroll:function(coordinates){var scrollCoordinates=coordinates||priorScrollPosition;window.scrollTo.apply(null,scrollCoordinates)}}};
!function(MentionMe){"use strict";var beenAdded=!1,log=MentionMe.log;MentionMe.PostMessage=function(payloadObj,display){this.mmDisplay=display,this.mmUrls=new MentionMe.Urls(payloadObj),this.payload=payloadObj},MentionMe.PostMessage.prototype.reset=function(){return!(!global||!global.MM_UNDERTEST||!0!==global.MM_UNDERTEST)&&(beenAdded=!1,!0)},MentionMe.PostMessage.prototype.validatePostMessage=function(evt){var domainParts=evt.origin.split("://"),protocol=domainParts[0],domain=domainParts[1].replace("www.","");if("http"!==protocol&&"https"!==protocol)return!1;var hasMentionMeSubdomain=domain.indexOf(this.payload.mmSubdomainSeparator+this.payload.mmDomain)>-1;if(hasMentionMeSubdomain&&!pValidateSubdomain.call(this,domain))return!1;if(!hasMentionMeSubdomain&&!pValidateDomain.call(this,domain))return!1;var sourceIframes=document.getElementsByName(evt.data.sourceName);return 1!==sourceIframes.length?(log.debug("Found "+sourceIframes.length+" iframes with name that may have sent this message, expected one.",evt),!1):sourceIframes[0].getAttribute("data-mm-identifier")!==this.payload.uniqueIdentifier?(log.debug("Recieved a message for a different listener."),!1):pValidateData(evt)};var pValidateDomain=function(domain){return!!(this.payload&&this.payload.mmDomain&&this.payload.mmSubdomainSeparator)&&this.payload.mmDomain===domain},pValidateSubdomain=function(domain){return!!(this.payload&&this.payload.mmDomain&&this.payload.mmSubdomainSeparator)&&domain.substr(domain.indexOf(this.payload.mmSubdomainSeparator)+this.payload.mmSubdomainSeparator.length)===this.payload.mmDomain};MentionMe.PostMessage.prototype.getEventListener=function(){var self=this;return function(evt){if(self.validatePostMessage(evt)){var choice=evt.data.choice;"height"===choice?self.handleHeight(evt.data):"continueModal"===choice?self.handleClickThroughModal(evt.data):"clickAction"===choice&&self.handleClickAction(evt.data)}else self.handleInvalidRequest(evt)}},MentionMe.PostMessage.prototype.addPostMessageListener=function(){beenAdded||(window.addEventListener("message",this.getEventListener(),!1),beenAdded=!0)},MentionMe.PostMessage.prototype.handleInvalidRequest=function(evt){log.debug("Received a postmessage we could not validate from "+evt.origin,evt)},MentionMe.PostMessage.prototype.handleHeight=function(data){if(this.payload.usesFillScreenFormFactor)log.debug("Will not modify height as in fill screen form factor");else{var modalContainer=document.getElementById("mmModal"+data.suffix),iframe=document.getElementById("mmContent"+data.suffix);if(iframe){var height=iframe.height;if(modalContainer?data.height>modalContainer.clientHeight?(height=data.height,iframe.parentNode.style.overflowY="auto"):data.height<modalContainer.clientHeight&&modalContainer.clientHeight<iframe.height&&(height=modalContainer.clientHeight,iframe.parentNode.style.overflowY="hidden"):(height=data.height,iframe.parentNode.style.height="auto"),modalContainer||"true"===iframe.dataIsHidden||(iframe.parentNode.style.height=parseInt(height)+"px"),iframe.height=parseInt(height)+"px",iframe.parentNode.style.WebkitOverflowScrolling){iframe.parentNode.style.WebkitOverflowScrolling=null;window.setTimeout(function(){iframe.parentNode.style.WebkitOverflowScrolling="touch"},1e3)}}else log.debug("Unable to find the iframe with id 'mmContent"+data.suffix)}},MentionMe.PostMessage.prototype.handleClickThroughModal=function(data){var iframeToClose=document.getElementsByName(data.sourceName)[0];if(!iframeToClose)return log.error("Unable to locate the iframe by name '"+data.frameElement+"'"),!1;var evt=document.createEvent("Event");return evt.initEvent("continue",!1,!1),iframeToClose.dispatchEvent(evt),!0},MentionMe.PostMessage.prototype.handleClickAction=function(data){switch(data.clickType){case"redirect":var redirectURL=data[data.choice];pHandleRedirect(redirectURL,"_self");break;case"closeClick":data.suffix&&"referee"===data.suffix.toLowerCase()&&this.mmUrls.logContinue(),pHandleModalClose.call(this,data);break;case"continueClose":default:this.mmUrls.logContinue(),pCloseModal.call(this)}};var pCloseModal=function(){this.mmDisplay.closeModals()},pHandleModalClose=function(data){var modalClassPrefix="mmModal",maskClassPrefix="mmMask";"banner"===this.payload.implementation&&(modalClassPrefix+="Banner",maskClassPrefix+="Banner");var suffix=data.suffix;"Register"===data.suffix&&"referee"===this.payload.methodType&&(suffix="Referee");var container=document.getElementById(modalClassPrefix+suffix);if("slidedown"===this.payload.implementation)this.mmDisplay.handleSlidedownClose(container);else{var mask=document.getElementById(maskClassPrefix+suffix);this.mmDisplay.handleClose(mask,container)}},pHandleRedirect=function(url,option){var protocolWindow=window.open(url,option);protocolWindow&&!protocolWindow.closed&&void 0!==protocolWindow.closed||alert("Please allow pop ups and try again")},pValidateData=function(evt){if(!evt.data)return!1;var choice=evt.data.choice;return("height"===choice||"clickAction"===choice||"continueModal"===choice)&&("height"===choice?evt.data.hasOwnProperty(choice)&&"number"==typeof evt.data[choice]:"continueModal"!==choice||evt.data.hasOwnProperty("sourceName"))}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Window=function(payloadObj){this.payload=payloadObj},MentionMe.Window.prototype.getUniqueIdentifier=function(){return this.payload.uniqueIdentifier},MentionMe.Window.prototype.isOnMobileDevice=function(){return/UCBrowser|UCWEB/.test(navigator.userAgent)?window.innerWidth<768:this.findOutWindowSize().width<768},MentionMe.Window.prototype.isZoomedIn=function(){return document.documentElement.clientWidth/window.innerWidth>1},MentionMe.Window.prototype.getNonZoomedWindowSize=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},MentionMe.Window.prototype.findOutWindowSize=function(){var myWidth=0,myHeight=0;return"number"==typeof window.innerWidth?(myWidth=window.innerWidth,myHeight=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(myWidth=document.documentElement.clientWidth,myHeight=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(myWidth=document.body.clientWidth,myHeight=document.body.clientHeight),{width:myWidth,height:myHeight}},MentionMe.Window.prototype.findOutWindowCenter=function(){var width,height,offsetX=0,offsetY=0;return window.pageYOffset?(offsetX=window.pageXOffset,offsetY=window.pageYOffset):0!==document.documentElement.scrollTop?(offsetY=document.documentElement.scrollTop,offsetX=document.documentElement.scrollLeft):(offsetY=document.body.scrollTop,offsetX=document.body.scrollLeft),width=this.findOutWindowSize().width/2+offsetX,height=this.findOutWindowSize().height/2+offsetY,{width:width,height:height}},MentionMe.Window.prototype.getDocumentHeight=function(minimumHeight){var minHeight=void 0!==minimumHeight?minimumHeight:0;return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight,minHeight)},MentionMe.Window.prototype.shouldShowResponsive=function(dimensions){var windowSize=this.findOutWindowSize();return"mobile-breakpoint"in dimensions&&(windowSize.width<dimensions["mobile-breakpoint"]&&(log.info("Flow can be shown responsively? :",this.payload.isResponsive),this.payload.isResponsive))},MentionMe.Window.prototype.isAniOSDevice=function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},MentionMe.Window.prototype.updatePayloadForDevice=function(){this.isOnMobileDevice()?(void 0!==this.payload.mobileImplementation&&(this.payload.implementation=this.payload.mobileImplementation),void 0!==this.payload.mobileUrls&&(this.payload.urls=this.payload.mobileUrls),void 0!==this.payload.mobileFlowOption&&(this.payload.specifics["-FLOW-OPTION-"]=this.payload.mobileFlowOption)):(void 0!==this.payload.desktopImplementation&&(this.payload.implementation=this.payload.desktopImplementation),void 0!==this.payload.desktopUrls&&(this.payload.urls=this.payload.desktopUrls),void 0!==this.payload.desktopFlowOption&&(this.payload.specifics["-FLOW-OPTION-"]=this.payload.desktopFlowOption))}}(MentionMe);
MentionMe.Type={REFEREE:"referee",REFERRER:"referrer",DASHBOARD:"dashboard",DASHBOARD_FIRST_TIME:"dashboard-first-time"};
!function(MentionMe){"use strict";var Ready=function(callback){registerOrRunCallback(callback),bindReady()},document=window.document,readyBound=!1,callbackQueue=[],registerOrRunCallback=function(callback){"function"==typeof callback&&callbackQueue.push(callback)},domReadyCallback=function(){for(;callbackQueue.length;)callbackQueue.shift()();registerOrRunCallback=function(callback){callback()}},domContentLoaded=function(){document.addEventListener?document.removeEventListener("DOMContentLoaded",domContentLoaded,!1):document.detachEvent("onreadystatechange",domContentLoaded),domReady()},domReady=function(){if(!Ready.isReady){if(!document.body)return setTimeout(domReady,1);Ready.isReady=!0,domReadyCallback()}},bindReady=function(){var toplevel=!1;if(!readyBound)if(readyBound=!0,"loading"!==document.readyState&&domReady(),document.addEventListener)document.addEventListener("DOMContentLoaded",domContentLoaded,!1),window.addEventListener("load",domContentLoaded,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",domContentLoaded),window.attachEvent("onload",domContentLoaded);try{toplevel=null===window.frameElement}catch(ignore){}document.documentElement.doScroll&&toplevel&&doScrollCheck()}},doScrollCheck=function(){if(!Ready.isReady){try{document.documentElement.doScroll("left")}catch(error){return void setTimeout(doScrollCheck,1)}domReady()}};Ready.isReady=!1,MentionMe.Ready=Ready}(MentionMe);
!function(MentionMe){"use strict";MentionMe.Strings=function(payloadObj){this.payload=payloadObj},MentionMe.Strings.prototype.getPartnerCode=function(){return this.payload?this.payload.merchantPartnerCode:""},MentionMe.Strings.prototype.getSituationWrapperId=function(){var wrapperSituation,extension="";return this.payload&&(wrapperSituation=this.payload.wrapperSituation),this.isValueSet(wrapperSituation)&&(extension=wrapperSituation),"mmWrapper"+extension},MentionMe.Strings.prototype.getUniqueWrapperId=function(){var unique,extension="";return this.payload&&this.payload.specifics&&(unique=this.payload.specifics["-UNIQUE-"]),this.isValueSet(unique)&&(extension=unique),this.getSituationWrapperId()+"_"+extension},MentionMe.Strings.prototype.replaceKeys=function(stringToReplace,keyValues){var replacedString=stringToReplace;for(var key in keyValues)if({}.hasOwnProperty.call(keyValues,key)){var value=keyValues[key];this.isValueSet(value)&&(replacedString=replacedString===key?value:replacedString.replace(key,encodeURIComponent(value)))}return replacedString},MentionMe.Strings.prototype.isValueSet=function(value){return void 0!==value&&null!==value&&("string"!=typeof value||value.length>0)},MentionMe.Strings.prototype.removeUnsetKeys=function(stringToClean,keyValues){var cleanedString=stringToClean;for(var key in keyValues)({}).hasOwnProperty.call(keyValues,key)&&(cleanedString=(cleanedString=cleanedString.replace("/"+key,"")).replace(key,""));return cleanedString},MentionMe.Strings.prototype.getMerchantInjectionStyles=function(){if(this.payload.config)return this.payload.config["styles-injection"]},MentionMe.Strings.prototype.getMerchantFormStyles=function(){if(this.payload.config)return this.payload.config["styles-form"]},MentionMe.Strings.prototype.getRefereeText=function(){if(this.payload.config)return this.payload.config["referee-link-text"]},MentionMe.Strings.prototype.getReferrerText=function(){if(this.payload.config)return this.payload.config["referrer-link-text"]},MentionMe.Strings.prototype.getEmbeddedFormText=function(){if(this.payload.config)return this.payload.config["form-label"]},MentionMe.Strings.prototype.getEmbeddedFormPlaceholder=function(){if(this.payload.config)return this.payload.config["form-placeholder"]},MentionMe.Strings.prototype.getEmbeddedFormAction=function(){if(this.payload.config)return this.payload.config["form-button"]}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Urls=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmStrings=new MentionMe.Strings(payloadObj)};var pCompleteParamWithElement=function(url,key){var completedURL=url;if(document.getElementById("mmName")){var val=document.getElementById("mmName").value,newParam=key+"="+encodeURIComponent(val);completedURL&&(completedURL=completedURL.replace(new RegExp("([?&])("+key+")=([^?&]*)"),"$1"+newParam))}return completedURL},pMergeObjects=function(obj1,obj2){var attribute;for(attribute in obj2)obj2.hasOwnProperty(attribute)&&(this.mmStrings.isValueSet(obj2[attribute])?obj1[attribute]=obj2[attribute]:obj1.hasOwnProperty(attribute)||(obj1[attribute]=""));return obj1},pRemoveUnsetParameters=function(url,keyValues){var vars,newVars,formattedURL=this.mmStrings.removeUnsetKeys(url,keyValues),queryStringStart=formattedURL.indexOf("?");if(-1===queryStringStart)return formattedURL;vars=formattedURL.substring(queryStringStart+1).split("&"),newVars=[];for(var i=0;i<vars.length;i+=1)vars[i].length>0&&vars[i].indexOf("=")>0&&""!==vars[i].split("=")[1]&&newVars.push(vars[i]);return formattedURL.substring(0,queryStringStart)+"?"+newVars.join("&")},pTriggerEvent=function(type,url){if(url&&""!==url){var compiledURL=pCompileURL.call(this,url),script=document.createElement("script");script.src=compiledURL,MentionMe.fireEvents?(document.body.appendChild(script),log.info("Triggered Event:",type,compiledURL)):log.warn("Firing events disabled!")}else log.warn("Unable to trigger event "+type)},pCompileURL=function(urlToCompile,showResponsive){var url,screenSize=this.mmWindow.findOutWindowSize(),keyValues={"-REFERRINGDOMAIN-":encodeURIComponent(document.domain),"-SCREEN_WIDTH-":screenSize.width,"-SCREEN_HEIGHT-":screenSize.height,"-IS_RESPONSIVE-":showResponsive||!1};return keyValues=pMergeObjects.call(this,this.payload.specifics,keyValues),url=this.mmStrings.replaceKeys(urlToCompile,keyValues),url=pRemoveUnsetParameters.call(this,url,keyValues),log.debug("Compiled URL",url),url};MentionMe.Urls.prototype.getDisplayUrl=function(showResponsive){var url=this.payload.urls.displayUrl;return url&&(url=pCompleteParamWithElement.call(this,url,"search","mmName")),pCompileURL.call(this,url,showResponsive)},MentionMe.Urls.prototype.getSecondaryUrl=function(showResponsive){return this.payload.urls.secondaryUrl?pCompileURL.call(this,this.payload.urls.secondaryUrl,showResponsive):""},MentionMe.Urls.prototype.logClose=function(){pTriggerEvent.call(this,"close",this.payload.urls.logClose)},MentionMe.Urls.prototype.logOpen=function(){pTriggerEvent.call(this,"open",this.payload.urls.logOpen)},MentionMe.Urls.prototype.logContinue=function(){pTriggerEvent.call(this,"continue",this.payload.urls.logContinue)},MentionMe.Urls.prototype.logFailedInsertion=function(){log.warn("Mention Me Tag failed to insert into wrapper. Please check required wrappers are present."),pTriggerEvent.call(this,"failed",this.payload.urls.logFailed)}}(MentionMe);
MentionMe.IframeFactory=function(){"use strict";var mmWindow,opts,pAddNonPopupOpts=function(iframe){return opts.visible||(iframe.style.position="absolute",iframe.style.left="-2000px",iframe.dataIsHidden="true"),iframe},pBuildFillFrameIframe=function(iframe){return iframe.width="100%",iframe.height="100%",iframe.className="mm-referee-fill-screen",iframe.scrolling="auto",iframe},pBuildSlideDownIframe=function(iframe){return iframe.width="100%",iframe.height=0,iframe.style.willChange="transform",iframe},pBuildResponsiveIframe=function(iframe){if(iframe.scrolling="auto",iframe.width="100%",opts.asPopup){var dimensions=null;dimensions=mmWindow.isZoomedIn()?mmWindow.getNonZoomedWindowSize():mmWindow.findOutWindowSize();iframe.width=Math.round(.9*dimensions.width);dimensions.height<1500&&(iframe.height=.9*dimensions.height)}return iframe},pCreateDefaultIframe=function(id,url,dimensions){var iframe=document.createElement("iframe");return iframe.id="mmContent"+id,iframe.scrolling=opts.scrollBars,iframe.style.display="block",iframe.src=url,iframe.width=parseInt(dimensions.width),iframe.height=parseInt(dimensions.height),iframe.cssText="border: 0px",iframe.frameBorder="0",iframe.name=id+(new Date).getTime(),iframe.setAttribute("data-mm-identifier",mmWindow.getUniqueIdentifier()),iframe},pAddDashboardOpts=function(iframe){return iframe.height>mmWindow.findOutWindowSize().height&&(iframe.height=mmWindow.findOutWindowSize().height-100),iframe};return{generateIframe:function(id,url,dimensions,windowObj,optsObj){mmWindow=windowObj,opts=optsObj;var iframe=pCreateDefaultIframe(id,url,dimensions);return opts.usesFillScreenFormFactor&&mmWindow.isOnMobileDevice()?pBuildFillFrameIframe(iframe):opts.asSlideDown&&mmWindow.isOnMobileDevice()?pBuildSlideDownIframe(iframe):opts.asPopup&&opts.showResponsive?pBuildResponsiveIframe(iframe):!opts.asPopup&&opts.showResponsive?pAddNonPopupOpts(pBuildResponsiveIframe(iframe)):opts.asPopup?"Dashboard"===id?pAddDashboardOpts(iframe):iframe:pAddNonPopupOpts(iframe)}}}();
MentionMe.ContainerFactory=function(){"use strict";var isRefereeOnMobileFullFrame=!1,pCoreOptions=function(opts,id,maskId){var container=document.createElement("div");return container.id="mmModal"+id,opts.animate&&!opts.asSlideDown?container.className+="mmClosable mm-display-fade-in":container.className="mmClosable",container.style.overflow="hidden",opts.asSlideDown||isRefereeOnMobileFullFrame||container.setAttribute("data-mask",maskId),container.setAttribute("data-closeall",opts.closingClosesAll),container},pAddModalStyle=function(container,opts,mmWindow){return container.style.boxShadow="0 0 16px 0px rgba(0, 0, 0, 0.3)",mmWindow.isAniOSDevice()?container.style.position="absolute":container.style.position="fixed",container.style.zIndex=999999,container.style.backgroundColor=opts.bgColor||"#FFF",container},pAddSlideDownAttributes=function(container){return container.style.position="",container.style.boxShadow="",container.removeAttribute("data-mask"),container.style.zIndex="999990",container.style.width="100%",container},pUsesFillScreenFormFactor=function(container,mmWindow){if(container.style.width="100%",mmWindow.isAniOSDevice()){var minHeight=document.body.clientHeight>=screen.height?document.body.clientHeight:screen.height;container.style.minHeight=minHeight+"px",container.style.maxHeight="900px",container.style.position="absolute"}else container.style.height="100%",container.style.position="fixed";return container.style.boxShadow="",container.style.margin="0px",container.style.top="0px",container.style.left="0px",container},pUsesPopupFormFactor=function(container,width,height){return container.style.width=parseInt(width)+"px",container.style.height=parseInt(height)+"px",container.style.top="50%",container.style.left="50%",container.style.margin=parseInt(height/2*-1)+"px 0 0 "+parseInt(width/2*-1)+"px",container},pModifyForResponsive=function(container){return container.style.overflowY="scroll",container.style.WebkitOverflowScrolling="touch",container};return{generateContainer:function(opts,modalId,maskDomId,mmWindow,width,height){isRefereeOnMobileFullFrame=opts.usesFillScreenFormFactor&&mmWindow.isOnMobileDevice();var coreContainer=pAddModalStyle(pCoreOptions(opts,modalId,maskDomId),opts,mmWindow);return isRefereeOnMobileFullFrame?pUsesFillScreenFormFactor(coreContainer,mmWindow):opts.asSlideDown?pAddSlideDownAttributes(coreContainer):!opts.usesFillScreenFormFactor&&opts.showResponsive?pModifyForResponsive(pUsesPopupFormFactor(coreContainer,width,height)):pUsesPopupFormFactor(coreContainer,width,height)}}}();
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Dom=function(payloadObj){this.payload=payloadObj,this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj)};var pCanInsertIntoWrapper=function(wrapperName){var result=document.getElementById(wrapperName)&&pHasNoWrappingChildren(document.getElementById(wrapperName));return result?log.info("Found wrapper "+wrapperName):log.debug("Could not find a wrapper "+wrapperName),result},pHasNoWrappingChildren=function(element){for(var count=0,len=element.childNodes.length,i=0;i<len;i++){var node=element.childNodes[i];node.nodeType===Node.ELEMENT_NODE&&(" "+node.className+" ").indexOf(" mmWrapping ")>-1&&count++}return count<1},pInsertAfter=function(referenceNode,newNode){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling)},pIsElementInViewport=function(element){var rect=element.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},pAdjustWidthToViewPort=function(element){if(!pIsElementInViewport(element)){var rect=element.getBoundingClientRect(),newWidth=(window.innerWidth||document.documentElement.clientWidth)-rect.left;newWidth<rect.width&&(element.width=newWidth)}};MentionMe.Dom.prototype.removeElementByIdIfExists=function(id){var elem=document.getElementById(id);null!==elem&&elem.parentNode.removeChild(elem)},MentionMe.Dom.prototype.insertIntoWrapper=function(newNode){var referenceNode,wrapper,inserted=!1,uniqueWrapperId=this.mmStrings.getUniqueWrapperId(),situationWrapperId=this.mmStrings.getSituationWrapperId(),cnf=this.payload.config||{};if(pCanInsertIntoWrapper(uniqueWrapperId))(wrapper=document.getElementById(uniqueWrapperId)).style.position="relative",wrapper.appendChild(newNode),inserted=!0;else if(pCanInsertIntoWrapper(situationWrapperId))(wrapper=document.getElementById(situationWrapperId)).style.position="relative",wrapper.appendChild(this.wrap(newNode)),inserted=!0;else{for(var injectionPoints=["injection-selector-after","injection-selector-within","injection-selector-before"],i=0;i<injectionPoints.length;i++){var injectionPointName=injectionPoints[i],injectionPoint=cnf[injectionPointName];if(injectionPoint&&0!==injectionPoint.length&&(log.debug("Looking for injection point "+injectionPoint),referenceNode=document.querySelector(injectionPoint))){log.info("Inserting into injection point "+injectionPointName+" : "+injectionPoint);var wrappedNode=this.wrap(newNode);"injection-selector-after"===injectionPointName?pInsertAfter(referenceNode,wrappedNode):"injection-selector-within"===injectionPointName?referenceNode.appendChild(wrappedNode):"injection-selector-before"===injectionPointName&&referenceNode.parentNode.insertBefore(wrappedNode,referenceNode),inserted=!0;break}}!inserted&&pCanInsertIntoWrapper("mmWrapper")&&((wrapper=document.getElementById("mmWrapper")).appendChild(this.wrap(newNode)),inserted=!0)}return inserted?pAdjustWidthToViewPort(newNode):this.mmUrls.logFailedInsertion(),inserted},MentionMe.Dom.prototype.wrap=function(newNode){var wrapper=document.createElement("div"),cnf=this.payload.config||{};return wrapper.id=this.mmStrings.getUniqueWrapperId(),wrapper.appendChild(newNode),cnf["injection-wrapper-class"]&&cnf["injection-wrapper-class"].length>0&&(wrapper.className=cnf["injection-wrapper-class"]),cnf["injection-wrapper-styles"]&&cnf["injection-wrapper-styles"].length>0&&(wrapper.style.cssText=cnf["injection-wrapper-styles"]),wrapper.style.position="relative",wrapper.className=wrapper.className+" mmWrapping",wrapper},MentionMe.Dom.prototype.hasClass=function(el,className){return el.classList?el.classList.contains(className):!!el.className.match(new RegExp("(\\s|^)"+className+"(\\s|$)"))},MentionMe.Dom.prototype.addClass=function(el,className){var self=this;el.classList?el.classList.add(className):self.hasClass(el,className)||(el.className+=" "+className)},MentionMe.Dom.prototype.removeClass=function(el,className){var self=this;if(el.classList)el.classList.remove(className);else if(self.hasClass(el,className)){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");el.className=el.className.replace(reg," ")}}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log,bgColor="#FFF",scrollManager=null;MentionMe.Display=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDom=new MentionMe.Dom(payloadObj),scrollManager=MentionMe.ScrollManager(),new MentionMe.PostMessage(payloadObj,this).addPostMessageListener()};var pRedisplayModal=function(modal,id){log.info("Reshowing existing modal: ",id);var maskId="mmMask"+id,mask=document.getElementById(maskId);if(mask&&(mask.className="mmClosable",mask.style.display="inline"),modal.className="mmClosable",modal.style.display="inline",this.mmWindow.isAniOSDevice){var moveTo=parseInt(modal.style.top,10),height=parseInt(modal.style.height,10);moveTo-=height/4,log.info("iOS only moving to  ",moveTo);setTimeout(function(){window.scrollTo(0,moveTo)},100)}return modal},pAddStylesToIFrame=function(closeMaskId){var mask="#"+closeMaskId+"{position:fixed;top:0px;left:0px;display:block;opacity:0.70;filter:alpha(opacity=70);z-index:9998;background-color:#555;width:100%;height:100%} ";this.addStyleSection(mask+".mm-display-fade-in {-webkit-animation: fadein 0.525s; /* Safari, Chrome and Opera > 12.1 */-moz-animation: fadein 0.525s; /* Firefox < 16 */-ms-animation: fadein 0.525s; /* Internet Explorer */-o-animation: fadein 0.525s; /* Opera < 12.1 */animation: fadein 0.525s;}@keyframes fadein {    from { opacity: 0; }    to   { opacity: 1; }}@-moz-keyframes fadein {    from { opacity: 0; }    to   { opacity: 1; }}@-webkit-keyframes fadein {    from { opacity: 0; }    to   { opacity: 1; }}@-ms-keyframes fadein {    from { opacity: 0; }    to   { opacity: 1; }}@-o-keyframes fadein {    from { opacity: 0; }    to   { opacity: 1; }}.mm-display-fade-out {opacity: 0 !important; transition: opacity 0.505s ease}")},pAnimatePeelAppearing=function(mask,modal){mask.className+=" mm-display-fade-out",modal.className="mmClosable mm-display-fade-out",MentionMe.Overlay.openOverlay(this.mmStrings.getUniqueWrapperId()),setTimeout(function(){pHideModalsForCornerPeel.call(this,mask,modal)}.bind(this),400)},pHideModalsForCornerPeel=function(mask,modal){var closingClosesAll="true"===modal.getAttribute("data-closeall");"none"!==modal.style.display&&(modal.style.diplay="none",mask.style.display="none",closingClosesAll&&this.mmUrls.logClose()),closingClosesAll&&this.closeModals()},pDisplayIFrameAsPopup=function(id,iframe,opts){var mask,self=this;(mask=document.createElement("div")).id="mmMask"+id,mask.className="mmClosable",mask.style.height=this.mmWindow.getDocumentHeight(iframe.height)+"px",mask.onclick=function(){log.info("onclick for popup iframe mask");var modal=document.getElementById("mmModal"+id);pAnimatePeelAppearing.call(self,mask,modal)},iframe.setAttribute("data-mask-id",mask.id),"Referee"===id&&window.addEventListener("message",function(evt){var domain=evt.origin.split("://")[1];(domain.match(/[.]/g)||[]).length>1&&(domain=domain.substr(domain.indexOf(".")+1)),"mention-me.com"===domain&&evt.data&&"bgColor"===evt.data.type&&(bgColor=evt.data.bgColor)},!1);var popupContainer=MentionMe.ContainerFactory.generateContainer(opts,id,mask.id,this.mmWindow,iframe.width,iframe.height);return mask.style.display="none",popupContainer.style.left="-2000px",popupContainer.appendChild(iframe),opts.visible&&(iframe.onload=function(isAniOSDevice){return function(evt){var parent=evt.target.parentElement;parent.style.backgroundColor=bgColor,mask&&(mask.style.display="block"),parent.style.display="block",parent.style.left="50%";var grandparent=parent.parentElement;grandparent&&(" "+grandparent.className+" ").indexOf("mmClosable")>0&&(grandparent.style.display="block",grandparent.style.left="50%"),opts.usesFillScreenFormFactor&&(scrollManager.setScrollPosition([window.pageXOffset,window.pageYOffset]),scrollManager.updateScroll([0,0])),isAniOSDevice&&(scrollManager.setScrollPosition([window.pageXOffset,window.pageYOffset]),scrollManager.updateScroll([parent.offsetLeft,parent.offsetTop]))}}(this.mmWindow.isAniOSDevice())),this.makeEscapeClose(),opts.hasMask&&document.body.appendChild(mask),document.body.appendChild(popupContainer),iframe},pPutSlideDownInContainer=function(id,toInject,opts){var container=MentionMe.ContainerFactory.generateContainer(opts,id,null,this.mmWindow);if(container.style.display="none",container.appendChild(toInject),opts.visible){var iframe=toInject;"iframe"!==iframe.tagName.toLowerCase()&&(iframe=toInject.getElementsByTagName("iframe")[0]),iframe.onload=function(){opts.skipOffer?iframe.className+=" mm-slide-down-skip-step":iframe.className+=" mm-slide-down-initial-step",container.style.display="block"}}return container};MentionMe.Display.prototype.makeEscapeClose=function(){var self=this;document.onkeyup=function(){var origOnkeyup=document.onkeyup;return function(evt){var event=evt;return null!==origOnkeyup&&origOnkeyup(),evt||(event=window.event),27===event.keyCode&&(self.closeModals(),self.mmUrls.logClose(),!0)}}()},MentionMe.Display.prototype.closeModals=function(){for(var closableItems=document.getElementsByClassName("mmClosable"),i=0;i<closableItems.length;i++)"none"!==closableItems[i].style.display&&(closableItems[i].style.display="none");this.mmWindow.isOnMobileDevice()&&scrollManager.updateScroll()},MentionMe.Display.prototype.handleClose=function(mask,modal){pAnimatePeelAppearing.call(this,mask,modal),this.payload.usesFillScreenFormFactor&&this.mmWindow.isOnMobileDevice()&&scrollManager.updateScroll()},MentionMe.Display.prototype.handleSlidedownClose=function(modal){var iframe=modal.getElementsByTagName("iframe");iframe.length>0&&(setTimeout(function(){iframe[0].style.display="none",this.mmUrls.logClose(),this.closeModals()}.bind(this),750),iframe[0].className+=" mm-slide-down-exit-step")},MentionMe.Display.prototype.createAndInsertIframe=function(iframeIdSuffix,dimensions,iframeUrl,iframeOpts){var containerId="mmModal"+iframeIdSuffix,maskId="mmMask"+iframeIdSuffix,defaultOpts={asPopup:!0,visible:!0,hasContinue:!1,hasMask:!0,scrollBars:"no",closingClosesAll:!0,forceReload:!1,showResponsive:!1,fullFrameResponsive:!1};for(var option in defaultOpts)iframeOpts.hasOwnProperty(option)||(iframeOpts[option]=defaultOpts[option]);this.mmStrings.getMerchantInjectionStyles()&&this.addStyleSection(this.mmStrings.getMerchantInjectionStyles()),iframeOpts.forceReload&&(log.info("Reload forced: Removing existing modal and mask (if they exist)"),this.mmDom.removeElementByIdIfExists(containerId),this.mmDom.removeElementByIdIfExists(maskId));var modalContainer=document.getElementById(containerId);if(modalContainer)return iframeOpts.visible&&(pRedisplayModal.call(this,modalContainer,iframeIdSuffix),scrollManager.updateScroll([0,0])),modalContainer;var iframe=MentionMe.IframeFactory.generateIframe(iframeIdSuffix,iframeUrl,dimensions,this.mmWindow,iframeOpts);if(pAddStylesToIFrame.call(this,maskId),iframeOpts.asPopup)return pDisplayIFrameAsPopup.call(this,iframeIdSuffix,iframe,iframeOpts);if(iframeOpts.asSlideDown){var container=pPutSlideDownInContainer.call(this,iframeIdSuffix,iframe,iframeOpts);return this.mmDom.insertIntoWrapper(container),container}return this.mmDom.insertIntoWrapper(iframe)&&iframeOpts.visible&&(iframe.parentNode.style.height=iframe.height+"px",this.mmUrls.logOpen()),iframe},MentionMe.Display.prototype.addStyleSection=function(cssCode){if(cssCode){var styleElement=document.createElement("style");styleElement.type="text/css",styleElement.appendChild(document.createTextNode(cssCode)),document.getElementsByTagName("head")[0].appendChild(styleElement)}}}(MentionMe);
!function(MentionMe){"use strict";MentionMe.AutoCoupon=function(dataPayload){this.data=dataPayload,this.cookieManager=MentionMe.CookieManager(dataPayload.partnerCode),this.display=new MentionMe.Display(dataPayload),this.conversionMessage=new MentionMe.ConversionMessage(dataPayload)},MentionMe.AutoCoupon.CookieIdentifier="autocoupon",MentionMe.AutoCoupon.prototype.init=function(){this.cookieManager.isSuppressionCookieSet(MentionMe.AutoCoupon.CookieIdentifier)||this.applyCouponAutomatically()},MentionMe.AutoCoupon.prototype.applyCouponAutomatically=function(){if(this.data.couponFieldId&&this.data.couponCode){for(var elements=[].slice.call(document.querySelectorAll(this.data.couponFieldId)),index=0;index<elements.length;index++)elements[index].value=this.data.couponCode,this.cookieManager.suppressForTenMins(MentionMe.AutoCoupon.CookieIdentifier),this.data.html&&this.conversionMessage.displayMessage(this.data,elements[index],this.display);this.data.couponButtonId&&this.autoClickApplyVoucherBtn()}},MentionMe.AutoCoupon.prototype.autoClickApplyVoucherBtn=function(){for(var elements=[].slice.call(document.querySelectorAll(this.data.couponButtonId)),index=0;index<elements.length;index++)elements[index].click()}}(MentionMe);
!function(MentionMe){"use strict";var cookieManager,HIDE_CONTAINER_CLS=" mm-conversion-message-container-hidden",log=MentionMe.log;MentionMe.ConversionMessage=function(payloadObj){payloadObj&&(this.payload=payloadObj,this.mmDom=new MentionMe.Dom(payloadObj)),cookieManager=MentionMe.CookieManager(this.payload.partnerCode)},MentionMe.ConversionMessage.CookieIdentifier="conversion_message";var pAddStyles=function(data,mmDisplay){data.styles&&mmDisplay.addStyleSection(data.styles)};MentionMe.ConversionMessage.prototype.dropMessage=function(){if(cookieManager.isSuppressionCookieSet(MentionMe.ConversionMessage.CookieIdentifier))log.info("Suppressing the Conversion Message");else{var div=document.createElement("div");if(div.innerHTML=this.payload.html,div.className="mm-conversion-message"+HIDE_CONTAINER_CLS,this.mmDom.insertIntoWrapper(div)){setTimeout(function(){div.className="mm-conversion-message mm-conversion-message-container-display",this.addCloseEventListener()}.bind(this),400)}else log.debug("An error occured displaying the conversion message")}},MentionMe.ConversionMessage.prototype.addCloseEventListener=function(){var closeButton=document.getElementsByClassName("mm-conversion-message-close")[0];closeButton&&closeButton.addEventListener("click",function(){var conversionContainer=document.getElementsByClassName("mm-conversion-message")[0];conversionContainer&&(conversionContainer.className="mm-conversion-message"+HIDE_CONTAINER_CLS,cookieManager.suppressForOneHour(MentionMe.ConversionMessage.CookieIdentifier))})},MentionMe.ConversionMessage.prototype.displayMessage=function(data,elm,mmDisplay){if(cookieManager.isSuppressionCookieSet(MentionMe.ConversionMessage.CookieIdentifier))log.info("Suppressing the Conversion Message");else{pAddStyles(data,mmDisplay);var div=document.createElement("div");div.innerHTML=data.html,div.className="mm-conversion-message"+HIDE_CONTAINER_CLS,elm.parentNode.insertBefore(div,elm.nextSibling),setTimeout(function(){div.className="mm-conversion-message mm-autoapply-animation"},300)}}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Slidedown=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj)},MentionMe.Slidedown.prototype.create=function(methodType){var dimensions=this.payload.dimensions.slide_down,showResponsive=this.mmWindow.shouldShowResponsive(dimensions),opts=pGetOpts.call(this);log.debug("Initialising "+methodType),this.payload.styles&&this.mmDisplay.addStyleSection(this.payload.styles),this.payload.skipOffer?pInitSkipOfferFlow.call(this,dimensions,showResponsive,opts):pInitTwoPageFlow.call(this,dimensions,showResponsive,opts)};var pInitSkipOfferFlow=function(dimensions,showResponsive,opts){opts.hasContinue=!1,this.mmDisplay.createAndInsertIframe("Register",dimensions,this.mmUrls.getDisplayUrl(showResponsive),opts),this.mmUrls.logOpen()},pInitTwoPageFlow=function(dimensions,showResponsive,opts){var secondaryOpts=pGetOpts.call(this);secondaryOpts.visible=!1,secondaryOpts.hasContinue=!1;var registerContainer=this.mmDisplay.createAndInsertIframe("Register",dimensions,this.mmUrls.getSecondaryUrl(showResponsive),secondaryOpts),registerIframe=registerContainer.getElementsByTagName("iframe")[0],offerContainer=this.mmDisplay.createAndInsertIframe("Offer",dimensions,this.mmUrls.getDisplayUrl(showResponsive),opts),offerIframe=offerContainer.getElementsByTagName("iframe")[0];offerContainer.style.height=this.payload.dimensions.slide_down.height+"px";var self=this;offerIframe.addEventListener("continue",function(evt){setTimeout(function(){offerContainer.style.display="none",registerContainer.style.display="block"},300),offerIframe.className+=" mm-slide-down-vertical-flip-out",registerIframe.className+=" mm-slide-down-vertical-flip-in",self.mmUrls.logContinue(),evt.preventDefault()}),this.mmUrls.logOpen()},pGetOpts=function(){return JSON.parse(JSON.stringify({asPopup:!1,asSlideDown:!0,visible:!0,hasContinue:!0,scrollBars:"no",closingClosesAll:!0,skipOffer:this.payload.skipOffer,showResponsive:!0,wrapperId:this.mmStrings.getUniqueWrapperId()}))}}(MentionMe);
!function(MentionMe){"use strict";MentionMe.Popup=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj)};var pCreateRefereeModal=function(){var dimensions=this.payload.dimensions.referee,showResponsive=this.mmWindow.shouldShowResponsive(dimensions),usesFillScreenFormFactor=this.payload.usesFillScreenFormFactor,refereeIframe=this.mmDisplay.createAndInsertIframe("Referee",dimensions,this.mmUrls.getDisplayUrl(showResponsive),{bgColor:this.payload.bgColor,showResponsive:showResponsive,usesFillScreenFormFactor:usesFillScreenFormFactor,animate:!0,hasContinue:!0});return this.mmUrls.logOpen(),refereeIframe},pCreateSingleReferrerModal=function(shouldStartVisible){var startVisible=void 0===shouldStartVisible||shouldStartVisible,dimensions=this.payload.dimensions.referrer,showResponsive=this.mmWindow.shouldShowResponsive(dimensions),id="Register";this.popupId=id;var registerIframe=this.mmDisplay.createAndInsertIframe(id,dimensions,this.mmUrls.getDisplayUrl(showResponsive),{showResponsive:showResponsive,animate:!0,visible:startVisible});return this.mmUrls.logOpen(),registerIframe},pCreateReferrerModals=function(startVisible){var dimensions=this.payload.dimensions,showResponsive=this.mmWindow.shouldShowResponsive(dimensions.referrer),showOfferResponsive=this.mmWindow.shouldShowResponsive(dimensions.offer);this.popupId="Offer";var registerIframe=this.mmDisplay.createAndInsertIframe("Register",dimensions.referrer,this.mmUrls.getSecondaryUrl(showResponsive),{visible:!1,animate:!1,showResponsive:showResponsive}),offerIframe=this.mmDisplay.createAndInsertIframe("Offer",dimensions.offer,this.mmUrls.getDisplayUrl(showOfferResponsive),{showResponsive:showOfferResponsive,animate:!0,visible:startVisible,continueIframe:registerIframe}),self=this;return offerIframe.addEventListener("continue",function(evt){var maskToClose=document.getElementById(offerIframe.getAttribute("data-mask-id"));maskToClose&&(maskToClose.style.display="none"),offerIframe.parentNode.style.display="none";var maskToOpen=document.getElementById(registerIframe.getAttribute("data-mask-id"));maskToOpen&&(maskToOpen.style.display="block"),registerIframe.parentNode.style.display="block",registerIframe.parentNode.style.left="50%",offerIframe.parentNode.setAttribute("data-defer-opening","Register"),self.mmUrls.logContinue(),evt.preventDefault()}),this.mmUrls.logOpen(),[offerIframe,registerIframe]},pCreateDashboardModal=function(){var dimensions=this.payload.dimensions,showResponsive=this.mmWindow.shouldShowResponsive(dimensions.dashboard),dashboardIframe=this.mmDisplay.createAndInsertIframe("Dashboard",dimensions.dashboard,this.mmUrls.getDisplayUrl(showResponsive),{showResponsive:showResponsive,hasContinue:!0,animate:!0,scrollBars:"auto"});return this.mmUrls.logOpen(),dashboardIframe};MentionMe.Popup.prototype.create=function(type,onePageFlow,shouldStartVisible){switch(type){case"dashboard":case"dashboard-first-time":return pCreateDashboardModal.call(this);case"referee":return pCreateRefereeModal.call(this);case"referrer":default:var forceSingleModal=onePageFlow||!1,startVisible=void 0===shouldStartVisible||shouldStartVisible;return this.payload.skipOffer||forceSingleModal?pCreateSingleReferrerModal.call(this,startVisible):pCreateReferrerModals.call(this,startVisible)}}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Banner=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj)},MentionMe.Banner.prototype.create=function(){log.info("Creating a banner");var bannerDimensions=this.payload.dimensions.banner,showResponsiveBanner=this.mmWindow.shouldShowResponsive(bannerDimensions),bannerUrl=this.mmUrls.getDisplayUrl(showResponsiveBanner),registerDimensions=this.payload.dimensions.referrer,showResponsiveRegister=this.mmWindow.shouldShowResponsive(registerDimensions),registerUrl=this.mmUrls.getSecondaryUrl(showResponsiveRegister),self=this,bannerIframe=this.mmDisplay.createAndInsertIframe("Banner",bannerDimensions,bannerUrl,{asPopup:!1,showResponsive:showResponsiveRegister,hasMask:!1});return bannerIframe.addEventListener("continue",function(evt){log.info("Creating a BannerRegister iframe"),self.mmDisplay.createAndInsertIframe("BannerRegister",registerDimensions,registerUrl,{showResponsive:showResponsiveRegister}),evt.preventDefault()}),bannerIframe}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Embed=function(payload){this.payload=payload,this.mmWindow=new MentionMe.Window(payload),this.mmStrings=new MentionMe.Strings(payload),this.mmUrls=new MentionMe.Urls(payload),this.mmDisplay=new MentionMe.Display(payload)};var pCreateReferee=function(){var dimensions=this.payload.dimensions.referee,showResponsive=this.mmWindow.shouldShowResponsive(dimensions);return this.mmDisplay.createAndInsertIframe("Referee",dimensions,this.mmUrls.getDisplayUrl(showResponsive),{asPopup:!1,hasContinue:!0,showResponsive:showResponsive})},pCreateDashboard=function(){var dimensions=this.payload.dimensions.dashboard,showResponsive=this.mmWindow.shouldShowResponsive(dimensions);return dimensions.height=this.mmWindow.getDocumentHeight(dimensions.height),this.mmDisplay.createAndInsertIframe("Dashboard",dimensions,this.mmUrls.getDisplayUrl(showResponsive),{asPopup:!1,hasContinue:!0,scrollBars:"auto",showResponsive:showResponsive})},pCreateSingleReferrer=function(){var dimensions=this.payload.dimensions.referrer,showResponsive=this.mmWindow.shouldShowResponsive(dimensions);return this.mmDisplay.createAndInsertIframe("Register",dimensions,this.mmUrls.getDisplayUrl(showResponsive),{asPopup:!1,showResponsive:showResponsive})},pCreateReferrer=function(){var wrapperSituation=this.payload.wrapperSituation;if(wrapperSituation&&"dashboard-register"===wrapperSituation.substr(0,"dashboard-register".length))return pCreateFullFrameLazyLoad.call(this);var dimensions=this.payload.dimensions,showResponsiveRegister=this.mmWindow.shouldShowResponsive(dimensions.referrer),showOfferResponsive=this.mmWindow.shouldShowResponsive(dimensions.offer),registerIframe=this.mmDisplay.createAndInsertIframe("Register",dimensions.referrer,this.mmUrls.getSecondaryUrl(showResponsiveRegister),{asPopup:!1,showResponsive:showResponsiveRegister,visible:!1}),offerIframe=this.mmDisplay.createAndInsertIframe("Offer",dimensions.offer,this.mmUrls.getDisplayUrl(showOfferResponsive),{asPopup:!1,showResponsive:showOfferResponsive}),self=this;return offerIframe.addEventListener("continue",function(evt){offerIframe.style.display="none",registerIframe.style.position="static",registerIframe.style.left="0",registerIframe.parentNode.style.height=registerIframe.height+"px",self.mmUrls.logContinue(),evt.preventDefault()}),[offerIframe,registerIframe]},pCreateFullFrameLazyLoad=function(){var offerDimensions=this.payload.dimensions.offer,offerShowResponsive=this.mmWindow.shouldShowResponsive(offerDimensions),self=this,lazyOfferIframe=this.mmDisplay.createAndInsertIframe("LazyOffer",offerDimensions,this.mmUrls.getDisplayUrl(offerShowResponsive),{asPopup:!1,showResponsive:offerShowResponsive});return lazyOfferIframe.addEventListener("continue",function(evt){evt.target.style.display="none";var referrerDimensions=self.payload.dimensions.referrer,referrerShowResponsive=self.mmWindow.shouldShowResponsive(referrerDimensions),dashboardRegisterIframe=self.mmDisplay.createAndInsertIframe("DashboardRegister",referrerDimensions,self.mmUrls.getSecondaryUrl(referrerShowResponsive),{asPopup:!1,showResponsive:referrerShowResponsive});return self.mmUrls.logContinue(),dashboardRegisterIframe}),lazyOfferIframe},pCreateConversionMessage=function(){this.payload.html&&(this.mmDisplay.addStyleSection(this.mmStrings.getMerchantInjectionStyles()),this.mmDisplay.addStyleSection(this.payload.styles),new MentionMe.ConversionMessage(this.payload).dropMessage())};MentionMe.Embed.prototype.create=function(type){switch(log.info("Creating an embed of: ",type),type){case"referrer":return this.payload.skipOffer?pCreateSingleReferrer.call(this):pCreateReferrer.call(this);case"referee":return pCreateReferee.call(this);case"dashboard":case"dashboard-first-time":return pCreateDashboard.call(this);case"conversion-message":return pCreateConversionMessage.call(this);default:return log.error("Unexpected request for embed of type "+type),null}}}(MentionMe);
!function(MentionMe){"use strict";MentionMe.Form=function(payloadObj){this.payload=payloadObj,this.mmStrings=new MentionMe.Strings(payloadObj),this.mmDom=new MentionMe.Dom(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmWindow=new MentionMe.Window(payloadObj)};var pCreateForm=function(){var mmForm=document.createElement("form");mmForm.id="mmForm",mmForm.className="mmForm",mmForm.style.backgroundColor="#FFF",mmForm.action="#";var mmFormLabel=document.createElement("label");mmFormLabel.htmlFor="mmName",mmFormLabel.appendChild(document.createTextNode(this.mmStrings.getEmbeddedFormText())),mmForm.appendChild(mmFormLabel);var mmFormInput=document.createElement("input");mmFormInput.type="text",mmFormInput.id="mmName",mmFormInput.placeholder=this.mmStrings.getEmbeddedFormPlaceholder(),mmFormInput.value="",mmForm.appendChild(mmFormInput);var mmFormSubmit=document.createElement("input");return mmFormSubmit.type="submit",mmFormSubmit.id="mmSubmit",mmFormSubmit.value=this.mmStrings.getEmbeddedFormAction(),mmForm.appendChild(mmFormSubmit),mmForm},pAddEventListeners=function(mmForm){var forceReload=!1,self=this,mmFormInput=mmForm.getElementsByTagName("input")[0];mmForm.onsubmit=function(){self.mmUrls.logOpen();var dimensions=self.payload.dimensions.referee,showResponsive=self.mmWindow.shouldShowResponsive(dimensions);return self.mmDisplay.createAndInsertIframe("Referee",dimensions,self.mmUrls.getDisplayUrl(showResponsive),{hasContinue:!0,forceReload:forceReload,showResponsive:showResponsive}),forceReload=!1,!1},mmFormInput.onchange=function(){forceReload=!0}};MentionMe.Form.prototype.create=function(){var mmForm=pCreateForm.call(this);return pAddEventListeners.call(this,mmForm),this.mmStrings.getMerchantFormStyles()&&this.mmDisplay.addStyleSection(this.mmStrings.getMerchantFormStyles()),this.mmDom.insertIntoWrapper(mmForm),mmForm}}(MentionMe);
MentionMe.LinkFactory=function(){"use strict";var payload,mmUrls,mmStrings,log=MentionMe.log,scrollManager=MentionMe.ScrollManager(),pDefaultLink=function(linkText){var mmLink=document.createElement("a");return mmLink.id="mmLink",mmLink.target="_blank",mmLink.className="mmLink",mmLink.href=mmUrls.getDisplayUrl(!1),mmLink.appendChild(document.createTextNode(linkText)),mmLink},addCreatePopupListener=function(mmLink,type){return mmLink.onclick=function(){return new MentionMe.Popup(payload).create(type),!1},mmLink},addOpenPopupListener=function(mmLink,popupId){var mmWindow=new MentionMe.Window;return mmLink.onclick=function(isAniOSDevice){return function(){var targetId=popupId;if(targetId){var popupToShow=document.getElementById("mmModal"+targetId),defer=popupToShow.getAttribute("data-defer-opening");defer&&(targetId=defer,popupToShow=document.getElementById("mmModal"+targetId)),popupToShow&&(popupToShow.style.display="block",popupToShow.style.left="50%",popupToShow.className="mmClosable mm-display-fade-in",isAniOSDevice&&(scrollManager.setScrollPosition([window.pageXOffset,window.pageYOffset]),scrollManager.updateScroll([parent.offsetLeft,parent.offsetTop])));var maskToShow=document.getElementById("mmMask"+targetId);maskToShow&&(maskToShow.style.display="block",maskToShow.className="mmClosable")}return!1}}(mmWindow.isAniOSDevice()),mmLink};return{generateLink:function(payloadObj,stringsObj,urlsObj,type,popupId){payload=payloadObj,mmStrings=stringsObj,mmUrls=urlsObj;var linkText=type===MentionMe.Type.REFEREE?mmStrings.getRefereeText():mmStrings.getReferrerText(),defaultLink=pDefaultLink(linkText),validType=!1;for(var key in MentionMe.Type)if(MentionMe.Type[key]===type){validType=!0;break}return validType?popupId?addOpenPopupListener(defaultLink,popupId):addCreatePopupListener(defaultLink,type):(log.error("Unexpected link type:",type),null)}}}();
!function(MentionMe){"use strict";MentionMe.Link=function(payloadObj){this.payload=payloadObj,this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDom=new MentionMe.Dom(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj)},MentionMe.Link.prototype.create=function(type){this.mmStrings.getMerchantInjectionStyles()&&this.mmDisplay.addStyleSection(this.mmStrings.getMerchantInjectionStyles());var popupId=null;if(type===MentionMe.Type.REFERRER){var hiddenPopup=new MentionMe.Popup(this.payload);hiddenPopup.create(type,!1,!1),popupId=hiddenPopup.popupId}var mmLink=MentionMe.LinkFactory.generateLink(this.payload,this.mmStrings,this.mmUrls,type,popupId);this.mmDom.insertIntoWrapper(mmLink)}}(MentionMe);
!function(MentionMe){"use strict";var cookieManager,scrollManager,mmDom,log=MentionMe.log;MentionMe.Overlay=function(payloadObj){this.payload=payloadObj,this.mmWindow=new MentionMe.Window(payloadObj),this.mmStrings=new MentionMe.Strings(payloadObj),this.mmUrls=new MentionMe.Urls(payloadObj),this.mmDisplay=new MentionMe.Display(payloadObj),cookieManager=MentionMe.CookieManager(this.mmStrings.getPartnerCode()),mmDom=new MentionMe.Dom(payloadObj),scrollManager=MentionMe.ScrollManager()},MentionMe.Overlay.CookieIdentifier="overlay",MentionMe.Overlay.prototype.create=function(type){log.info("Creating a normal overlay");var dimensions=this.payload.dimensions,showResponsive=this.mmWindow.shouldShowResponsive(dimensions[type]),url=this.mmUrls.getDisplayUrl(showResponsive);return""!==this.mmUrls.getSecondaryUrl(showResponsive)&&(url=this.mmUrls.getSecondaryUrl(showResponsive)),this.mmDisplay.createAndInsertIframe("Register",dimensions[type],url,{showResponsive:showResponsive,visible:!1}),MentionMe.Overlay.openOverlay(this.mmStrings.getUniqueWrapperId()),this.mmUrls.logOpen(),!1},MentionMe.Overlay.prototype.reAdjustOverlaySize=function(){var windowSize=this.mmWindow.findOutWindowSize(),overlay=document.getElementById("mmOverlay"+this.mmStrings.getUniqueWrapperId()),showDesktop=this.payload.overlay.type.showDesktop,showResponsive=this.payload.overlay.type.showResponsive;windowSize.width<768||windowSize.width<overlay.style.width?showResponsive?overlay.style.width=windowSize.width+"px":(overlay.dontShow=!0,overlay.style.display="none"):showDesktop&&windowSize.width>this.payload.dimensions.overlay.width?(overlay.style.width=this.payload.dimensions.overlay.width+"px",overlay.style.height=this.payload.dimensions.overlay.height+"px"):(overlay.dontShow=!0,overlay.style.display="none")},MentionMe.Overlay.prototype.createExtraOverlay=function(){log.info("Creating an extra overlay");var overlay=document.createElement("div"),styles=this.payload.overlay.styles,content=this.payload.overlay.content,self=this,uniqueWrapperId=this.mmStrings.getUniqueWrapperId();return this.mmDisplay.addStyleSection(styles),overlay.id="mmOverlay"+this.mmStrings.getUniqueWrapperId(),overlay.className="mm-body mm-overlay-fixed mm-overlay-fixed-out",overlay.style.display="none",overlay.dataTarget="Register",log.info("Adding onclick to overlay target:","Register"),overlay.onclick=function(evt){if("mm-frame-overlay-close"===evt.target.className||"mm-frame-mobile-overlay-close"===evt.target.className)MentionMe.Overlay.closeOverlay(uniqueWrapperId,!0);else if(document.getElementById("mmModal"+this.dataTarget)){var modal=document.getElementById("mmModal"+this.dataTarget),mask=document.getElementById("mmMask"+this.dataTarget);"-2000px"!==modal.style.left&&"none"!==modal.style.display||"A"!==evt.target.tagName||(modal.style.display="inline",modal.style.left="50%",mask.style.display="inline",modal.className="mmClosable mm-display-fade-in",mask.className="mmClosable",MentionMe.Overlay.closeOverlay(uniqueWrapperId,!1),scrollManager.updateScroll([modal.parentNode.offsetLeft,modal.parentNode.offsetTop]),self.mmUrls.logContinue())}return!1},overlay.innerHTML=content,document.body.appendChild(overlay),this.reAdjustOverlaySize(),window.addEventListener("resize",this.reAdjustOverlaySize.bind(this)),!1},MentionMe.Overlay.openOverlay=function(uniqueWrapperId){if(cookieManager&&cookieManager.isSuppressionCookieSet(MentionMe.Overlay.CookieIdentifier))log.debug("Overlay will not be opened as the user has previously dismissed it.");else{var overlayId="mmOverlay"+uniqueWrapperId,overlayElm=document.getElementById(overlayId);overlayElm?overlayElm.dontShow?log.debug("Overlay is set to disabled. Cannot open it."):(log.debug("Opening overlay"),overlayElm.style.display="block",mmDom.addClass(overlayElm,"mm-overlay-fixed-in"),mmDom.removeClass(overlayElm,"mm-overlay-fixed-out")):log.debug("Overlay is not defined. Cannot open it.")}},MentionMe.Overlay.closeOverlay=function(uniqueWrapperId,suppressCookie){var overlayId="mmOverlay"+uniqueWrapperId,overlayElm=document.getElementById(overlayId);overlayElm&&(log.debug("Closing overlay"),mmDom.addClass(overlayElm,"mm-overlay-fixed-out"),mmDom.removeClass(overlayElm,"mm-overlay-fixed-in"),void 0===overlayElm.style.animationName&&(overlayElm.style.display="none"),suppressCookie&&cookieManager.suppressForOneHour(MentionMe.Overlay.CookieIdentifier))}}(MentionMe);
!function(MentionMe){"use strict";MentionMe.Global=function(){},MentionMe.Global.prototype.create=function(){}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Events={},MentionMe.Events.applyReward=function(data){log.debug("Attempting to apply reward.");{if(data)return data.redirect?(log.info("Redirecting to",data.redirect),void(window.location.href=data.redirect)):void(data.couponCode?parent.MentionMe.AutoCoupon&&new parent.MentionMe.AutoCoupon(data).init():log.info("No coupon code provided. Cannot auto fill coupon box."));log.debug("No data. Cannot apply a reward.")}}}(MentionMe);
!function(MentionMe){"use strict";var log=MentionMe.log;MentionMe.Watermark={},MentionMe.Watermark.create=function(url){if(!MentionMe.watermarkShown){MentionMe.watermarkShown=!0,log.info("Showing watermark");var dimensions={width:350,height:360},payload={},display=new MentionMe.Display(payload);pAddCloseStyle();var watermarkIframe=display.createAndInsertIframe("Watermark",dimensions,url,{hasMask:!1,isWatermark:!0,closingClosesAll:!1}),closeIcon=pCreateCloseIcon();return watermarkIframe.parentNode.insertBefore(closeIcon,watermarkIframe),closeIcon.onclick=function(){this.parentNode.style.display="none",this.parentNode.style.zIndex=-1},watermarkIframe}return log.info("Watermark shown already or disabled. Not showing."),null};var pCreateCloseIcon=function(){var modalClose=document.createElement("div");return modalClose.id="mmCloseButton",modalClose.className="mmClose",modalClose},pAddCloseStyle=function(){var styleElement=document.createElement("style");styleElement.type="text/css",styleElement.appendChild(document.createTextNode(".mmClose {z-index:3;position:absolute;right:0px;top:5px;cursor:pointer;height:28px;width:26px;padding-bottom:10px;background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAMAAAAMs7fIAAAADFBMVEUAAAAAAADs7Ozk5OQWfFDEAAAABHRSTlNmzfD6fX0x6QAAADhJREFUeAGtyzkKADEAQlGX+995sJExZchvhAfiZdJ/kq2AXaGtADFUKC3kYh3A0ACGAghVyM5tH063AIhm6TccAAAAAElFTkSuQmCC) no-repeat;}")),document.getElementsByTagName("head")[0].appendChild(styleElement)}}(MentionMe);